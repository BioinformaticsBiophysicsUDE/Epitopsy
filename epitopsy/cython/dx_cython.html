<!-- Generated by Cython 0.19.1 on Wed Dec 11 17:16:28 2013 -->
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<style type="text/css">

body { font-family: courier; font-size: 12; }

.code  { font-size: 9; color: #444444; display: none; margin-left: 20px; }
.py_c_api  { color: red; }
.py_macro_api  { color: #FF7000; }
.pyx_c_api  { color: #FF3000; }
.pyx_macro_api  { color: #FF7000; }
.refnanny  { color: #FFA000; }

.error_goto  { color: #FFA000; }

.tag  {  }

.coerce  { color: #008000; border: 1px dotted #008000 }

.py_attr { color: #FF0000; font-weight: bold; }
.c_attr  { color: #0000FF; }

.py_call { color: #FF0000; font-weight: bold; }
.c_call  { color: #0000FF; }

.line { margin: 0em }

</style>
<script>
function toggleDiv(id) {
    theDiv = document.getElementById(id);
    if (theDiv.style.display == 'none') theDiv.style.display = 'block';
    else theDiv.style.display = 'none';
}
</script>
</head>
        <body>
<p>Generated by Cython 0.19.1 on Wed Dec 11 17:16:28 2013
<p>Raw output: <a href="dx_cython.c">dx_cython.c</a>
<pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line1")'> 1: """</pre>
<pre id='line1' class='code' style='background-color: #FFFF79'>
  /* "epitopsy/cython/dx_cython.pyx":1
 * """             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * @author: Christoph Wilms
 * """
 */
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s____test__, ((PyObject *)__pyx_t_2)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2")'> 2: @author: Christoph Wilms</pre>
<pre id='line2' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line3")'> 3: """</pre>
<pre id='line3' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line4")'> 4: import numpy as np</pre>
<pre id='line4' class='code' style='background-color: #FFFF8d'>
  /* "epitopsy/cython/dx_cython.pyx":4
 * @author: Christoph Wilms
 * """
 * import numpy as np             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * # "cimport" is used to import special compile-time information
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__numpy), 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__np, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line5")'> 5: </pre>
<pre id='line5' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line6")'> 6: # "cimport" is used to import special compile-time information</pre>
<pre id='line6' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line7")'> 7: # about the numpy module (this is stored in a file numpy.pxd which is</pre>
<pre id='line7' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line8")'> 8: # currently part of the Cython distribution).</pre>
<pre id='line8' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line9")'> 9: cimport numpy as np</pre>
<pre id='line9' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line10")'> 10: </pre>
<pre id='line10' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line11")'> 11: from libc.math cimport sqrt, round, ceil</pre>
<pre id='line11' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line12")'> 12: </pre>
<pre id='line12' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line13")'> 13: import gzip</pre>
<pre id='line13' class='code' style='background-color: #FFFF8d'>
  /* "epitopsy/cython/dx_cython.pyx":13
 * from libc.math cimport sqrt, round, ceil
 * 
 * import gzip             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * import re
 * import os
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__gzip), 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__gzip, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line14")'> 14: import re</pre>
<pre id='line14' class='code' style='background-color: #FFFF8d'>
  /* "epitopsy/cython/dx_cython.pyx":14
 * 
 * import gzip
 * import re             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * import os
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__re), 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__re, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line15")'> 15: import os</pre>
<pre id='line15' class='code' style='background-color: #FFFF8d'>
  /* "epitopsy/cython/dx_cython.pyx":15
 * import gzip
 * import re
 * import os             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * from numpy cimport NPY_INT8 as NPY_int8
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__os), 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__os, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line16")'> 16: </pre>
<pre id='line16' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line17")'> 17: from numpy cimport NPY_INT8 as NPY_int8</pre>
<pre id='line17' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line18")'> 18: from numpy cimport NPY_INT16 as NPY_int16</pre>
<pre id='line18' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line19")'> 19: from numpy cimport NPY_INT32 as NPY_int32</pre>
<pre id='line19' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line20")'> 20: from numpy cimport NPY_INT64 as NPY_int64</pre>
<pre id='line20' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line21")'> 21: from numpy cimport NPY_FLOAT16 as NPY_float16</pre>
<pre id='line21' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line22")'> 22: from numpy cimport NPY_FLOAT32 as NPY_float32</pre>
<pre id='line22' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line23")'> 23: from numpy cimport NPY_FLOAT64 as NPY_float64</pre>
<pre id='line23' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line24")'> 24: </pre>
<pre id='line24' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line25")'> 25: int8 = np.dtype(np.int8)</pre>
<pre id='line25' class='code' style='background-color: #FFFF46'>
  /* "epitopsy/cython/dx_cython.pyx":25
 * from numpy cimport NPY_FLOAT64 as NPY_float64
 * 
 * int8 = np.dtype(np.int8)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * int16 = np.dtype(np.int16)
 * int32 = np.dtype(np.int32)
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__int8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)__pyx_ptype_5numpy_dtype)), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__int8, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line26")'> 26: int16 = np.dtype(np.int16)</pre>
<pre id='line26' class='code' style='background-color: #FFFF46'>
  /* "epitopsy/cython/dx_cython.pyx":26
 * 
 * int8 = np.dtype(np.int8)
 * int16 = np.dtype(np.int16)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * int32 = np.dtype(np.int32)
 * int64 = np.dtype(np.int64)
 */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 26; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s__int16);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 26; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 26; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)__pyx_ptype_5numpy_dtype)), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 26; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__int16, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 26; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line27")'> 27: int32 = np.dtype(np.int32)</pre>
<pre id='line27' class='code' style='background-color: #FFFF46'>
  /* "epitopsy/cython/dx_cython.pyx":27
 * int8 = np.dtype(np.int8)
 * int16 = np.dtype(np.int16)
 * int32 = np.dtype(np.int32)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * int64 = np.dtype(np.int64)
 * float16 = np.dtype(np.float16)
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 27; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__int32);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 27; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 27; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)__pyx_ptype_5numpy_dtype)), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 27; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__int32, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 27; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line28")'> 28: int64 = np.dtype(np.int64)</pre>
<pre id='line28' class='code' style='background-color: #FFFF46'>
  /* "epitopsy/cython/dx_cython.pyx":28
 * int16 = np.dtype(np.int16)
 * int32 = np.dtype(np.int32)
 * int64 = np.dtype(np.int64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * float16 = np.dtype(np.float16)
 * float32 = np.dtype(np.float32)
 */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s__int64);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)__pyx_ptype_5numpy_dtype)), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__int64, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line29")'> 29: float16 = np.dtype(np.float16)</pre>
<pre id='line29' class='code' style='background-color: #FFFF46'>
  /* "epitopsy/cython/dx_cython.pyx":29
 * int32 = np.dtype(np.int32)
 * int64 = np.dtype(np.int64)
 * float16 = np.dtype(np.float16)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * float32 = np.dtype(np.float32)
 * float64 = np.dtype(np.float64)
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__float16);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)__pyx_ptype_5numpy_dtype)), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__float16, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line30")'> 30: float32 = np.dtype(np.float32)</pre>
<pre id='line30' class='code' style='background-color: #FFFF46'>
  /* "epitopsy/cython/dx_cython.pyx":30
 * int64 = np.dtype(np.int64)
 * float16 = np.dtype(np.float16)
 * float32 = np.dtype(np.float32)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * float64 = np.dtype(np.float64)
 * 
 */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s__float32);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)__pyx_ptype_5numpy_dtype)), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__float32, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line31")'> 31: float64 = np.dtype(np.float64)</pre>
<pre id='line31' class='code' style='background-color: #FFFF46'>
  /* "epitopsy/cython/dx_cython.pyx":31
 * float16 = np.dtype(np.float16)
 * float32 = np.dtype(np.float32)
 * float64 = np.dtype(np.float64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__float64);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)__pyx_ptype_5numpy_dtype)), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__float64, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line32")'> 32: </pre>
<pre id='line32' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line33")'> 33: </pre>
<pre id='line33' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line34")'> 34: cdef float _vec_distance(int x1, int y1, int z1, int x2, int y2, int z2):</pre>
<pre id='line34' class='code' style='background-color: #FFFFff'>
/* "epitopsy/cython/dx_cython.pyx":34
 * 
 * 
 * cdef float _vec_distance(int x1, int y1, int z1, int x2, int y2, int z2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return sqrt((x2-x1)*(x2-x1) + (y2-y1)*(y2-y1) + (z2-z1)*(z2-z1))
 * 
 */

static float __pyx_f_8epitopsy_6cython_9dx_cython__vec_distance(int __pyx_v_x1, int __pyx_v_y1, int __pyx_v_z1, int __pyx_v_x2, int __pyx_v_y2, int __pyx_v_z2) {
  float __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_vec_distance", 0);
</pre><pre class='line' style='background-color: #FFFF38' onclick='toggleDiv("line35")'> 35:     return sqrt((x2-x1)*(x2-x1) + (y2-y1)*(y2-y1) + (z2-z1)*(z2-z1))</pre>
<pre id='line35' class='code' style='background-color: #FFFF38'>
  /* "epitopsy/cython/dx_cython.pyx":35
 * 
 * cdef float _vec_distance(int x1, int y1, int z1, int x2, int y2, int z2):
 *     return sqrt((x2-x1)*(x2-x1) + (y2-y1)*(y2-y1) + (z2-z1)*(z2-z1))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * def read_dxfile_depreciated(filename, box_type):
 */
  __pyx_r = sqrt(((((__pyx_v_x2 - __pyx_v_x1) * (__pyx_v_x2 - __pyx_v_x1)) + ((__pyx_v_y2 - __pyx_v_y1) * (__pyx_v_y2 - __pyx_v_y1))) + ((__pyx_v_z2 - __pyx_v_z1) * (__pyx_v_z2 - __pyx_v_z1))));
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_8epitopsy_6cython_9dx_cython_1read_dxfile_depreciated(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_8epitopsy_6cython_9dx_cython_1read_dxfile_depreciated = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("read_dxfile_depreciated"), (PyCFunction)__pyx_pw_8epitopsy_6cython_9dx_cython_1read_dxfile_depreciated, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_8epitopsy_6cython_9dx_cython_1read_dxfile_depreciated(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_filename = 0;
  CYTHON_UNUSED PyObject *__pyx_v_box_type = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("read_dxfile_depreciated (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__filename,&__pyx_n_s__box_type,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__filename)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__box_type)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("read_dxfile_depreciated", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_dxfile_depreciated") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_filename = values[0];
    __pyx_v_box_type = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("read_dxfile_depreciated", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython.read_dxfile_depreciated", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_8epitopsy_6cython_9dx_cython_read_dxfile_depreciated(__pyx_self, __pyx_v_filename, __pyx_v_box_type);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line36")'> 36: </pre>
<pre id='line36' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line37")'> 37: def read_dxfile_depreciated(filename, box_type):</pre>
<pre id='line37' class='code' style='background-color: #FFFF5e'>
/* "epitopsy/cython/dx_cython.pyx":37
 *     return sqrt((x2-x1)*(x2-x1) + (y2-y1)*(y2-y1) + (z2-z1)*(z2-z1))
 * 
 * def read_dxfile_depreciated(filename, box_type):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     if not(os.path.isabs(filename)):
 *         filename = os.path.join(os.getcwd(), filename)
 */

static PyObject *__pyx_pf_8epitopsy_6cython_9dx_cython_read_dxfile_depreciated(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_filename, CYTHON_UNUSED PyObject *__pyx_v_box_type) {
  CYTHON_UNUSED int __pyx_v_countX;
  CYTHON_UNUSED int __pyx_v_countY;
  CYTHON_UNUSED int __pyx_v_countZ;
  long __pyx_v_counter;
  PyArrayObject *__pyx_v_dimension = 0;
  PyArrayObject *__pyx_v_offset = 0;
  PyArrayObject *__pyx_v_meshsize = 0;
  PyObject *__pyx_v_dimensionPattern = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_lastHeaderLinePattern = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_objectPattern = NULL;
  PyObject *__pyx_v_valuePattern = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_originPattern = NULL;
  PyObject *__pyx_v_infile = NULL;
  PyObject *__pyx_v_content = NULL;
  int __pyx_v_delta_counter;
  PyArrayObject *__pyx_v_box = 0;
  PyObject *__pyx_v_line = NULL;
  PyObject *__pyx_v_matchedObject = NULL;
  PyObject *__pyx_v_matchedOrigin = NULL;
  PyObject *__pyx_v_delta_split = NULL;
  PyObject *__pyx_v_numbers_list = NULL;
  PyObject *__pyx_v_item = NULL;
  PyArrayObject *__pyx_v_box_3d = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_box;
  __Pyx_Buffer __pyx_pybuffer_box;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_box_3d;
  __Pyx_Buffer __pyx_pybuffer_box_3d;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_dimension;
  __Pyx_Buffer __pyx_pybuffer_dimension;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_meshsize;
  __Pyx_Buffer __pyx_pybuffer_meshsize;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_offset;
  __Pyx_Buffer __pyx_pybuffer_offset;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("read_dxfile_depreciated", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_filename);
  __pyx_pybuffer_dimension.pybuffer.buf = NULL;
  __pyx_pybuffer_dimension.refcount = 0;
  __pyx_pybuffernd_dimension.data = NULL;
  __pyx_pybuffernd_dimension.rcbuffer = &__pyx_pybuffer_dimension;
  __pyx_pybuffer_offset.pybuffer.buf = NULL;
  __pyx_pybuffer_offset.refcount = 0;
  __pyx_pybuffernd_offset.data = NULL;
  __pyx_pybuffernd_offset.rcbuffer = &__pyx_pybuffer_offset;
  __pyx_pybuffer_meshsize.pybuffer.buf = NULL;
  __pyx_pybuffer_meshsize.refcount = 0;
  __pyx_pybuffernd_meshsize.data = NULL;
  __pyx_pybuffernd_meshsize.rcbuffer = &__pyx_pybuffer_meshsize;
  __pyx_pybuffer_box.pybuffer.buf = NULL;
  __pyx_pybuffer_box.refcount = 0;
  __pyx_pybuffernd_box.data = NULL;
  __pyx_pybuffernd_box.rcbuffer = &__pyx_pybuffer_box;
  __pyx_pybuffer_box_3d.pybuffer.buf = NULL;
  __pyx_pybuffer_box_3d.refcount = 0;
  __pyx_pybuffernd_box_3d.data = NULL;
  __pyx_pybuffernd_box_3d.rcbuffer = &__pyx_pybuffer_box_3d;

  /* "epitopsy/cython/dx_cython.pyx":37
 *     return sqrt((x2-x1)*(x2-x1) + (y2-y1)*(y2-y1) + (z2-z1)*(z2-z1))
 * 
 * def read_dxfile_depreciated(filename, box_type):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     if not(os.path.isabs(filename)):
 *         filename = os.path.join(os.getcwd(), filename)
 */
  __pyx_k_tuple_106 = <span class='py_c_api'>PyTuple_Pack</span>(25, ((PyObject *)__pyx_n_s__filename), ((PyObject *)__pyx_n_s__box_type), ((PyObject *)__pyx_n_s__countX), ((PyObject *)__pyx_n_s__countY), ((PyObject *)__pyx_n_s__countZ), ((PyObject *)__pyx_n_s__counter), ((PyObject *)__pyx_n_s__dimension), ((PyObject *)__pyx_n_s__offset), ((PyObject *)__pyx_n_s__meshsize), ((PyObject *)__pyx_n_s__dimensionPattern), ((PyObject *)__pyx_n_s_105), ((PyObject *)__pyx_n_s__objectPattern), ((PyObject *)__pyx_n_s__valuePattern), ((PyObject *)__pyx_n_s__originPattern), ((PyObject *)__pyx_n_s__infile), ((PyObject *)__pyx_n_s__content), ((PyObject *)__pyx_n_s__delta_counter), ((PyObject *)__pyx_n_s__box), ((PyObject *)__pyx_n_s__line), ((PyObject *)__pyx_n_s__matchedObject), ((PyObject *)__pyx_n_s__matchedOrigin), ((PyObject *)__pyx_n_s__delta_split), ((PyObject *)__pyx_n_s__numbers_list), ((PyObject *)__pyx_n_s__item), ((PyObject *)__pyx_n_s__box_3d));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_106)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_106);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_106));

  /* "epitopsy/cython/dx_cython.pyx":37
 *     return sqrt((x2-x1)*(x2-x1) + (y2-y1)*(y2-y1) + (z2-z1)*(z2-z1))
 * 
 * def read_dxfile_depreciated(filename, box_type):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     if not(os.path.isabs(filename)):
 *         filename = os.path.join(os.getcwd(), filename)
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_8epitopsy_6cython_9dx_cython_1read_dxfile_depreciated, NULL, __pyx_n_s_110);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_108, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_107 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(2, 0, 25, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_106, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_109, __pyx_n_s_108, 37, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_107)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF39' onclick='toggleDiv("line38")'> 38:     if not(os.path.isabs(filename)):</pre>
<pre id='line38' class='code' style='background-color: #FFFF39'>
  /* "epitopsy/cython/dx_cython.pyx":38
 * 
 * def read_dxfile_depreciated(filename, box_type):
 *     if not(os.path.isabs(filename)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         filename = os.path.join(os.getcwd(), filename)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__os);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__path);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s__isabs);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_filename);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_filename);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_filename);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = ((!__pyx_t_4) != 0);
  if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFF2f' onclick='toggleDiv("line39")'> 39:         filename = os.path.join(os.getcwd(), filename)</pre>
<pre id='line39' class='code' style='background-color: #FFFF2f'>
    /* "epitopsy/cython/dx_cython.pyx":39
 * def read_dxfile_depreciated(filename, box_type):
 *     if not(os.path.isabs(filename)):
 *         filename = os.path.join(os.getcwd(), filename)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef int countX = 0
 */
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__os);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s__path);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s__join);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__os);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s__getcwd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_filename);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_filename);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_filename);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_filename);
    __pyx_v_filename = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line40")'> 40: </pre>
<pre id='line40' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line41")'> 41:     cdef int countX = 0</pre>
<pre id='line41' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":41
 *         filename = os.path.join(os.getcwd(), filename)
 * 
 *     cdef int countX = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int countY = 0
 *     cdef int countZ = 0
 */
  __pyx_v_countX = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line42")'> 42:     cdef int countY = 0</pre>
<pre id='line42' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":42
 * 
 *     cdef int countX = 0
 *     cdef int countY = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int countZ = 0
 *     cdef long counter = 0
 */
  __pyx_v_countY = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line43")'> 43:     cdef int countZ = 0</pre>
<pre id='line43' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":43
 *     cdef int countX = 0
 *     cdef int countY = 0
 *     cdef int countZ = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef long counter = 0
 *     cdef np.ndarray[np.int64_t,ndim=1] dimension = np.zeros(3,dtype=np.int64)
 */
  __pyx_v_countZ = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line44")'> 44:     cdef long counter = 0</pre>
<pre id='line44' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":44
 *     cdef int countY = 0
 *     cdef int countZ = 0
 *     cdef long counter = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.ndarray[np.int64_t,ndim=1] dimension = np.zeros(3,dtype=np.int64)
 *     cdef np.ndarray[np.float64_t,ndim=1] offset = np.zeros(3,dtype=np.float64)
 */
  __pyx_v_counter = 0;
</pre><pre class='line' style='background-color: #FFFF2f' onclick='toggleDiv("line45")'> 45:     cdef np.ndarray[np.int64_t,ndim=1] dimension = np.zeros(3,dtype=np.int64)</pre>
<pre id='line45' class='code' style='background-color: #FFFF2f'>
  /* "epitopsy/cython/dx_cython.pyx":45
 *     cdef int countZ = 0
 *     cdef long counter = 0
 *     cdef np.ndarray[np.int64_t,ndim=1] dimension = np.zeros(3,dtype=np.int64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.ndarray[np.float64_t,ndim=1] offset = np.zeros(3,dtype=np.float64)
 *     cdef np.ndarray[np.float64_t,ndim=1] meshsize = np.zeros(3,dtype=np.float64)
 */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s__zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s__int64);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), __pyx_t_6) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_1), ((PyObject *)__pyx_t_2));<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_dimension.rcbuffer->pybuffer, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_dimension = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_dimension.rcbuffer->pybuffer.buf = NULL;
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_dimension.diminfo[0].strides = __pyx_pybuffernd_dimension.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_dimension.diminfo[0].shape = __pyx_pybuffernd_dimension.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_dimension = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "epitopsy/cython/dx_cython.pyx":45
 *     cdef int countZ = 0
 *     cdef long counter = 0
 *     cdef np.ndarray[np.int64_t,ndim=1] dimension = np.zeros(3,dtype=np.int64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.ndarray[np.float64_t,ndim=1] offset = np.zeros(3,dtype=np.float64)
 *     cdef np.ndarray[np.float64_t,ndim=1] meshsize = np.zeros(3,dtype=np.float64)
 */
  __pyx_k_tuple_1 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_1));
</pre><pre class='line' style='background-color: #FFFF2f' onclick='toggleDiv("line46")'> 46:     cdef np.ndarray[np.float64_t,ndim=1] offset = np.zeros(3,dtype=np.float64)</pre>
<pre id='line46' class='code' style='background-color: #FFFF2f'>
  /* "epitopsy/cython/dx_cython.pyx":46
 *     cdef long counter = 0
 *     cdef np.ndarray[np.int64_t,ndim=1] dimension = np.zeros(3,dtype=np.int64)
 *     cdef np.ndarray[np.float64_t,ndim=1] offset = np.zeros(3,dtype=np.float64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.ndarray[np.float64_t,ndim=1] meshsize = np.zeros(3,dtype=np.float64)
 *     dimensionPattern = re.compile('(\\d+) (\\d+) (\\d+)$')
 */
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s__zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_6));
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__float64);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, ((PyObject *)__pyx_n_s__dtype), __pyx_t_3) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_k_tuple_2), ((PyObject *)__pyx_t_6));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_offset.rcbuffer->pybuffer, (PyObject*)__pyx_t_8, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_offset = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_offset.rcbuffer->pybuffer.buf = NULL;
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_offset.diminfo[0].strides = __pyx_pybuffernd_offset.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_offset.diminfo[0].shape = __pyx_pybuffernd_offset.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_8 = 0;
  __pyx_v_offset = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "epitopsy/cython/dx_cython.pyx":46
 *     cdef long counter = 0
 *     cdef np.ndarray[np.int64_t,ndim=1] dimension = np.zeros(3,dtype=np.int64)
 *     cdef np.ndarray[np.float64_t,ndim=1] offset = np.zeros(3,dtype=np.float64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.ndarray[np.float64_t,ndim=1] meshsize = np.zeros(3,dtype=np.float64)
 *     dimensionPattern = re.compile('(\\d+) (\\d+) (\\d+)$')
 */
  __pyx_k_tuple_2 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_2));
</pre><pre class='line' style='background-color: #FFFF2f' onclick='toggleDiv("line47")'> 47:     cdef np.ndarray[np.float64_t,ndim=1] meshsize = np.zeros(3,dtype=np.float64)</pre>
<pre id='line47' class='code' style='background-color: #FFFF2f'>
  /* "epitopsy/cython/dx_cython.pyx":47
 *     cdef np.ndarray[np.int64_t,ndim=1] dimension = np.zeros(3,dtype=np.int64)
 *     cdef np.ndarray[np.float64_t,ndim=1] offset = np.zeros(3,dtype=np.float64)
 *     cdef np.ndarray[np.float64_t,ndim=1] meshsize = np.zeros(3,dtype=np.float64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     dimensionPattern = re.compile('(\\d+) (\\d+) (\\d+)$')
 *     lastHeaderLinePattern = re.compile('^object 3')
 */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 47; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s__zeros);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 47; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 47; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 47; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s__float64);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 47; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, ((PyObject *)__pyx_n_s__dtype), __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 47; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, ((PyObject *)__pyx_k_tuple_3), ((PyObject *)__pyx_t_3));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 47; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 47; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_9 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_meshsize.rcbuffer->pybuffer, (PyObject*)__pyx_t_9, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_meshsize = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_meshsize.rcbuffer->pybuffer.buf = NULL;
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 47; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_meshsize.diminfo[0].strides = __pyx_pybuffernd_meshsize.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_meshsize.diminfo[0].shape = __pyx_pybuffernd_meshsize.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_9 = 0;
  __pyx_v_meshsize = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "epitopsy/cython/dx_cython.pyx":47
 *     cdef np.ndarray[np.int64_t,ndim=1] dimension = np.zeros(3,dtype=np.int64)
 *     cdef np.ndarray[np.float64_t,ndim=1] offset = np.zeros(3,dtype=np.float64)
 *     cdef np.ndarray[np.float64_t,ndim=1] meshsize = np.zeros(3,dtype=np.float64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     dimensionPattern = re.compile('(\\d+) (\\d+) (\\d+)$')
 *     lastHeaderLinePattern = re.compile('^object 3')
 */
  __pyx_k_tuple_3 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 47; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_3));
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line48")'> 48:     dimensionPattern = re.compile('(\\d+) (\\d+) (\\d+)$')</pre>
<pre id='line48' class='code' style='background-color: #FFFF57'>
  /* "epitopsy/cython/dx_cython.pyx":48
 *     cdef np.ndarray[np.float64_t,ndim=1] offset = np.zeros(3,dtype=np.float64)
 *     cdef np.ndarray[np.float64_t,ndim=1] meshsize = np.zeros(3,dtype=np.float64)
 *     dimensionPattern = re.compile('(\\d+) (\\d+) (\\d+)$')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     lastHeaderLinePattern = re.compile('^object 3')
 *     objectPattern = re.compile('^object 1')
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__re);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__compile);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_k_tuple_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_dimensionPattern = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "epitopsy/cython/dx_cython.pyx":48
 *     cdef np.ndarray[np.float64_t,ndim=1] offset = np.zeros(3,dtype=np.float64)
 *     cdef np.ndarray[np.float64_t,ndim=1] meshsize = np.zeros(3,dtype=np.float64)
 *     dimensionPattern = re.compile('(\\d+) (\\d+) (\\d+)$')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     lastHeaderLinePattern = re.compile('^object 3')
 *     objectPattern = re.compile('^object 1')
 */
  __pyx_k_tuple_5 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_4));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_5);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_5));
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line49")'> 49:     lastHeaderLinePattern = re.compile('^object 3')</pre>
<pre id='line49' class='code' style='background-color: #FFFF57'>
  /* "epitopsy/cython/dx_cython.pyx":49
 *     cdef np.ndarray[np.float64_t,ndim=1] meshsize = np.zeros(3,dtype=np.float64)
 *     dimensionPattern = re.compile('(\\d+) (\\d+) (\\d+)$')
 *     lastHeaderLinePattern = re.compile('^object 3')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     objectPattern = re.compile('^object 1')
 *     valuePattern = re.compile('^[-]?\\d+\\.\\d+[eE][+-]\\d+')
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__re);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__compile);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_k_tuple_7), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_lastHeaderLinePattern = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "epitopsy/cython/dx_cython.pyx":49
 *     cdef np.ndarray[np.float64_t,ndim=1] meshsize = np.zeros(3,dtype=np.float64)
 *     dimensionPattern = re.compile('(\\d+) (\\d+) (\\d+)$')
 *     lastHeaderLinePattern = re.compile('^object 3')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     objectPattern = re.compile('^object 1')
 *     valuePattern = re.compile('^[-]?\\d+\\.\\d+[eE][+-]\\d+')
 */
  __pyx_k_tuple_7 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_6));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_7);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_7));
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line50")'> 50:     objectPattern = re.compile('^object 1')</pre>
<pre id='line50' class='code' style='background-color: #FFFF57'>
  /* "epitopsy/cython/dx_cython.pyx":50
 *     dimensionPattern = re.compile('(\\d+) (\\d+) (\\d+)$')
 *     lastHeaderLinePattern = re.compile('^object 3')
 *     objectPattern = re.compile('^object 1')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     valuePattern = re.compile('^[-]?\\d+\\.\\d+[eE][+-]\\d+')
 *     # this has been tested and it works
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__re);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__compile);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_k_tuple_9), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_objectPattern = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "epitopsy/cython/dx_cython.pyx":50
 *     dimensionPattern = re.compile('(\\d+) (\\d+) (\\d+)$')
 *     lastHeaderLinePattern = re.compile('^object 3')
 *     objectPattern = re.compile('^object 1')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     valuePattern = re.compile('^[-]?\\d+\\.\\d+[eE][+-]\\d+')
 *     # this has been tested and it works
 */
  __pyx_k_tuple_9 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_8));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_9);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_9));
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line51")'> 51:     valuePattern = re.compile('^[-]?\\d+\\.\\d+[eE][+-]\\d+')</pre>
<pre id='line51' class='code' style='background-color: #FFFF57'>
  /* "epitopsy/cython/dx_cython.pyx":51
 *     lastHeaderLinePattern = re.compile('^object 3')
 *     objectPattern = re.compile('^object 1')
 *     valuePattern = re.compile('^[-]?\\d+\\.\\d+[eE][+-]\\d+')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     # this has been tested and it works
 *     originPattern = re.compile('^origin ([-]?\\d+.\\d+[eE]?[+-]?\\d+?) ([-]?\\d+.\\d+[eE]?[-+]?\\d+?) ([-]?\\d+.\\d+[eE]?[+-]?\\d+?)')
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__re);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__compile);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_k_tuple_11), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_valuePattern = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "epitopsy/cython/dx_cython.pyx":51
 *     lastHeaderLinePattern = re.compile('^object 3')
 *     objectPattern = re.compile('^object 1')
 *     valuePattern = re.compile('^[-]?\\d+\\.\\d+[eE][+-]\\d+')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     # this has been tested and it works
 *     originPattern = re.compile('^origin ([-]?\\d+.\\d+[eE]?[+-]?\\d+?) ([-]?\\d+.\\d+[eE]?[-+]?\\d+?) ([-]?\\d+.\\d+[eE]?[+-]?\\d+?)')
 */
  __pyx_k_tuple_11 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_10));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_11);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_11));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line52")'> 52:     # this has been tested and it works</pre>
<pre id='line52' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line53")'> 53:     originPattern = re.compile('^origin ([-]?\\d+.\\d+[eE]?[+-]?\\d+?) ([-]?\\d+.\\d+[eE]?[-+]?\\d+?) ([-]?\\d+.\\d+[eE]?[+-]?\\d+?)')</pre>
<pre id='line53' class='code' style='background-color: #FFFF57'>
  /* "epitopsy/cython/dx_cython.pyx":53
 *     valuePattern = re.compile('^[-]?\\d+\\.\\d+[eE][+-]\\d+')
 *     # this has been tested and it works
 *     originPattern = re.compile('^origin ([-]?\\d+.\\d+[eE]?[+-]?\\d+?) ([-]?\\d+.\\d+[eE]?[-+]?\\d+?) ([-]?\\d+.\\d+[eE]?[+-]?\\d+?)')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     if filename.endswith('.gz'):
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__re);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__compile);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_k_tuple_13), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_originPattern = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "epitopsy/cython/dx_cython.pyx":53
 *     valuePattern = re.compile('^[-]?\\d+\\.\\d+[eE][+-]\\d+')
 *     # this has been tested and it works
 *     originPattern = re.compile('^origin ([-]?\\d+.\\d+[eE]?[+-]?\\d+?) ([-]?\\d+.\\d+[eE]?[-+]?\\d+?) ([-]?\\d+.\\d+[eE]?[+-]?\\d+?)')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     if filename.endswith('.gz'):
 */
  __pyx_k_tuple_13 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_12));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_13);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_13));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line54")'> 54: </pre>
<pre id='line54' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line55")'> 55:     if filename.endswith('.gz'):</pre>
<pre id='line55' class='code' style='background-color: #FFFF4f'>
  /* "epitopsy/cython/dx_cython.pyx":55
 *     originPattern = re.compile('^origin ([-]?\\d+.\\d+[eE]?[+-]?\\d+?) ([-]?\\d+.\\d+[eE]?[-+]?\\d+?) ([-]?\\d+.\\d+[eE]?[+-]?\\d+?)')
 * 
 *     if filename.endswith('.gz'):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         with gzip.open(filename) as infile:
 *             content = infile.readlines()
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_filename, __pyx_n_s__endswith);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_15), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_5 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_5) {

  /* "epitopsy/cython/dx_cython.pyx":55
 *     originPattern = re.compile('^origin ([-]?\\d+.\\d+[eE]?[+-]?\\d+?) ([-]?\\d+.\\d+[eE]?[-+]?\\d+?) ([-]?\\d+.\\d+[eE]?[+-]?\\d+?)')
 * 
 *     if filename.endswith('.gz'):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         with gzip.open(filename) as infile:
 *             content = infile.readlines()
 */
  __pyx_k_tuple_15 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_14));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_15);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_15));
</pre><pre class='line' style='background-color: #FFFF17' onclick='toggleDiv("line56")'> 56:         with gzip.open(filename) as infile:</pre>
<pre id='line56' class='code' style='background-color: #FFFF17'>
    /* "epitopsy/cython/dx_cython.pyx":56
 * 
 *     if filename.endswith('.gz'):
 *         with gzip.open(filename) as infile:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             content = infile.readlines()
 *     else:
 */
    /*with:*/ {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__gzip);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s__open);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_filename);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_filename);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_filename);
      __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      __pyx_t_10 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s____exit__);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
      __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s____enter__);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L5_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L5_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      /*try:*/ {
        {
          <span class='pyx_c_api'>__Pyx_ExceptionSave</span>(&__pyx_t_11, &__pyx_t_12, &__pyx_t_13);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_11);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_12);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_13);
          /*try:*/ {
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
            __pyx_v_infile = __pyx_t_1;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;

          /* "epitopsy/cython/dx_cython.pyx":56
 * 
 *     if filename.endswith('.gz'):
 *         with gzip.open(filename) as infile:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             content = infile.readlines()
 *     else:
 */
          /*except:*/ {
            <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython.read_dxfile_depreciated", __pyx_clineno, __pyx_lineno, __pyx_filename);
            if (<span class='pyx_c_api'>__Pyx_GetException</span>(&__pyx_t_6, &__pyx_t_1, &__pyx_t_3) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L11_except_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
            __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L11_except_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_6);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_1);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_t_3);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
            __pyx_t_14 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_10, __pyx_t_2, NULL);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
            if (unlikely(!__pyx_t_14))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L11_except_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
            __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_14);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
            if (__pyx_t_5 <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L11_except_error;}</span>
            __pyx_t_4 = ((!(__pyx_t_5 != 0)) != 0);
            if (__pyx_t_4) {
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_6);
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
              <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_6, __pyx_t_1, __pyx_t_3);
              __pyx_t_6 = 0; __pyx_t_1 = 0; __pyx_t_3 = 0; 
             <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L11_except_error;}</span>
              goto __pyx_L20;
            }
            __pyx_L20:;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
            goto __pyx_L10_exception_handled;
          }
          __pyx_L11_except_error:;
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_11);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_12);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_13);
          <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_11, __pyx_t_12, __pyx_t_13);
          goto __pyx_L1_error;
          __pyx_L10_exception_handled:;
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_11);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_12);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_13);
          <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_11, __pyx_t_12, __pyx_t_13);
          __pyx_L16_try_end:;
        }
      }
      /*finally:*/ {
        if (__pyx_t_10) {
          __pyx_t_13 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_10, __pyx_k_tuple_16, NULL);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          if (unlikely(!__pyx_t_13))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
          __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_13);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          if (__pyx_t_4 <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
      }
      goto __pyx_L21;
      __pyx_L5_error:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      goto __pyx_L1_error;
      __pyx_L21:;
    }
    goto __pyx_L4;
  }
  /*else*/ {

  /* "epitopsy/cython/dx_cython.pyx":56
 * 
 *     if filename.endswith('.gz'):
 *         with gzip.open(filename) as infile:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             content = infile.readlines()
 *     else:
 */
  __pyx_k_tuple_16 = <span class='py_c_api'>PyTuple_Pack</span>(3, Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_16);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_16));
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line57")'> 57:             content = infile.readlines()</pre>
<pre id='line57' class='code' style='background-color: #FFFF5b'>
            /* "epitopsy/cython/dx_cython.pyx":57
 *     if filename.endswith('.gz'):
 *         with gzip.open(filename) as infile:
 *             content = infile.readlines()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     else:
 *         with open(filename) as infile:
 */
            __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_infile, __pyx_n_s__readlines);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 57; __pyx_clineno = __LINE__; goto __pyx_L9_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
            __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 57; __pyx_clineno = __LINE__; goto __pyx_L9_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_v_content = __pyx_t_6;
            __pyx_t_6 = 0;
          }
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          goto __pyx_L16_try_end;
          __pyx_L9_error:;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line58")'> 58:     else:</pre>
<pre id='line58' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF19' onclick='toggleDiv("line59")'> 59:         with open(filename) as infile:</pre>
<pre id='line59' class='code' style='background-color: #FFFF19'>
    /* "epitopsy/cython/dx_cython.pyx":59
 *             content = infile.readlines()
 *     else:
 *         with open(filename) as infile:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             content = infile.readlines()
 * 
 */
    /*with:*/ {
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_filename);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_filename);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_filename);
      __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_open, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      __pyx_t_10 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s____exit__);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
      __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s____enter__);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L22_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L22_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      /*try:*/ {
        {
          <span class='pyx_c_api'>__Pyx_ExceptionSave</span>(&__pyx_t_13, &__pyx_t_12, &__pyx_t_11);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_13);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_12);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_11);
          /*try:*/ {
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
            __pyx_v_infile = __pyx_t_6;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;

          /* "epitopsy/cython/dx_cython.pyx":59
 *             content = infile.readlines()
 *     else:
 *         with open(filename) as infile:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             content = infile.readlines()
 * 
 */
          /*except:*/ {
            <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython.read_dxfile_depreciated", __pyx_clineno, __pyx_lineno, __pyx_filename);
            if (<span class='pyx_c_api'>__Pyx_GetException</span>(&__pyx_t_1, &__pyx_t_6, &__pyx_t_3) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L28_except_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
            __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L28_except_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_6);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_t_3);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
            __pyx_t_14 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_10, __pyx_t_2, NULL);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
            if (unlikely(!__pyx_t_14))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L28_except_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
            __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_14);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
            if (__pyx_t_4 <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L28_except_error;}</span>
            __pyx_t_5 = ((!(__pyx_t_4 != 0)) != 0);
            if (__pyx_t_5) {
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_6);
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
              <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_1, __pyx_t_6, __pyx_t_3);
              __pyx_t_1 = 0; __pyx_t_6 = 0; __pyx_t_3 = 0; 
             <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L28_except_error;}</span>
              goto __pyx_L37;
            }
            __pyx_L37:;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
            goto __pyx_L27_exception_handled;
          }
          __pyx_L28_except_error:;
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_13);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_12);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_11);
          <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_13, __pyx_t_12, __pyx_t_11);
          goto __pyx_L1_error;
          __pyx_L27_exception_handled:;
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_13);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_12);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_11);
          <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_13, __pyx_t_12, __pyx_t_11);
          __pyx_L33_try_end:;
        }
      }
      /*finally:*/ {
        if (__pyx_t_10) {
          __pyx_t_11 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_10, __pyx_k_tuple_17, NULL);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          if (unlikely(!__pyx_t_11))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
          __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
          if (__pyx_t_5 <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
      }
      goto __pyx_L38;
      __pyx_L22_error:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      goto __pyx_L1_error;
      __pyx_L38:;
    }
  }
  __pyx_L4:;

  /* "epitopsy/cython/dx_cython.pyx":59
 *             content = infile.readlines()
 *     else:
 *         with open(filename) as infile:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             content = infile.readlines()
 * 
 */
  __pyx_k_tuple_17 = <span class='py_c_api'>PyTuple_Pack</span>(3, Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_17);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_17));
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line60")'> 60:             content = infile.readlines()</pre>
<pre id='line60' class='code' style='background-color: #FFFF5b'>
            /* "epitopsy/cython/dx_cython.pyx":60
 *     else:
 *         with open(filename) as infile:
 *             content = infile.readlines()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef int delta_counter = 0
 */
            __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_infile, __pyx_n_s__readlines);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L26_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
            __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L26_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
            __pyx_v_content = __pyx_t_1;
            __pyx_t_1 = 0;
          }
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
          goto __pyx_L33_try_end;
          __pyx_L26_error:;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line61")'> 61: </pre>
<pre id='line61' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line62")'> 62:     cdef int delta_counter = 0</pre>
<pre id='line62' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":62
 *             content = infile.readlines()
 * 
 *     cdef int delta_counter = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.ndarray[np.float64_t,ndim=1] box
 *     for line in content:
 */
  __pyx_v_delta_counter = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line63")'> 63:     cdef np.ndarray[np.float64_t,ndim=1] box</pre>
<pre id='line63' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF29' onclick='toggleDiv("line64")'> 64:     for line in content:</pre>
<pre id='line64' class='code' style='background-color: #FFFF29'>
  /* "epitopsy/cython/dx_cython.pyx":64
 *     cdef int delta_counter = 0
 *     cdef np.ndarray[np.float64_t,ndim=1] box
 *     for line in content:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if not line.startswith('#'):
 *             if line.startswith('object 1'):
 */
  if (unlikely(!__pyx_v_content)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("content");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_content) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_content)) {
    __pyx_t_3 = __pyx_v_content; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_15 = 0;
    __pyx_t_16 = NULL;
  } else {
    __pyx_t_15 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_content);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_16 = Py_TYPE(__pyx_t_3)->tp_iternext;
  }
  for (;;) {
    if (!__pyx_t_16 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) {
      if (__pyx_t_15 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_15); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_15++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_15); __pyx_t_15++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_16 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
      if (__pyx_t_15 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_15); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_15++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_15); __pyx_t_15++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_6 = __pyx_t_16(__pyx_t_3);
      if (unlikely(!__pyx_t_6)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_line);
    __pyx_v_line = __pyx_t_6;
    __pyx_t_6 = 0;
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line65")'> 65:         if not line.startswith('#'):</pre>
<pre id='line65' class='code' style='background-color: #FFFF4f'>
    /* "epitopsy/cython/dx_cython.pyx":65
 *     cdef np.ndarray[np.float64_t,ndim=1] box
 *     for line in content:
 *         if not line.startswith('#'):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if line.startswith('object 1'):
 *                 matchedObject = dimensionPattern.search(line)
 */
    __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_line, __pyx_n_s__startswith);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 65; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, ((PyObject *)__pyx_k_tuple_19), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 65; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 65; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_4 = ((!__pyx_t_5) != 0);
    if (__pyx_t_4) {

  /* "epitopsy/cython/dx_cython.pyx":65
 *     cdef np.ndarray[np.float64_t,ndim=1] box
 *     for line in content:
 *         if not line.startswith('#'):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if line.startswith('object 1'):
 *                 matchedObject = dimensionPattern.search(line)
 */
  __pyx_k_tuple_19 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_18));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 65; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_19);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_19));
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line66")'> 66:             if line.startswith('object 1'):</pre>
<pre id='line66' class='code' style='background-color: #FFFF4f'>
      /* "epitopsy/cython/dx_cython.pyx":66
 *     for line in content:
 *         if not line.startswith('#'):
 *             if line.startswith('object 1'):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 matchedObject = dimensionPattern.search(line)
 *                 dimension[0] = int(matchedObject.group(1))
 */
      __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_line, __pyx_n_s__startswith);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_21), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (__pyx_t_4) {

  /* "epitopsy/cython/dx_cython.pyx":66
 *     for line in content:
 *         if not line.startswith('#'):
 *             if line.startswith('object 1'):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 matchedObject = dimensionPattern.search(line)
 *                 dimension[0] = int(matchedObject.group(1))
 */
  __pyx_k_tuple_21 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_20));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_21);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_21));
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line67")'> 67:                 matchedObject = dimensionPattern.search(line)</pre>
<pre id='line67' class='code' style='background-color: #FFFF55'>
        /* "epitopsy/cython/dx_cython.pyx":67
 *         if not line.startswith('#'):
 *             if line.startswith('object 1'):
 *                 matchedObject = dimensionPattern.search(line)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 dimension[0] = int(matchedObject.group(1))
 *                 dimension[1] = int(matchedObject.group(2))
 */
        __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_dimensionPattern, __pyx_n_s__search);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_line);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_line);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_line);
        __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_matchedObject);
        __pyx_v_matchedObject = __pyx_t_2;
        __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF37' onclick='toggleDiv("line68")'> 68:                 dimension[0] = int(matchedObject.group(1))</pre>
<pre id='line68' class='code' style='background-color: #FFFF37'>
        /* "epitopsy/cython/dx_cython.pyx":68
 *             if line.startswith('object 1'):
 *                 matchedObject = dimensionPattern.search(line)
 *                 dimension[0] = int(matchedObject.group(1))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 dimension[1] = int(matchedObject.group(2))
 *                 dimension[2] = int(matchedObject.group(3))
 */
        __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_matchedObject, __pyx_n_s__group);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_k_tuple_22), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
        __pyx_t_17 = __Pyx_PyInt_from_py_npy_int64(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_17 == (npy_int64)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_18 = 0;
        __pyx_t_19 = -1;
        if (__pyx_t_18 <code><</code> 0) {
          __pyx_t_18 += __pyx_pybuffernd_dimension.diminfo[0].shape;
          if (unlikely(__pyx_t_18 <code><</code> 0)) __pyx_t_19 = 0;
        } else if (unlikely(__pyx_t_18 >= __pyx_pybuffernd_dimension.diminfo[0].shape)) __pyx_t_19 = 0;
        if (unlikely(__pyx_t_19 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_dimension.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_dimension.diminfo[0].strides) = __pyx_t_17;

  /* "epitopsy/cython/dx_cython.pyx":68
 *             if line.startswith('object 1'):
 *                 matchedObject = dimensionPattern.search(line)
 *                 dimension[0] = int(matchedObject.group(1))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 dimension[1] = int(matchedObject.group(2))
 *                 dimension[2] = int(matchedObject.group(3))
 */
  __pyx_k_tuple_22 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_22)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_22);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_22));
</pre><pre class='line' style='background-color: #FFFF37' onclick='toggleDiv("line69")'> 69:                 dimension[1] = int(matchedObject.group(2))</pre>
<pre id='line69' class='code' style='background-color: #FFFF37'>
        /* "epitopsy/cython/dx_cython.pyx":69
 *                 matchedObject = dimensionPattern.search(line)
 *                 dimension[0] = int(matchedObject.group(1))
 *                 dimension[1] = int(matchedObject.group(2))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 dimension[2] = int(matchedObject.group(3))
 *                 box = np.zeros(dimension[0] * dimension[1] * dimension[2],dtype=np.float64)
 */
        __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_matchedObject, __pyx_n_s__group);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_23), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
        __pyx_t_2 = 0;
        __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
        __pyx_t_17 = __Pyx_PyInt_from_py_npy_int64(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_17 == (npy_int64)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_20 = 1;
        __pyx_t_19 = -1;
        if (__pyx_t_20 <code><</code> 0) {
          __pyx_t_20 += __pyx_pybuffernd_dimension.diminfo[0].shape;
          if (unlikely(__pyx_t_20 <code><</code> 0)) __pyx_t_19 = 0;
        } else if (unlikely(__pyx_t_20 >= __pyx_pybuffernd_dimension.diminfo[0].shape)) __pyx_t_19 = 0;
        if (unlikely(__pyx_t_19 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_dimension.rcbuffer->pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_dimension.diminfo[0].strides) = __pyx_t_17;

  /* "epitopsy/cython/dx_cython.pyx":69
 *                 matchedObject = dimensionPattern.search(line)
 *                 dimension[0] = int(matchedObject.group(1))
 *                 dimension[1] = int(matchedObject.group(2))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 dimension[2] = int(matchedObject.group(3))
 *                 box = np.zeros(dimension[0] * dimension[1] * dimension[2],dtype=np.float64)
 */
  __pyx_k_tuple_23 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_23);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_23));
</pre><pre class='line' style='background-color: #FFFF37' onclick='toggleDiv("line70")'> 70:                 dimension[2] = int(matchedObject.group(3))</pre>
<pre id='line70' class='code' style='background-color: #FFFF37'>
        /* "epitopsy/cython/dx_cython.pyx":70
 *                 dimension[0] = int(matchedObject.group(1))
 *                 dimension[1] = int(matchedObject.group(2))
 *                 dimension[2] = int(matchedObject.group(3))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 box = np.zeros(dimension[0] * dimension[1] * dimension[2],dtype=np.float64)
 *             elif line.startswith('origin'):
 */
        __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_matchedObject, __pyx_n_s__group);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 70; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_k_tuple_24), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 70; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 70; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 70; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
        __pyx_t_17 = __Pyx_PyInt_from_py_npy_int64(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_17 == (npy_int64)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 70; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_21 = 2;
        __pyx_t_19 = -1;
        if (__pyx_t_21 <code><</code> 0) {
          __pyx_t_21 += __pyx_pybuffernd_dimension.diminfo[0].shape;
          if (unlikely(__pyx_t_21 <code><</code> 0)) __pyx_t_19 = 0;
        } else if (unlikely(__pyx_t_21 >= __pyx_pybuffernd_dimension.diminfo[0].shape)) __pyx_t_19 = 0;
        if (unlikely(__pyx_t_19 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 70; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_dimension.rcbuffer->pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_dimension.diminfo[0].strides) = __pyx_t_17;

  /* "epitopsy/cython/dx_cython.pyx":70
 *                 dimension[0] = int(matchedObject.group(1))
 *                 dimension[1] = int(matchedObject.group(2))
 *                 dimension[2] = int(matchedObject.group(3))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 box = np.zeros(dimension[0] * dimension[1] * dimension[2],dtype=np.float64)
 *             elif line.startswith('origin'):
 */
  __pyx_k_tuple_24 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 70; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_24);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_24));
</pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line71")'> 71:                 box = np.zeros(dimension[0] * dimension[1] * dimension[2],dtype=np.float64)</pre>
<pre id='line71' class='code' style='background-color: #FFFF20'>
        /* "epitopsy/cython/dx_cython.pyx":71
 *                 dimension[1] = int(matchedObject.group(2))
 *                 dimension[2] = int(matchedObject.group(3))
 *                 box = np.zeros(dimension[0] * dimension[1] * dimension[2],dtype=np.float64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             elif line.startswith('origin'):
 *                 matchedOrigin = line.split(' ')
 */
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_22 = 0;
        __pyx_t_19 = -1;
        if (__pyx_t_22 <code><</code> 0) {
          __pyx_t_22 += __pyx_pybuffernd_dimension.diminfo[0].shape;
          if (unlikely(__pyx_t_22 <code><</code> 0)) __pyx_t_19 = 0;
        } else if (unlikely(__pyx_t_22 >= __pyx_pybuffernd_dimension.diminfo[0].shape)) __pyx_t_19 = 0;
        if (unlikely(__pyx_t_19 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_23 = 1;
        __pyx_t_19 = -1;
        if (__pyx_t_23 <code><</code> 0) {
          __pyx_t_23 += __pyx_pybuffernd_dimension.diminfo[0].shape;
          if (unlikely(__pyx_t_23 <code><</code> 0)) __pyx_t_19 = 0;
        } else if (unlikely(__pyx_t_23 >= __pyx_pybuffernd_dimension.diminfo[0].shape)) __pyx_t_19 = 0;
        if (unlikely(__pyx_t_19 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_24 = 2;
        __pyx_t_19 = -1;
        if (__pyx_t_24 <code><</code> 0) {
          __pyx_t_24 += __pyx_pybuffernd_dimension.diminfo[0].shape;
          if (unlikely(__pyx_t_24 <code><</code> 0)) __pyx_t_19 = 0;
        } else if (unlikely(__pyx_t_24 >= __pyx_pybuffernd_dimension.diminfo[0].shape)) __pyx_t_19 = 0;
        if (unlikely(__pyx_t_19 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_1 = __Pyx_PyInt_to_py_npy_int64((((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_dimension.rcbuffer->pybuffer.buf, __pyx_t_22, __pyx_pybuffernd_dimension.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_dimension.rcbuffer->pybuffer.buf, __pyx_t_23, __pyx_pybuffernd_dimension.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_dimension.rcbuffer->pybuffer.buf, __pyx_t_24, __pyx_pybuffernd_dimension.diminfo[0].strides))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
        __pyx_t_25 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_25);
        __pyx_t_26 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_25, __pyx_n_s__float64);<span class='error_goto'> if (unlikely(!__pyx_t_26)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_26);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
        if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, ((PyObject *)__pyx_n_s__dtype), __pyx_t_26) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
        __pyx_t_26 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_6), ((PyObject *)__pyx_t_1));<span class='error_goto'> if (unlikely(!__pyx_t_26)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_26);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
        if (!(likely(((__pyx_t_26) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_26, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_27 = ((PyArrayObject *)__pyx_t_26);
        {
          __Pyx_BufFmt_StackElem __pyx_stack[1];
          <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer);
          __pyx_t_19 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer, (PyObject*)__pyx_t_27, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack);
          if (unlikely(__pyx_t_19 <code><</code> 0)) {
            <span class='py_c_api'>PyErr_Fetch</span>(&__pyx_t_10, &__pyx_t_11, &__pyx_t_12);
            if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer, (PyObject*)__pyx_v_box, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
              Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_11); Py_XDECREF(__pyx_t_12);
              <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
            } else {
              <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_10, __pyx_t_11, __pyx_t_12);
            }
          }
          __pyx_pybuffernd_box.diminfo[0].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_box.diminfo[0].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[0];
          if (unlikely(__pyx_t_19 <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_27 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_v_box));
        __pyx_v_box = ((PyArrayObject *)__pyx_t_26);
        __pyx_t_26 = 0;
        goto __pyx_L42;
      }
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line72")'> 72:             elif line.startswith('origin'):</pre>
<pre id='line72' class='code' style='background-color: #FFFF4f'>
      /* "epitopsy/cython/dx_cython.pyx":72
 *                 dimension[2] = int(matchedObject.group(3))
 *                 box = np.zeros(dimension[0] * dimension[1] * dimension[2],dtype=np.float64)
 *             elif line.startswith('origin'):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 matchedOrigin = line.split(' ')
 *                 offset[0] = float(matchedOrigin[1])
 */
      __pyx_t_26 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_line, __pyx_n_s__startswith);<span class='error_goto'> if (unlikely(!__pyx_t_26)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_26);
      __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_26, ((PyObject *)__pyx_k_tuple_25), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
      __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (__pyx_t_4) {

  /* "epitopsy/cython/dx_cython.pyx":72
 *                 dimension[2] = int(matchedObject.group(3))
 *                 box = np.zeros(dimension[0] * dimension[1] * dimension[2],dtype=np.float64)
 *             elif line.startswith('origin'):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 matchedOrigin = line.split(' ')
 *                 offset[0] = float(matchedOrigin[1])
 */
  __pyx_k_tuple_25 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_n_s__origin));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_25);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_25));
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line73")'> 73:                 matchedOrigin = line.split(' ')</pre>
<pre id='line73' class='code' style='background-color: #FFFF5e'>
        /* "epitopsy/cython/dx_cython.pyx":73
 *                 box = np.zeros(dimension[0] * dimension[1] * dimension[2],dtype=np.float64)
 *             elif line.startswith('origin'):
 *                 matchedOrigin = line.split(' ')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 offset[0] = float(matchedOrigin[1])
 *                 offset[1] = float(matchedOrigin[2])
 */
        __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_line, __pyx_n_s__split);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_t_26 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_27), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_26)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_26);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_matchedOrigin);
        __pyx_v_matchedOrigin = __pyx_t_26;
        __pyx_t_26 = 0;

  /* "epitopsy/cython/dx_cython.pyx":73
 *                 box = np.zeros(dimension[0] * dimension[1] * dimension[2],dtype=np.float64)
 *             elif line.startswith('origin'):
 *                 matchedOrigin = line.split(' ')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 offset[0] = float(matchedOrigin[1])
 *                 offset[1] = float(matchedOrigin[2])
 */
  __pyx_k_tuple_27 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_26));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_27)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_27);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_27));
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line74")'> 74:                 offset[0] = float(matchedOrigin[1])</pre>
<pre id='line74' class='code' style='background-color: #FFFF66'>
        /* "epitopsy/cython/dx_cython.pyx":74
 *             elif line.startswith('origin'):
 *                 matchedOrigin = line.split(' ')
 *                 offset[0] = float(matchedOrigin[1])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 offset[1] = float(matchedOrigin[2])
 *                 offset[2] = float(matchedOrigin[3])
 */
        __pyx_t_26 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_matchedOrigin, 1, sizeof(long), PyInt_FromLong, 0, 0, 1);<span class='error_goto'> if (!__pyx_t_26) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_26);
        __pyx_t_28 = __Pyx_<span class='py_c_api'>PyObject_AsDouble</span>(__pyx_t_26);<span class='error_goto'> if (unlikely(__pyx_t_28 == ((double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
        __pyx_t_29 = 0;
        __pyx_t_19 = -1;
        if (__pyx_t_29 <code><</code> 0) {
          __pyx_t_29 += __pyx_pybuffernd_offset.diminfo[0].shape;
          if (unlikely(__pyx_t_29 <code><</code> 0)) __pyx_t_19 = 0;
        } else if (unlikely(__pyx_t_29 >= __pyx_pybuffernd_offset.diminfo[0].shape)) __pyx_t_19 = 0;
        if (unlikely(__pyx_t_19 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_offset.rcbuffer->pybuffer.buf, __pyx_t_29, __pyx_pybuffernd_offset.diminfo[0].strides) = __pyx_t_28;
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line75")'> 75:                 offset[1] = float(matchedOrigin[2])</pre>
<pre id='line75' class='code' style='background-color: #FFFF66'>
        /* "epitopsy/cython/dx_cython.pyx":75
 *                 matchedOrigin = line.split(' ')
 *                 offset[0] = float(matchedOrigin[1])
 *                 offset[1] = float(matchedOrigin[2])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 offset[2] = float(matchedOrigin[3])
 *             elif line.startswith('delta'):
 */
        __pyx_t_26 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_matchedOrigin, 2, sizeof(long), PyInt_FromLong, 0, 0, 1);<span class='error_goto'> if (!__pyx_t_26) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_26);
        __pyx_t_28 = __Pyx_<span class='py_c_api'>PyObject_AsDouble</span>(__pyx_t_26);<span class='error_goto'> if (unlikely(__pyx_t_28 == ((double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
        __pyx_t_30 = 1;
        __pyx_t_19 = -1;
        if (__pyx_t_30 <code><</code> 0) {
          __pyx_t_30 += __pyx_pybuffernd_offset.diminfo[0].shape;
          if (unlikely(__pyx_t_30 <code><</code> 0)) __pyx_t_19 = 0;
        } else if (unlikely(__pyx_t_30 >= __pyx_pybuffernd_offset.diminfo[0].shape)) __pyx_t_19 = 0;
        if (unlikely(__pyx_t_19 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_offset.rcbuffer->pybuffer.buf, __pyx_t_30, __pyx_pybuffernd_offset.diminfo[0].strides) = __pyx_t_28;
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line76")'> 76:                 offset[2] = float(matchedOrigin[3])</pre>
<pre id='line76' class='code' style='background-color: #FFFF66'>
        /* "epitopsy/cython/dx_cython.pyx":76
 *                 offset[0] = float(matchedOrigin[1])
 *                 offset[1] = float(matchedOrigin[2])
 *                 offset[2] = float(matchedOrigin[3])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             elif line.startswith('delta'):
 *                     delta_split = line.split()
 */
        __pyx_t_26 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_matchedOrigin, 3, sizeof(long), PyInt_FromLong, 0, 0, 1);<span class='error_goto'> if (!__pyx_t_26) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_26);
        __pyx_t_28 = __Pyx_<span class='py_c_api'>PyObject_AsDouble</span>(__pyx_t_26);<span class='error_goto'> if (unlikely(__pyx_t_28 == ((double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
        __pyx_t_31 = 2;
        __pyx_t_19 = -1;
        if (__pyx_t_31 <code><</code> 0) {
          __pyx_t_31 += __pyx_pybuffernd_offset.diminfo[0].shape;
          if (unlikely(__pyx_t_31 <code><</code> 0)) __pyx_t_19 = 0;
        } else if (unlikely(__pyx_t_31 >= __pyx_pybuffernd_offset.diminfo[0].shape)) __pyx_t_19 = 0;
        if (unlikely(__pyx_t_19 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_offset.rcbuffer->pybuffer.buf, __pyx_t_31, __pyx_pybuffernd_offset.diminfo[0].strides) = __pyx_t_28;
        goto __pyx_L42;
      }
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line77")'> 77:             elif line.startswith('delta'):</pre>
<pre id='line77' class='code' style='background-color: #FFFF4f'>
      /* "epitopsy/cython/dx_cython.pyx":77
 *                 offset[1] = float(matchedOrigin[2])
 *                 offset[2] = float(matchedOrigin[3])
 *             elif line.startswith('delta'):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     delta_split = line.split()
 *                     meshsize[delta_counter] = float(delta_split[delta_counter+1])
 */
      __pyx_t_26 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_line, __pyx_n_s__startswith);<span class='error_goto'> if (unlikely(!__pyx_t_26)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_26);
      __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_26, ((PyObject *)__pyx_k_tuple_28), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
      __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (__pyx_t_4) {

  /* "epitopsy/cython/dx_cython.pyx":77
 *                 offset[1] = float(matchedOrigin[2])
 *                 offset[2] = float(matchedOrigin[3])
 *             elif line.startswith('delta'):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     delta_split = line.split()
 *                     meshsize[delta_counter] = float(delta_split[delta_counter+1])
 */
  __pyx_k_tuple_28 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_n_s__delta));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_28)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_28);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_28));
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line78")'> 78:                     delta_split = line.split()</pre>
<pre id='line78' class='code' style='background-color: #FFFF73'>
        /* "epitopsy/cython/dx_cython.pyx":78
 *                 offset[2] = float(matchedOrigin[3])
 *             elif line.startswith('delta'):
 *                     delta_split = line.split()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     meshsize[delta_counter] = float(delta_split[delta_counter+1])
 *                     delta_counter += 1
 */
        __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_line, __pyx_n_s__split);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_t_26 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_26)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_26);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_delta_split);
        __pyx_v_delta_split = __pyx_t_26;
        __pyx_t_26 = 0;
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line79")'> 79:                     meshsize[delta_counter] = float(delta_split[delta_counter+1])</pre>
<pre id='line79' class='code' style='background-color: #FFFF66'>
        /* "epitopsy/cython/dx_cython.pyx":79
 *             elif line.startswith('delta'):
 *                     delta_split = line.split()
 *                     meshsize[delta_counter] = float(delta_split[delta_counter+1])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     delta_counter += 1
 * 
 */
        __pyx_t_32 = (__pyx_v_delta_counter + 1);
        __pyx_t_26 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_delta_split, __pyx_t_32, sizeof(long), PyInt_FromLong, 0, 1, 1);<span class='error_goto'> if (!__pyx_t_26) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_26);
        __pyx_t_28 = __Pyx_<span class='py_c_api'>PyObject_AsDouble</span>(__pyx_t_26);<span class='error_goto'> if (unlikely(__pyx_t_28 == ((double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
        __pyx_t_19 = __pyx_v_delta_counter;
        __pyx_t_33 = -1;
        if (__pyx_t_19 <code><</code> 0) {
          __pyx_t_19 += __pyx_pybuffernd_meshsize.diminfo[0].shape;
          if (unlikely(__pyx_t_19 <code><</code> 0)) __pyx_t_33 = 0;
        } else if (unlikely(__pyx_t_19 >= __pyx_pybuffernd_meshsize.diminfo[0].shape)) __pyx_t_33 = 0;
        if (unlikely(__pyx_t_33 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_33);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_meshsize.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_meshsize.diminfo[0].strides) = __pyx_t_28;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line80")'> 80:                     delta_counter += 1</pre>
<pre id='line80' class='code' style='background-color: #FFFFff'>
        /* "epitopsy/cython/dx_cython.pyx":80
 *                     delta_split = line.split()
 *                     meshsize[delta_counter] = float(delta_split[delta_counter+1])
 *                     delta_counter += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             if valuePattern.match(line):
 */
        __pyx_v_delta_counter = (__pyx_v_delta_counter + 1);
        goto __pyx_L42;
      }
      __pyx_L42:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line81")'> 81: </pre>
<pre id='line81' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF48' onclick='toggleDiv("line82")'> 82:             if valuePattern.match(line):</pre>
<pre id='line82' class='code' style='background-color: #FFFF48'>
      /* "epitopsy/cython/dx_cython.pyx":82
 *                     delta_counter += 1
 * 
 *             if valuePattern.match(line):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 numbers_list = line.strip().split(' ')
 *                 for item in numbers_list:
 */
      __pyx_t_26 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_valuePattern, __pyx_n_s__match);<span class='error_goto'> if (unlikely(!__pyx_t_26)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_26);
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_line);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_line);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_line);
      __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_26, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
      __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line83")'> 83:                 numbers_list = line.strip().split(' ')</pre>
<pre id='line83' class='code' style='background-color: #FFFF41'>
        /* "epitopsy/cython/dx_cython.pyx":83
 * 
 *             if valuePattern.match(line):
 *                 numbers_list = line.strip().split(' ')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for item in numbers_list:
 *                     box[counter] = float(item)
 */
        __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_line, __pyx_n_s__strip);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
        __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__split);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, ((PyObject *)__pyx_k_tuple_29), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_numbers_list);
        __pyx_v_numbers_list = __pyx_t_1;
        __pyx_t_1 = 0;

  /* "epitopsy/cython/dx_cython.pyx":83
 * 
 *             if valuePattern.match(line):
 *                 numbers_list = line.strip().split(' ')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for item in numbers_list:
 *                     box[counter] = float(item)
 */
  __pyx_k_tuple_29 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_26));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_29)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_29);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_29));
</pre><pre class='line' style='background-color: #FFFF2a' onclick='toggleDiv("line84")'> 84:                 for item in numbers_list:</pre>
<pre id='line84' class='code' style='background-color: #FFFF2a'>
        /* "epitopsy/cython/dx_cython.pyx":84
 *             if valuePattern.match(line):
 *                 numbers_list = line.strip().split(' ')
 *                 for item in numbers_list:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     box[counter] = float(item)
 *                     counter += 1
 */
        if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_numbers_list) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_numbers_list)) {
          __pyx_t_1 = __pyx_v_numbers_list; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_34 = 0;
          __pyx_t_35 = NULL;
        } else {
          __pyx_t_34 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_numbers_list);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          __pyx_t_35 = Py_TYPE(__pyx_t_1)->tp_iternext;
        }
        for (;;) {
          if (!__pyx_t_35 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) {
            if (__pyx_t_34 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_34); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_34++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            #else
            __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_34); __pyx_t_34++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            #endif
          } else if (!__pyx_t_35 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
            if (__pyx_t_34 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_34); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_34++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            #else
            __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_34); __pyx_t_34++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            #endif
          } else {
            __pyx_t_6 = __pyx_t_35(__pyx_t_1);
            if (unlikely(!__pyx_t_6)) {
              if (<span class='py_c_api'>PyErr_Occurred</span>()) {
                if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
                else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              }
              break;
            }
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
          }
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_item);
          __pyx_v_item = __pyx_t_6;
          __pyx_t_6 = 0;
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line85")'> 85:                     box[counter] = float(item)</pre>
<pre id='line85' class='code' style='background-color: #FFFF73'>
          /* "epitopsy/cython/dx_cython.pyx":85
 *                 numbers_list = line.strip().split(' ')
 *                 for item in numbers_list:
 *                     box[counter] = float(item)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     counter += 1
 * 
 */
          __pyx_t_28 = __Pyx_<span class='py_c_api'>PyObject_AsDouble</span>(__pyx_v_item);<span class='error_goto'> if (unlikely(__pyx_t_28 == ((double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 85; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          __pyx_t_32 = __pyx_v_counter;
          __pyx_t_33 = -1;
          if (__pyx_t_32 <code><</code> 0) {
            __pyx_t_32 += __pyx_pybuffernd_box.diminfo[0].shape;
            if (unlikely(__pyx_t_32 <code><</code> 0)) __pyx_t_33 = 0;
          } else if (unlikely(__pyx_t_32 >= __pyx_pybuffernd_box.diminfo[0].shape)) __pyx_t_33 = 0;
          if (unlikely(__pyx_t_33 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_33);
           <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 85; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_32, __pyx_pybuffernd_box.diminfo[0].strides) = __pyx_t_28;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line86")'> 86:                     counter += 1</pre>
<pre id='line86' class='code' style='background-color: #FFFFd4'>
          /* "epitopsy/cython/dx_cython.pyx":86
 *                 for item in numbers_list:
 *                     box[counter] = float(item)
 *                     counter += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef np.ndarray[np.float64_t,ndim=3] box_3d = box.reshape(dimension)
 */
          __pyx_v_counter = (__pyx_v_counter + 1);
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L43;
      }
      __pyx_L43:;
      goto __pyx_L41;
    }
    __pyx_L41:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line87")'> 87: </pre>
<pre id='line87' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF4b' onclick='toggleDiv("line88")'> 88:     cdef np.ndarray[np.float64_t,ndim=3] box_3d = box.reshape(dimension)</pre>
<pre id='line88' class='code' style='background-color: #FFFF4b'>
  /* "epitopsy/cython/dx_cython.pyx":88
 *                     counter += 1
 * 
 *     cdef np.ndarray[np.float64_t,ndim=3] box_3d = box.reshape(dimension)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     return [box_3d, meshsize, offset]
 */
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_box), __pyx_n_s__reshape);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_dimension));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_dimension));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_dimension));
  __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_36 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_box_3d.rcbuffer->pybuffer, (PyObject*)__pyx_t_36, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) {
      __pyx_v_box_3d = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_box_3d.rcbuffer->pybuffer.buf = NULL;
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_box_3d.diminfo[0].strides = __pyx_pybuffernd_box_3d.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_box_3d.diminfo[0].shape = __pyx_pybuffernd_box_3d.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_box_3d.diminfo[1].strides = __pyx_pybuffernd_box_3d.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_box_3d.diminfo[1].shape = __pyx_pybuffernd_box_3d.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_box_3d.diminfo[2].strides = __pyx_pybuffernd_box_3d.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_box_3d.diminfo[2].shape = __pyx_pybuffernd_box_3d.rcbuffer->pybuffer.shape[2];
    }
  }
  __pyx_t_36 = 0;
  __pyx_v_box_3d = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line89")'> 89: </pre>
<pre id='line89' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF17' onclick='toggleDiv("line90")'> 90:     return [box_3d, meshsize, offset]</pre>
<pre id='line90' class='code' style='background-color: #FFFF17'>
  /* "epitopsy/cython/dx_cython.pyx":90
 *     cdef np.ndarray[np.float64_t,ndim=3] box_3d = box.reshape(dimension)
 * 
 *     return [box_3d, meshsize, offset]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * def read_dxfile(filename, box_type):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_box_3d));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 0, ((PyObject *)__pyx_v_box_3d));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_box_3d));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_meshsize));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 1, ((PyObject *)__pyx_v_meshsize));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_meshsize));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_offset));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 2, ((PyObject *)__pyx_v_offset));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_offset));
  __pyx_r = ((PyObject *)__pyx_t_6);
  __pyx_t_6 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_25);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_26);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&__pyx_type, &__pyx_value, &__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box_3d.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_dimension.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_meshsize.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_offset.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython.read_dxfile_depreciated", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box_3d.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_dimension.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_meshsize.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_offset.rcbuffer->pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_dimension);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_offset);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_meshsize);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dimensionPattern);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_lastHeaderLinePattern);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_objectPattern);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_valuePattern);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_originPattern);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_infile);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_content);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_box);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_line);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_matchedObject);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_matchedOrigin);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_delta_split);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_numbers_list);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_item);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_box_3d);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_filename);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_8epitopsy_6cython_9dx_cython_3read_dxfile(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_8epitopsy_6cython_9dx_cython_3read_dxfile = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("read_dxfile"), (PyCFunction)__pyx_pw_8epitopsy_6cython_9dx_cython_3read_dxfile, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_8epitopsy_6cython_9dx_cython_3read_dxfile(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_filename = 0;
  CYTHON_UNUSED PyObject *__pyx_v_box_type = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("read_dxfile (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__filename,&__pyx_n_s__box_type,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__filename)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__box_type)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("read_dxfile", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_dxfile") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_filename = values[0];
    __pyx_v_box_type = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("read_dxfile", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython.read_dxfile", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_8epitopsy_6cython_9dx_cython_2read_dxfile(__pyx_self, __pyx_v_filename, __pyx_v_box_type);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line91")'> 91: </pre>
<pre id='line91' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line92")'> 92: def read_dxfile(filename, box_type):</pre>
<pre id='line92' class='code' style='background-color: #FFFF5e'>
/* "epitopsy/cython/dx_cython.pyx":92
 *     return [box_3d, meshsize, offset]
 * 
 * def read_dxfile(filename, box_type):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     if not(os.path.isabs(filename)):
 *         filename = os.path.join(os.getcwd(), filename)
 */

static PyObject *__pyx_pf_8epitopsy_6cython_9dx_cython_2read_dxfile(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_filename, CYTHON_UNUSED PyObject *__pyx_v_box_type) {
  CYTHON_UNUSED int __pyx_v_countX;
  CYTHON_UNUSED int __pyx_v_countY;
  CYTHON_UNUSED int __pyx_v_countZ;
  long __pyx_v_counter;
  PyArrayObject *__pyx_v_dimension = 0;
  PyArrayObject *__pyx_v_offset = 0;
  PyArrayObject *__pyx_v_meshsize = 0;
  PyObject *__pyx_v_dimensionPattern = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_lastHeaderLinePattern = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_objectPattern = NULL;
  PyObject *__pyx_v_valuePattern = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_originPattern = NULL;
  PyObject *__pyx_v_infile = NULL;
  PyObject *__pyx_v_content = NULL;
  int __pyx_v_delta_counter;
  PyArrayObject *__pyx_v_box = 0;
  long __pyx_v_i_start;
  PyObject *__pyx_v_line = NULL;
  PyObject *__pyx_v_matchedObject = NULL;
  PyObject *__pyx_v_matchedOrigin = NULL;
  PyObject *__pyx_v_delta_split = NULL;
  long __pyx_v_i;
  long __pyx_v_j;
  long __pyx_v_n_elements;
  long __pyx_v_i_end;
  PyObject *__pyx_v_line_content = NULL;
  PyArrayObject *__pyx_v_box_3d = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_box;
  __Pyx_Buffer __pyx_pybuffer_box;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_box_3d;
  __Pyx_Buffer __pyx_pybuffer_box_3d;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_dimension;
  __Pyx_Buffer __pyx_pybuffer_dimension;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_meshsize;
  __Pyx_Buffer __pyx_pybuffer_meshsize;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_offset;
  __Pyx_Buffer __pyx_pybuffer_offset;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("read_dxfile", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_filename);
  __pyx_pybuffer_dimension.pybuffer.buf = NULL;
  __pyx_pybuffer_dimension.refcount = 0;
  __pyx_pybuffernd_dimension.data = NULL;
  __pyx_pybuffernd_dimension.rcbuffer = &__pyx_pybuffer_dimension;
  __pyx_pybuffer_offset.pybuffer.buf = NULL;
  __pyx_pybuffer_offset.refcount = 0;
  __pyx_pybuffernd_offset.data = NULL;
  __pyx_pybuffernd_offset.rcbuffer = &__pyx_pybuffer_offset;
  __pyx_pybuffer_meshsize.pybuffer.buf = NULL;
  __pyx_pybuffer_meshsize.refcount = 0;
  __pyx_pybuffernd_meshsize.data = NULL;
  __pyx_pybuffernd_meshsize.rcbuffer = &__pyx_pybuffer_meshsize;
  __pyx_pybuffer_box.pybuffer.buf = NULL;
  __pyx_pybuffer_box.refcount = 0;
  __pyx_pybuffernd_box.data = NULL;
  __pyx_pybuffernd_box.rcbuffer = &__pyx_pybuffer_box;
  __pyx_pybuffer_box_3d.pybuffer.buf = NULL;
  __pyx_pybuffer_box_3d.refcount = 0;
  __pyx_pybuffernd_box_3d.data = NULL;
  __pyx_pybuffernd_box_3d.rcbuffer = &__pyx_pybuffer_box_3d;

  /* "epitopsy/cython/dx_cython.pyx":92
 *     return [box_3d, meshsize, offset]
 * 
 * def read_dxfile(filename, box_type):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     if not(os.path.isabs(filename)):
 *         filename = os.path.join(os.getcwd(), filename)
 */
  __pyx_k_tuple_111 = <span class='py_c_api'>PyTuple_Pack</span>(29, ((PyObject *)__pyx_n_s__filename), ((PyObject *)__pyx_n_s__box_type), ((PyObject *)__pyx_n_s__countX), ((PyObject *)__pyx_n_s__countY), ((PyObject *)__pyx_n_s__countZ), ((PyObject *)__pyx_n_s__counter), ((PyObject *)__pyx_n_s__dimension), ((PyObject *)__pyx_n_s__offset), ((PyObject *)__pyx_n_s__meshsize), ((PyObject *)__pyx_n_s__dimensionPattern), ((PyObject *)__pyx_n_s_105), ((PyObject *)__pyx_n_s__objectPattern), ((PyObject *)__pyx_n_s__valuePattern), ((PyObject *)__pyx_n_s__originPattern), ((PyObject *)__pyx_n_s__infile), ((PyObject *)__pyx_n_s__content), ((PyObject *)__pyx_n_s__delta_counter), ((PyObject *)__pyx_n_s__box), ((PyObject *)__pyx_n_s__i_start), ((PyObject *)__pyx_n_s__line), ((PyObject *)__pyx_n_s__matchedObject), ((PyObject *)__pyx_n_s__matchedOrigin), ((PyObject *)__pyx_n_s__delta_split), ((PyObject *)__pyx_n_s__i), ((PyObject *)__pyx_n_s__j), ((PyObject *)__pyx_n_s__n_elements), ((PyObject *)__pyx_n_s__i_end), ((PyObject *)__pyx_n_s__line_content), ((PyObject *)__pyx_n_s__box_3d));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_111)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_111);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_111));

  /* "epitopsy/cython/dx_cython.pyx":92
 *     return [box_3d, meshsize, offset]
 * 
 * def read_dxfile(filename, box_type):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     if not(os.path.isabs(filename)):
 *         filename = os.path.join(os.getcwd(), filename)
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_8epitopsy_6cython_9dx_cython_3read_dxfile, NULL, __pyx_n_s_110);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__read_dxfile, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_112 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(2, 0, 29, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_111, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_109, __pyx_n_s__read_dxfile, 92, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_112)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF39' onclick='toggleDiv("line93")'> 93:     if not(os.path.isabs(filename)):</pre>
<pre id='line93' class='code' style='background-color: #FFFF39'>
  /* "epitopsy/cython/dx_cython.pyx":93
 * 
 * def read_dxfile(filename, box_type):
 *     if not(os.path.isabs(filename)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         filename = os.path.join(os.getcwd(), filename)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__os);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 93; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__path);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 93; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s__isabs);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 93; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 93; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_filename);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_filename);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_filename);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 93; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 93; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = ((!__pyx_t_4) != 0);
  if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFF2f' onclick='toggleDiv("line94")'> 94:         filename = os.path.join(os.getcwd(), filename)</pre>
<pre id='line94' class='code' style='background-color: #FFFF2f'>
    /* "epitopsy/cython/dx_cython.pyx":94
 * def read_dxfile(filename, box_type):
 *     if not(os.path.isabs(filename)):
 *         filename = os.path.join(os.getcwd(), filename)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef int countX = 0
 */
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__os);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s__path);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s__join);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__os);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s__getcwd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_filename);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_filename);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_filename);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_filename);
    __pyx_v_filename = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line95")'> 95: </pre>
<pre id='line95' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line96")'> 96:     cdef int countX = 0</pre>
<pre id='line96' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":96
 *         filename = os.path.join(os.getcwd(), filename)
 * 
 *     cdef int countX = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int countY = 0
 *     cdef int countZ = 0
 */
  __pyx_v_countX = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line97")'> 97:     cdef int countY = 0</pre>
<pre id='line97' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":97
 * 
 *     cdef int countX = 0
 *     cdef int countY = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int countZ = 0
 *     cdef long counter = 0
 */
  __pyx_v_countY = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line98")'> 98:     cdef int countZ = 0</pre>
<pre id='line98' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":98
 *     cdef int countX = 0
 *     cdef int countY = 0
 *     cdef int countZ = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef long counter = 0
 *     cdef np.ndarray[np.int64_t,ndim=1] dimension = np.zeros(3,dtype=np.int64)
 */
  __pyx_v_countZ = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line99")'> 99:     cdef long counter = 0</pre>
<pre id='line99' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":99
 *     cdef int countY = 0
 *     cdef int countZ = 0
 *     cdef long counter = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.ndarray[np.int64_t,ndim=1] dimension = np.zeros(3,dtype=np.int64)
 *     cdef np.ndarray[np.float64_t,ndim=1] offset = np.zeros(3,dtype=np.float64)
 */
  __pyx_v_counter = 0;
</pre><pre class='line' style='background-color: #FFFF2f' onclick='toggleDiv("line100")'> 100:     cdef np.ndarray[np.int64_t,ndim=1] dimension = np.zeros(3,dtype=np.int64)</pre>
<pre id='line100' class='code' style='background-color: #FFFF2f'>
  /* "epitopsy/cython/dx_cython.pyx":100
 *     cdef int countZ = 0
 *     cdef long counter = 0
 *     cdef np.ndarray[np.int64_t,ndim=1] dimension = np.zeros(3,dtype=np.int64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.ndarray[np.float64_t,ndim=1] offset = np.zeros(3,dtype=np.float64)
 *     cdef np.ndarray[np.float64_t,ndim=1] meshsize = np.zeros(3,dtype=np.float64)
 */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s__zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s__int64);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), __pyx_t_6) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_30), ((PyObject *)__pyx_t_2));<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_dimension.rcbuffer->pybuffer, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_dimension = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_dimension.rcbuffer->pybuffer.buf = NULL;
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_dimension.diminfo[0].strides = __pyx_pybuffernd_dimension.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_dimension.diminfo[0].shape = __pyx_pybuffernd_dimension.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_dimension = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "epitopsy/cython/dx_cython.pyx":100
 *     cdef int countZ = 0
 *     cdef long counter = 0
 *     cdef np.ndarray[np.int64_t,ndim=1] dimension = np.zeros(3,dtype=np.int64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.ndarray[np.float64_t,ndim=1] offset = np.zeros(3,dtype=np.float64)
 *     cdef np.ndarray[np.float64_t,ndim=1] meshsize = np.zeros(3,dtype=np.float64)
 */
  __pyx_k_tuple_30 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_30)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_30);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_30));
</pre><pre class='line' style='background-color: #FFFF2f' onclick='toggleDiv("line101")'> 101:     cdef np.ndarray[np.float64_t,ndim=1] offset = np.zeros(3,dtype=np.float64)</pre>
<pre id='line101' class='code' style='background-color: #FFFF2f'>
  /* "epitopsy/cython/dx_cython.pyx":101
 *     cdef long counter = 0
 *     cdef np.ndarray[np.int64_t,ndim=1] dimension = np.zeros(3,dtype=np.int64)
 *     cdef np.ndarray[np.float64_t,ndim=1] offset = np.zeros(3,dtype=np.float64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.ndarray[np.float64_t,ndim=1] meshsize = np.zeros(3,dtype=np.float64)
 *     dimensionPattern = re.compile('(\\d+) (\\d+) (\\d+)$')
 */
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s__zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_6));
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__float64);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, ((PyObject *)__pyx_n_s__dtype), __pyx_t_3) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_k_tuple_31), ((PyObject *)__pyx_t_6));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_offset.rcbuffer->pybuffer, (PyObject*)__pyx_t_8, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_offset = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_offset.rcbuffer->pybuffer.buf = NULL;
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_offset.diminfo[0].strides = __pyx_pybuffernd_offset.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_offset.diminfo[0].shape = __pyx_pybuffernd_offset.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_8 = 0;
  __pyx_v_offset = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "epitopsy/cython/dx_cython.pyx":101
 *     cdef long counter = 0
 *     cdef np.ndarray[np.int64_t,ndim=1] dimension = np.zeros(3,dtype=np.int64)
 *     cdef np.ndarray[np.float64_t,ndim=1] offset = np.zeros(3,dtype=np.float64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.ndarray[np.float64_t,ndim=1] meshsize = np.zeros(3,dtype=np.float64)
 *     dimensionPattern = re.compile('(\\d+) (\\d+) (\\d+)$')
 */
  __pyx_k_tuple_31 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_31)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_31);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_31));
</pre><pre class='line' style='background-color: #FFFF2f' onclick='toggleDiv("line102")'> 102:     cdef np.ndarray[np.float64_t,ndim=1] meshsize = np.zeros(3,dtype=np.float64)</pre>
<pre id='line102' class='code' style='background-color: #FFFF2f'>
  /* "epitopsy/cython/dx_cython.pyx":102
 *     cdef np.ndarray[np.int64_t,ndim=1] dimension = np.zeros(3,dtype=np.int64)
 *     cdef np.ndarray[np.float64_t,ndim=1] offset = np.zeros(3,dtype=np.float64)
 *     cdef np.ndarray[np.float64_t,ndim=1] meshsize = np.zeros(3,dtype=np.float64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     dimensionPattern = re.compile('(\\d+) (\\d+) (\\d+)$')
 *     lastHeaderLinePattern = re.compile('^object 3')
 */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s__zeros);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s__float64);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, ((PyObject *)__pyx_n_s__dtype), __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, ((PyObject *)__pyx_k_tuple_32), ((PyObject *)__pyx_t_3));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_9 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_meshsize.rcbuffer->pybuffer, (PyObject*)__pyx_t_9, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_meshsize = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_meshsize.rcbuffer->pybuffer.buf = NULL;
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_meshsize.diminfo[0].strides = __pyx_pybuffernd_meshsize.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_meshsize.diminfo[0].shape = __pyx_pybuffernd_meshsize.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_9 = 0;
  __pyx_v_meshsize = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "epitopsy/cython/dx_cython.pyx":102
 *     cdef np.ndarray[np.int64_t,ndim=1] dimension = np.zeros(3,dtype=np.int64)
 *     cdef np.ndarray[np.float64_t,ndim=1] offset = np.zeros(3,dtype=np.float64)
 *     cdef np.ndarray[np.float64_t,ndim=1] meshsize = np.zeros(3,dtype=np.float64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     dimensionPattern = re.compile('(\\d+) (\\d+) (\\d+)$')
 *     lastHeaderLinePattern = re.compile('^object 3')
 */
  __pyx_k_tuple_32 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_32)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_32);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_32));
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line103")'> 103:     dimensionPattern = re.compile('(\\d+) (\\d+) (\\d+)$')</pre>
<pre id='line103' class='code' style='background-color: #FFFF57'>
  /* "epitopsy/cython/dx_cython.pyx":103
 *     cdef np.ndarray[np.float64_t,ndim=1] offset = np.zeros(3,dtype=np.float64)
 *     cdef np.ndarray[np.float64_t,ndim=1] meshsize = np.zeros(3,dtype=np.float64)
 *     dimensionPattern = re.compile('(\\d+) (\\d+) (\\d+)$')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     lastHeaderLinePattern = re.compile('^object 3')
 *     objectPattern = re.compile('^object 1')
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__re);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__compile);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_k_tuple_33), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_dimensionPattern = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "epitopsy/cython/dx_cython.pyx":103
 *     cdef np.ndarray[np.float64_t,ndim=1] offset = np.zeros(3,dtype=np.float64)
 *     cdef np.ndarray[np.float64_t,ndim=1] meshsize = np.zeros(3,dtype=np.float64)
 *     dimensionPattern = re.compile('(\\d+) (\\d+) (\\d+)$')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     lastHeaderLinePattern = re.compile('^object 3')
 *     objectPattern = re.compile('^object 1')
 */
  __pyx_k_tuple_33 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_4));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_33)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_33);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_33));
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line104")'> 104:     lastHeaderLinePattern = re.compile('^object 3')</pre>
<pre id='line104' class='code' style='background-color: #FFFF57'>
  /* "epitopsy/cython/dx_cython.pyx":104
 *     cdef np.ndarray[np.float64_t,ndim=1] meshsize = np.zeros(3,dtype=np.float64)
 *     dimensionPattern = re.compile('(\\d+) (\\d+) (\\d+)$')
 *     lastHeaderLinePattern = re.compile('^object 3')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     objectPattern = re.compile('^object 1')
 *     valuePattern = re.compile('^[-]?\\d+\\.\\d+[eE][+-]\\d+')
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__re);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__compile);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_k_tuple_34), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_lastHeaderLinePattern = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "epitopsy/cython/dx_cython.pyx":104
 *     cdef np.ndarray[np.float64_t,ndim=1] meshsize = np.zeros(3,dtype=np.float64)
 *     dimensionPattern = re.compile('(\\d+) (\\d+) (\\d+)$')
 *     lastHeaderLinePattern = re.compile('^object 3')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     objectPattern = re.compile('^object 1')
 *     valuePattern = re.compile('^[-]?\\d+\\.\\d+[eE][+-]\\d+')
 */
  __pyx_k_tuple_34 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_6));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_34)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_34);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_34));
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line105")'> 105:     objectPattern = re.compile('^object 1')</pre>
<pre id='line105' class='code' style='background-color: #FFFF57'>
  /* "epitopsy/cython/dx_cython.pyx":105
 *     dimensionPattern = re.compile('(\\d+) (\\d+) (\\d+)$')
 *     lastHeaderLinePattern = re.compile('^object 3')
 *     objectPattern = re.compile('^object 1')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     valuePattern = re.compile('^[-]?\\d+\\.\\d+[eE][+-]\\d+')
 *     # this has been tested and it works
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__re);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__compile);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_k_tuple_35), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_objectPattern = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "epitopsy/cython/dx_cython.pyx":105
 *     dimensionPattern = re.compile('(\\d+) (\\d+) (\\d+)$')
 *     lastHeaderLinePattern = re.compile('^object 3')
 *     objectPattern = re.compile('^object 1')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     valuePattern = re.compile('^[-]?\\d+\\.\\d+[eE][+-]\\d+')
 *     # this has been tested and it works
 */
  __pyx_k_tuple_35 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_8));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_35)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_35);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_35));
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line106")'> 106:     valuePattern = re.compile('^[-]?\\d+\\.\\d+[eE][+-]\\d+')</pre>
<pre id='line106' class='code' style='background-color: #FFFF57'>
  /* "epitopsy/cython/dx_cython.pyx":106
 *     lastHeaderLinePattern = re.compile('^object 3')
 *     objectPattern = re.compile('^object 1')
 *     valuePattern = re.compile('^[-]?\\d+\\.\\d+[eE][+-]\\d+')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     # this has been tested and it works
 *     originPattern = re.compile('^origin ([-]?\\d+.\\d+[eE]?[+-]?\\d+?) ([-]?\\d+.\\d+[eE]?[-+]?\\d+?) ([-]?\\d+.\\d+[eE]?[+-]?\\d+?)')
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__re);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__compile);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_k_tuple_36), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_valuePattern = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "epitopsy/cython/dx_cython.pyx":106
 *     lastHeaderLinePattern = re.compile('^object 3')
 *     objectPattern = re.compile('^object 1')
 *     valuePattern = re.compile('^[-]?\\d+\\.\\d+[eE][+-]\\d+')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     # this has been tested and it works
 *     originPattern = re.compile('^origin ([-]?\\d+.\\d+[eE]?[+-]?\\d+?) ([-]?\\d+.\\d+[eE]?[-+]?\\d+?) ([-]?\\d+.\\d+[eE]?[+-]?\\d+?)')
 */
  __pyx_k_tuple_36 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_10));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_36)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_36);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_36));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line107")'> 107:     # this has been tested and it works</pre>
<pre id='line107' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line108")'> 108:     originPattern = re.compile('^origin ([-]?\\d+.\\d+[eE]?[+-]?\\d+?) ([-]?\\d+.\\d+[eE]?[-+]?\\d+?) ([-]?\\d+.\\d+[eE]?[+-]?\\d+?)')</pre>
<pre id='line108' class='code' style='background-color: #FFFF57'>
  /* "epitopsy/cython/dx_cython.pyx":108
 *     valuePattern = re.compile('^[-]?\\d+\\.\\d+[eE][+-]\\d+')
 *     # this has been tested and it works
 *     originPattern = re.compile('^origin ([-]?\\d+.\\d+[eE]?[+-]?\\d+?) ([-]?\\d+.\\d+[eE]?[-+]?\\d+?) ([-]?\\d+.\\d+[eE]?[+-]?\\d+?)')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     if filename.endswith('.gz'):
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__re);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__compile);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_k_tuple_37), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_originPattern = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "epitopsy/cython/dx_cython.pyx":108
 *     valuePattern = re.compile('^[-]?\\d+\\.\\d+[eE][+-]\\d+')
 *     # this has been tested and it works
 *     originPattern = re.compile('^origin ([-]?\\d+.\\d+[eE]?[+-]?\\d+?) ([-]?\\d+.\\d+[eE]?[-+]?\\d+?) ([-]?\\d+.\\d+[eE]?[+-]?\\d+?)')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     if filename.endswith('.gz'):
 */
  __pyx_k_tuple_37 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_12));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_37)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_37);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_37));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line109")'> 109: </pre>
<pre id='line109' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line110")'> 110:     if filename.endswith('.gz'):</pre>
<pre id='line110' class='code' style='background-color: #FFFF4f'>
  /* "epitopsy/cython/dx_cython.pyx":110
 *     originPattern = re.compile('^origin ([-]?\\d+.\\d+[eE]?[+-]?\\d+?) ([-]?\\d+.\\d+[eE]?[-+]?\\d+?) ([-]?\\d+.\\d+[eE]?[+-]?\\d+?)')
 * 
 *     if filename.endswith('.gz'):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         with gzip.open(filename) as infile:
 *             content = infile.readlines()
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_filename, __pyx_n_s__endswith);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_38), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_5 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_5) {

  /* "epitopsy/cython/dx_cython.pyx":110
 *     originPattern = re.compile('^origin ([-]?\\d+.\\d+[eE]?[+-]?\\d+?) ([-]?\\d+.\\d+[eE]?[-+]?\\d+?) ([-]?\\d+.\\d+[eE]?[+-]?\\d+?)')
 * 
 *     if filename.endswith('.gz'):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         with gzip.open(filename) as infile:
 *             content = infile.readlines()
 */
  __pyx_k_tuple_38 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_14));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_38)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_38);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_38));
</pre><pre class='line' style='background-color: #FFFF17' onclick='toggleDiv("line111")'> 111:         with gzip.open(filename) as infile:</pre>
<pre id='line111' class='code' style='background-color: #FFFF17'>
    /* "epitopsy/cython/dx_cython.pyx":111
 * 
 *     if filename.endswith('.gz'):
 *         with gzip.open(filename) as infile:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             content = infile.readlines()
 *     else:
 */
    /*with:*/ {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__gzip);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s__open);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_filename);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_filename);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_filename);
      __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      __pyx_t_10 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s____exit__);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
      __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s____enter__);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L5_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L5_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      /*try:*/ {
        {
          <span class='pyx_c_api'>__Pyx_ExceptionSave</span>(&__pyx_t_11, &__pyx_t_12, &__pyx_t_13);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_11);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_12);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_13);
          /*try:*/ {
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
            __pyx_v_infile = __pyx_t_1;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;

          /* "epitopsy/cython/dx_cython.pyx":111
 * 
 *     if filename.endswith('.gz'):
 *         with gzip.open(filename) as infile:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             content = infile.readlines()
 *     else:
 */
          /*except:*/ {
            <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython.read_dxfile", __pyx_clineno, __pyx_lineno, __pyx_filename);
            if (<span class='pyx_c_api'>__Pyx_GetException</span>(&__pyx_t_6, &__pyx_t_1, &__pyx_t_3) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L11_except_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
            __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L11_except_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_6);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_1);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_t_3);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
            __pyx_t_14 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_10, __pyx_t_2, NULL);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
            if (unlikely(!__pyx_t_14))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L11_except_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
            __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_14);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
            if (__pyx_t_5 <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L11_except_error;}</span>
            __pyx_t_4 = ((!(__pyx_t_5 != 0)) != 0);
            if (__pyx_t_4) {
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_6);
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
              <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_6, __pyx_t_1, __pyx_t_3);
              __pyx_t_6 = 0; __pyx_t_1 = 0; __pyx_t_3 = 0; 
             <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L11_except_error;}</span>
              goto __pyx_L20;
            }
            __pyx_L20:;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
            goto __pyx_L10_exception_handled;
          }
          __pyx_L11_except_error:;
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_11);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_12);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_13);
          <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_11, __pyx_t_12, __pyx_t_13);
          goto __pyx_L1_error;
          __pyx_L10_exception_handled:;
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_11);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_12);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_13);
          <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_11, __pyx_t_12, __pyx_t_13);
          __pyx_L16_try_end:;
        }
      }
      /*finally:*/ {
        if (__pyx_t_10) {
          __pyx_t_13 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_10, __pyx_k_tuple_39, NULL);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          if (unlikely(!__pyx_t_13))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
          __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_13);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          if (__pyx_t_4 <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
      }
      goto __pyx_L21;
      __pyx_L5_error:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      goto __pyx_L1_error;
      __pyx_L21:;
    }
    goto __pyx_L4;
  }
  /*else*/ {

  /* "epitopsy/cython/dx_cython.pyx":111
 * 
 *     if filename.endswith('.gz'):
 *         with gzip.open(filename) as infile:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             content = infile.readlines()
 *     else:
 */
  __pyx_k_tuple_39 = <span class='py_c_api'>PyTuple_Pack</span>(3, Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_39)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_39);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_39));
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line112")'> 112:             content = infile.readlines()</pre>
<pre id='line112' class='code' style='background-color: #FFFF5b'>
            /* "epitopsy/cython/dx_cython.pyx":112
 *     if filename.endswith('.gz'):
 *         with gzip.open(filename) as infile:
 *             content = infile.readlines()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     else:
 *         with open(filename) as infile:
 */
            __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_infile, __pyx_n_s__readlines);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L9_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
            __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L9_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_v_content = __pyx_t_6;
            __pyx_t_6 = 0;
          }
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          goto __pyx_L16_try_end;
          __pyx_L9_error:;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line113")'> 113:     else:</pre>
<pre id='line113' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF19' onclick='toggleDiv("line114")'> 114:         with open(filename) as infile:</pre>
<pre id='line114' class='code' style='background-color: #FFFF19'>
    /* "epitopsy/cython/dx_cython.pyx":114
 *             content = infile.readlines()
 *     else:
 *         with open(filename) as infile:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             content = infile.readlines()
 * 
 */
    /*with:*/ {
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_filename);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_filename);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_filename);
      __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_open, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      __pyx_t_10 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s____exit__);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
      __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s____enter__);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L22_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L22_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      /*try:*/ {
        {
          <span class='pyx_c_api'>__Pyx_ExceptionSave</span>(&__pyx_t_13, &__pyx_t_12, &__pyx_t_11);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_13);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_12);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_11);
          /*try:*/ {
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
            __pyx_v_infile = __pyx_t_6;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;

          /* "epitopsy/cython/dx_cython.pyx":114
 *             content = infile.readlines()
 *     else:
 *         with open(filename) as infile:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             content = infile.readlines()
 * 
 */
          /*except:*/ {
            <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython.read_dxfile", __pyx_clineno, __pyx_lineno, __pyx_filename);
            if (<span class='pyx_c_api'>__Pyx_GetException</span>(&__pyx_t_1, &__pyx_t_6, &__pyx_t_3) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L28_except_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
            __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L28_except_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_6);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_t_3);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
            __pyx_t_14 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_10, __pyx_t_2, NULL);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
            if (unlikely(!__pyx_t_14))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L28_except_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
            __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_14);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
            if (__pyx_t_4 <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L28_except_error;}</span>
            __pyx_t_5 = ((!(__pyx_t_4 != 0)) != 0);
            if (__pyx_t_5) {
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_6);
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
              <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_1, __pyx_t_6, __pyx_t_3);
              __pyx_t_1 = 0; __pyx_t_6 = 0; __pyx_t_3 = 0; 
             <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L28_except_error;}</span>
              goto __pyx_L37;
            }
            __pyx_L37:;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
            goto __pyx_L27_exception_handled;
          }
          __pyx_L28_except_error:;
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_13);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_12);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_11);
          <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_13, __pyx_t_12, __pyx_t_11);
          goto __pyx_L1_error;
          __pyx_L27_exception_handled:;
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_13);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_12);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_t_11);
          <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_13, __pyx_t_12, __pyx_t_11);
          __pyx_L33_try_end:;
        }
      }
      /*finally:*/ {
        if (__pyx_t_10) {
          __pyx_t_11 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_10, __pyx_k_tuple_40, NULL);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          if (unlikely(!__pyx_t_11))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
          __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
          if (__pyx_t_5 <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
      }
      goto __pyx_L38;
      __pyx_L22_error:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      goto __pyx_L1_error;
      __pyx_L38:;
    }
  }
  __pyx_L4:;

  /* "epitopsy/cython/dx_cython.pyx":114
 *             content = infile.readlines()
 *     else:
 *         with open(filename) as infile:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             content = infile.readlines()
 * 
 */
  __pyx_k_tuple_40 = <span class='py_c_api'>PyTuple_Pack</span>(3, Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_40)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_40);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_40));
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line115")'> 115:             content = infile.readlines()</pre>
<pre id='line115' class='code' style='background-color: #FFFF5b'>
            /* "epitopsy/cython/dx_cython.pyx":115
 *     else:
 *         with open(filename) as infile:
 *             content = infile.readlines()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef int delta_counter = 0
 */
            __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_infile, __pyx_n_s__readlines);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L26_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
            __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L26_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
            __pyx_v_content = __pyx_t_1;
            __pyx_t_1 = 0;
          }
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
          goto __pyx_L33_try_end;
          __pyx_L26_error:;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line116")'> 116: </pre>
<pre id='line116' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line117")'> 117:     cdef int delta_counter = 0</pre>
<pre id='line117' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":117
 *             content = infile.readlines()
 * 
 *     cdef int delta_counter = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.ndarray[np.float64_t,ndim=1] box
 *     cdef long i_start
 */
  __pyx_v_delta_counter = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line118")'> 118:     cdef np.ndarray[np.float64_t,ndim=1] box</pre>
<pre id='line118' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line119")'> 119:     cdef long i_start</pre>
<pre id='line119' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF29' onclick='toggleDiv("line120")'> 120:     for i_start, line in enumerate(content):</pre>
<pre id='line120' class='code' style='background-color: #FFFF29'>
  /* "epitopsy/cython/dx_cython.pyx":120
 *     cdef np.ndarray[np.float64_t,ndim=1] box
 *     cdef long i_start
 *     for i_start, line in enumerate(content):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if not line.startswith('#'):
 *             if line.startswith('object 1'):
 */
  __pyx_t_15 = 0;
  if (unlikely(!__pyx_v_content)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("content");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_content) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_content)) {
    __pyx_t_3 = __pyx_v_content; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_16 = 0;
    __pyx_t_17 = NULL;
  } else {
    __pyx_t_16 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_content);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_17 = Py_TYPE(__pyx_t_3)->tp_iternext;
  }
  for (;;) {
    if (!__pyx_t_17 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) {
      if (__pyx_t_16 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_16); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_16++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_16); __pyx_t_16++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_17 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
      if (__pyx_t_16 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_16); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_16++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_16); __pyx_t_16++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_6 = __pyx_t_17(__pyx_t_3);
      if (unlikely(!__pyx_t_6)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_line);
    __pyx_v_line = __pyx_t_6;
    __pyx_t_6 = 0;
    __pyx_v_i_start = __pyx_t_15;
    __pyx_t_15 = (__pyx_t_15 + 1);
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line121")'> 121:         if not line.startswith('#'):</pre>
<pre id='line121' class='code' style='background-color: #FFFF4f'>
    /* "epitopsy/cython/dx_cython.pyx":121
 *     cdef long i_start
 *     for i_start, line in enumerate(content):
 *         if not line.startswith('#'):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if line.startswith('object 1'):
 *                 matchedObject = dimensionPattern.search(line)
 */
    __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_line, __pyx_n_s__startswith);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, ((PyObject *)__pyx_k_tuple_41), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_4 = ((!__pyx_t_5) != 0);
    if (__pyx_t_4) {

  /* "epitopsy/cython/dx_cython.pyx":121
 *     cdef long i_start
 *     for i_start, line in enumerate(content):
 *         if not line.startswith('#'):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if line.startswith('object 1'):
 *                 matchedObject = dimensionPattern.search(line)
 */
  __pyx_k_tuple_41 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_18));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_41)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_41);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_41));
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line122")'> 122:             if line.startswith('object 1'):</pre>
<pre id='line122' class='code' style='background-color: #FFFF4f'>
      /* "epitopsy/cython/dx_cython.pyx":122
 *     for i_start, line in enumerate(content):
 *         if not line.startswith('#'):
 *             if line.startswith('object 1'):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 matchedObject = dimensionPattern.search(line)
 *                 dimension[0] = int(matchedObject.group(1))
 */
      __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_line, __pyx_n_s__startswith);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_42), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (__pyx_t_4) {

  /* "epitopsy/cython/dx_cython.pyx":122
 *     for i_start, line in enumerate(content):
 *         if not line.startswith('#'):
 *             if line.startswith('object 1'):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 matchedObject = dimensionPattern.search(line)
 *                 dimension[0] = int(matchedObject.group(1))
 */
  __pyx_k_tuple_42 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_20));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_42)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_42);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_42));
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line123")'> 123:                 matchedObject = dimensionPattern.search(line)</pre>
<pre id='line123' class='code' style='background-color: #FFFF55'>
        /* "epitopsy/cython/dx_cython.pyx":123
 *         if not line.startswith('#'):
 *             if line.startswith('object 1'):
 *                 matchedObject = dimensionPattern.search(line)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 dimension[0] = int(matchedObject.group(1))
 *                 dimension[1] = int(matchedObject.group(2))
 */
        __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_dimensionPattern, __pyx_n_s__search);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_line);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_line);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_line);
        __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_matchedObject);
        __pyx_v_matchedObject = __pyx_t_2;
        __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF37' onclick='toggleDiv("line124")'> 124:                 dimension[0] = int(matchedObject.group(1))</pre>
<pre id='line124' class='code' style='background-color: #FFFF37'>
        /* "epitopsy/cython/dx_cython.pyx":124
 *             if line.startswith('object 1'):
 *                 matchedObject = dimensionPattern.search(line)
 *                 dimension[0] = int(matchedObject.group(1))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 dimension[1] = int(matchedObject.group(2))
 *                 dimension[2] = int(matchedObject.group(3))
 */
        __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_matchedObject, __pyx_n_s__group);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_k_tuple_43), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
        __pyx_t_18 = __Pyx_PyInt_from_py_npy_int64(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_18 == (npy_int64)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_19 = 0;
        __pyx_t_20 = -1;
        if (__pyx_t_19 <code><</code> 0) {
          __pyx_t_19 += __pyx_pybuffernd_dimension.diminfo[0].shape;
          if (unlikely(__pyx_t_19 <code><</code> 0)) __pyx_t_20 = 0;
        } else if (unlikely(__pyx_t_19 >= __pyx_pybuffernd_dimension.diminfo[0].shape)) __pyx_t_20 = 0;
        if (unlikely(__pyx_t_20 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_dimension.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_dimension.diminfo[0].strides) = __pyx_t_18;

  /* "epitopsy/cython/dx_cython.pyx":124
 *             if line.startswith('object 1'):
 *                 matchedObject = dimensionPattern.search(line)
 *                 dimension[0] = int(matchedObject.group(1))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 dimension[1] = int(matchedObject.group(2))
 *                 dimension[2] = int(matchedObject.group(3))
 */
  __pyx_k_tuple_43 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_43)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_43);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_43));
</pre><pre class='line' style='background-color: #FFFF37' onclick='toggleDiv("line125")'> 125:                 dimension[1] = int(matchedObject.group(2))</pre>
<pre id='line125' class='code' style='background-color: #FFFF37'>
        /* "epitopsy/cython/dx_cython.pyx":125
 *                 matchedObject = dimensionPattern.search(line)
 *                 dimension[0] = int(matchedObject.group(1))
 *                 dimension[1] = int(matchedObject.group(2))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 dimension[2] = int(matchedObject.group(3))
 *                 box = np.zeros(dimension[0] * dimension[1] * dimension[2],dtype=np.float64)
 */
        __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_matchedObject, __pyx_n_s__group);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_44), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
        __pyx_t_2 = 0;
        __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
        __pyx_t_18 = __Pyx_PyInt_from_py_npy_int64(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_18 == (npy_int64)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_21 = 1;
        __pyx_t_20 = -1;
        if (__pyx_t_21 <code><</code> 0) {
          __pyx_t_21 += __pyx_pybuffernd_dimension.diminfo[0].shape;
          if (unlikely(__pyx_t_21 <code><</code> 0)) __pyx_t_20 = 0;
        } else if (unlikely(__pyx_t_21 >= __pyx_pybuffernd_dimension.diminfo[0].shape)) __pyx_t_20 = 0;
        if (unlikely(__pyx_t_20 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_dimension.rcbuffer->pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_dimension.diminfo[0].strides) = __pyx_t_18;

  /* "epitopsy/cython/dx_cython.pyx":125
 *                 matchedObject = dimensionPattern.search(line)
 *                 dimension[0] = int(matchedObject.group(1))
 *                 dimension[1] = int(matchedObject.group(2))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 dimension[2] = int(matchedObject.group(3))
 *                 box = np.zeros(dimension[0] * dimension[1] * dimension[2],dtype=np.float64)
 */
  __pyx_k_tuple_44 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_44)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_44);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_44));
</pre><pre class='line' style='background-color: #FFFF37' onclick='toggleDiv("line126")'> 126:                 dimension[2] = int(matchedObject.group(3))</pre>
<pre id='line126' class='code' style='background-color: #FFFF37'>
        /* "epitopsy/cython/dx_cython.pyx":126
 *                 dimension[0] = int(matchedObject.group(1))
 *                 dimension[1] = int(matchedObject.group(2))
 *                 dimension[2] = int(matchedObject.group(3))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 box = np.zeros(dimension[0] * dimension[1] * dimension[2],dtype=np.float64)
 *             elif line.startswith('origin'):
 */
        __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_matchedObject, __pyx_n_s__group);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_k_tuple_45), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
        __pyx_t_18 = __Pyx_PyInt_from_py_npy_int64(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_18 == (npy_int64)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_22 = 2;
        __pyx_t_20 = -1;
        if (__pyx_t_22 <code><</code> 0) {
          __pyx_t_22 += __pyx_pybuffernd_dimension.diminfo[0].shape;
          if (unlikely(__pyx_t_22 <code><</code> 0)) __pyx_t_20 = 0;
        } else if (unlikely(__pyx_t_22 >= __pyx_pybuffernd_dimension.diminfo[0].shape)) __pyx_t_20 = 0;
        if (unlikely(__pyx_t_20 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_dimension.rcbuffer->pybuffer.buf, __pyx_t_22, __pyx_pybuffernd_dimension.diminfo[0].strides) = __pyx_t_18;

  /* "epitopsy/cython/dx_cython.pyx":126
 *                 dimension[0] = int(matchedObject.group(1))
 *                 dimension[1] = int(matchedObject.group(2))
 *                 dimension[2] = int(matchedObject.group(3))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 box = np.zeros(dimension[0] * dimension[1] * dimension[2],dtype=np.float64)
 *             elif line.startswith('origin'):
 */
  __pyx_k_tuple_45 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_45)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_45);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_45));
</pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line127")'> 127:                 box = np.zeros(dimension[0] * dimension[1] * dimension[2],dtype=np.float64)</pre>
<pre id='line127' class='code' style='background-color: #FFFF20'>
        /* "epitopsy/cython/dx_cython.pyx":127
 *                 dimension[1] = int(matchedObject.group(2))
 *                 dimension[2] = int(matchedObject.group(3))
 *                 box = np.zeros(dimension[0] * dimension[1] * dimension[2],dtype=np.float64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             elif line.startswith('origin'):
 *                 matchedOrigin = line.split(' ')
 */
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_23 = 0;
        __pyx_t_20 = -1;
        if (__pyx_t_23 <code><</code> 0) {
          __pyx_t_23 += __pyx_pybuffernd_dimension.diminfo[0].shape;
          if (unlikely(__pyx_t_23 <code><</code> 0)) __pyx_t_20 = 0;
        } else if (unlikely(__pyx_t_23 >= __pyx_pybuffernd_dimension.diminfo[0].shape)) __pyx_t_20 = 0;
        if (unlikely(__pyx_t_20 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_24 = 1;
        __pyx_t_20 = -1;
        if (__pyx_t_24 <code><</code> 0) {
          __pyx_t_24 += __pyx_pybuffernd_dimension.diminfo[0].shape;
          if (unlikely(__pyx_t_24 <code><</code> 0)) __pyx_t_20 = 0;
        } else if (unlikely(__pyx_t_24 >= __pyx_pybuffernd_dimension.diminfo[0].shape)) __pyx_t_20 = 0;
        if (unlikely(__pyx_t_20 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_25 = 2;
        __pyx_t_20 = -1;
        if (__pyx_t_25 <code><</code> 0) {
          __pyx_t_25 += __pyx_pybuffernd_dimension.diminfo[0].shape;
          if (unlikely(__pyx_t_25 <code><</code> 0)) __pyx_t_20 = 0;
        } else if (unlikely(__pyx_t_25 >= __pyx_pybuffernd_dimension.diminfo[0].shape)) __pyx_t_20 = 0;
        if (unlikely(__pyx_t_20 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_1 = __Pyx_PyInt_to_py_npy_int64((((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_dimension.rcbuffer->pybuffer.buf, __pyx_t_23, __pyx_pybuffernd_dimension.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_dimension.rcbuffer->pybuffer.buf, __pyx_t_24, __pyx_pybuffernd_dimension.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_dimension.rcbuffer->pybuffer.buf, __pyx_t_25, __pyx_pybuffernd_dimension.diminfo[0].strides))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
        __pyx_t_26 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_26)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_26);
        __pyx_t_27 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_26, __pyx_n_s__float64);<span class='error_goto'> if (unlikely(!__pyx_t_27)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_27);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
        if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, ((PyObject *)__pyx_n_s__dtype), __pyx_t_27) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_27); __pyx_t_27 = 0;
        __pyx_t_27 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_6), ((PyObject *)__pyx_t_1));<span class='error_goto'> if (unlikely(!__pyx_t_27)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_27);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
        if (!(likely(((__pyx_t_27) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_27, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_28 = ((PyArrayObject *)__pyx_t_27);
        {
          __Pyx_BufFmt_StackElem __pyx_stack[1];
          <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer);
          __pyx_t_20 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer, (PyObject*)__pyx_t_28, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack);
          if (unlikely(__pyx_t_20 <code><</code> 0)) {
            <span class='py_c_api'>PyErr_Fetch</span>(&__pyx_t_10, &__pyx_t_11, &__pyx_t_12);
            if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer, (PyObject*)__pyx_v_box, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
              Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_11); Py_XDECREF(__pyx_t_12);
              <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
            } else {
              <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_10, __pyx_t_11, __pyx_t_12);
            }
          }
          __pyx_pybuffernd_box.diminfo[0].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_box.diminfo[0].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[0];
          if (unlikely(__pyx_t_20 <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_28 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_v_box));
        __pyx_v_box = ((PyArrayObject *)__pyx_t_27);
        __pyx_t_27 = 0;
        goto __pyx_L42;
      }
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line128")'> 128:             elif line.startswith('origin'):</pre>
<pre id='line128' class='code' style='background-color: #FFFF4f'>
      /* "epitopsy/cython/dx_cython.pyx":128
 *                 dimension[2] = int(matchedObject.group(3))
 *                 box = np.zeros(dimension[0] * dimension[1] * dimension[2],dtype=np.float64)
 *             elif line.startswith('origin'):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 matchedOrigin = line.split(' ')
 *                 offset[0] = float(matchedOrigin[1])
 */
      __pyx_t_27 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_line, __pyx_n_s__startswith);<span class='error_goto'> if (unlikely(!__pyx_t_27)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_27);
      __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_27, ((PyObject *)__pyx_k_tuple_46), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_27); __pyx_t_27 = 0;
      __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (__pyx_t_4) {

  /* "epitopsy/cython/dx_cython.pyx":128
 *                 dimension[2] = int(matchedObject.group(3))
 *                 box = np.zeros(dimension[0] * dimension[1] * dimension[2],dtype=np.float64)
 *             elif line.startswith('origin'):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 matchedOrigin = line.split(' ')
 *                 offset[0] = float(matchedOrigin[1])
 */
  __pyx_k_tuple_46 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_n_s__origin));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_46)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_46);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_46));
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line129")'> 129:                 matchedOrigin = line.split(' ')</pre>
<pre id='line129' class='code' style='background-color: #FFFF5e'>
        /* "epitopsy/cython/dx_cython.pyx":129
 *                 box = np.zeros(dimension[0] * dimension[1] * dimension[2],dtype=np.float64)
 *             elif line.startswith('origin'):
 *                 matchedOrigin = line.split(' ')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 offset[0] = float(matchedOrigin[1])
 *                 offset[1] = float(matchedOrigin[2])
 */
        __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_line, __pyx_n_s__split);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_t_27 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_47), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_27)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_27);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_matchedOrigin);
        __pyx_v_matchedOrigin = __pyx_t_27;
        __pyx_t_27 = 0;

  /* "epitopsy/cython/dx_cython.pyx":129
 *                 box = np.zeros(dimension[0] * dimension[1] * dimension[2],dtype=np.float64)
 *             elif line.startswith('origin'):
 *                 matchedOrigin = line.split(' ')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 offset[0] = float(matchedOrigin[1])
 *                 offset[1] = float(matchedOrigin[2])
 */
  __pyx_k_tuple_47 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_26));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_47)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_47);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_47));
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line130")'> 130:                 offset[0] = float(matchedOrigin[1])</pre>
<pre id='line130' class='code' style='background-color: #FFFF66'>
        /* "epitopsy/cython/dx_cython.pyx":130
 *             elif line.startswith('origin'):
 *                 matchedOrigin = line.split(' ')
 *                 offset[0] = float(matchedOrigin[1])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 offset[1] = float(matchedOrigin[2])
 *                 offset[2] = float(matchedOrigin[3])
 */
        __pyx_t_27 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_matchedOrigin, 1, sizeof(long), PyInt_FromLong, 0, 0, 1);<span class='error_goto'> if (!__pyx_t_27) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_27);
        __pyx_t_29 = __Pyx_<span class='py_c_api'>PyObject_AsDouble</span>(__pyx_t_27);<span class='error_goto'> if (unlikely(__pyx_t_29 == ((double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_27); __pyx_t_27 = 0;
        __pyx_t_30 = 0;
        __pyx_t_20 = -1;
        if (__pyx_t_30 <code><</code> 0) {
          __pyx_t_30 += __pyx_pybuffernd_offset.diminfo[0].shape;
          if (unlikely(__pyx_t_30 <code><</code> 0)) __pyx_t_20 = 0;
        } else if (unlikely(__pyx_t_30 >= __pyx_pybuffernd_offset.diminfo[0].shape)) __pyx_t_20 = 0;
        if (unlikely(__pyx_t_20 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_offset.rcbuffer->pybuffer.buf, __pyx_t_30, __pyx_pybuffernd_offset.diminfo[0].strides) = __pyx_t_29;
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line131")'> 131:                 offset[1] = float(matchedOrigin[2])</pre>
<pre id='line131' class='code' style='background-color: #FFFF66'>
        /* "epitopsy/cython/dx_cython.pyx":131
 *                 matchedOrigin = line.split(' ')
 *                 offset[0] = float(matchedOrigin[1])
 *                 offset[1] = float(matchedOrigin[2])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 offset[2] = float(matchedOrigin[3])
 *             elif line.startswith('delta'):
 */
        __pyx_t_27 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_matchedOrigin, 2, sizeof(long), PyInt_FromLong, 0, 0, 1);<span class='error_goto'> if (!__pyx_t_27) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_27);
        __pyx_t_29 = __Pyx_<span class='py_c_api'>PyObject_AsDouble</span>(__pyx_t_27);<span class='error_goto'> if (unlikely(__pyx_t_29 == ((double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_27); __pyx_t_27 = 0;
        __pyx_t_31 = 1;
        __pyx_t_20 = -1;
        if (__pyx_t_31 <code><</code> 0) {
          __pyx_t_31 += __pyx_pybuffernd_offset.diminfo[0].shape;
          if (unlikely(__pyx_t_31 <code><</code> 0)) __pyx_t_20 = 0;
        } else if (unlikely(__pyx_t_31 >= __pyx_pybuffernd_offset.diminfo[0].shape)) __pyx_t_20 = 0;
        if (unlikely(__pyx_t_20 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_offset.rcbuffer->pybuffer.buf, __pyx_t_31, __pyx_pybuffernd_offset.diminfo[0].strides) = __pyx_t_29;
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line132")'> 132:                 offset[2] = float(matchedOrigin[3])</pre>
<pre id='line132' class='code' style='background-color: #FFFF66'>
        /* "epitopsy/cython/dx_cython.pyx":132
 *                 offset[0] = float(matchedOrigin[1])
 *                 offset[1] = float(matchedOrigin[2])
 *                 offset[2] = float(matchedOrigin[3])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             elif line.startswith('delta'):
 *                     delta_split = line.split()
 */
        __pyx_t_27 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_matchedOrigin, 3, sizeof(long), PyInt_FromLong, 0, 0, 1);<span class='error_goto'> if (!__pyx_t_27) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_27);
        __pyx_t_29 = __Pyx_<span class='py_c_api'>PyObject_AsDouble</span>(__pyx_t_27);<span class='error_goto'> if (unlikely(__pyx_t_29 == ((double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_27); __pyx_t_27 = 0;
        __pyx_t_32 = 2;
        __pyx_t_20 = -1;
        if (__pyx_t_32 <code><</code> 0) {
          __pyx_t_32 += __pyx_pybuffernd_offset.diminfo[0].shape;
          if (unlikely(__pyx_t_32 <code><</code> 0)) __pyx_t_20 = 0;
        } else if (unlikely(__pyx_t_32 >= __pyx_pybuffernd_offset.diminfo[0].shape)) __pyx_t_20 = 0;
        if (unlikely(__pyx_t_20 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_offset.rcbuffer->pybuffer.buf, __pyx_t_32, __pyx_pybuffernd_offset.diminfo[0].strides) = __pyx_t_29;
        goto __pyx_L42;
      }
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line133")'> 133:             elif line.startswith('delta'):</pre>
<pre id='line133' class='code' style='background-color: #FFFF4f'>
      /* "epitopsy/cython/dx_cython.pyx":133
 *                 offset[1] = float(matchedOrigin[2])
 *                 offset[2] = float(matchedOrigin[3])
 *             elif line.startswith('delta'):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     delta_split = line.split()
 *                     meshsize[delta_counter] = float(delta_split[delta_counter+1])
 */
      __pyx_t_27 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_line, __pyx_n_s__startswith);<span class='error_goto'> if (unlikely(!__pyx_t_27)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_27);
      __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_27, ((PyObject *)__pyx_k_tuple_48), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_27); __pyx_t_27 = 0;
      __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (__pyx_t_4) {

  /* "epitopsy/cython/dx_cython.pyx":133
 *                 offset[1] = float(matchedOrigin[2])
 *                 offset[2] = float(matchedOrigin[3])
 *             elif line.startswith('delta'):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     delta_split = line.split()
 *                     meshsize[delta_counter] = float(delta_split[delta_counter+1])
 */
  __pyx_k_tuple_48 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_n_s__delta));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_48)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_48);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_48));
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line134")'> 134:                     delta_split = line.split()</pre>
<pre id='line134' class='code' style='background-color: #FFFF73'>
        /* "epitopsy/cython/dx_cython.pyx":134
 *                 offset[2] = float(matchedOrigin[3])
 *             elif line.startswith('delta'):
 *                     delta_split = line.split()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     meshsize[delta_counter] = float(delta_split[delta_counter+1])
 *                     delta_counter += 1
 */
        __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_line, __pyx_n_s__split);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_t_27 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_27)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_27);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_delta_split);
        __pyx_v_delta_split = __pyx_t_27;
        __pyx_t_27 = 0;
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line135")'> 135:                     meshsize[delta_counter] = float(delta_split[delta_counter+1])</pre>
<pre id='line135' class='code' style='background-color: #FFFF66'>
        /* "epitopsy/cython/dx_cython.pyx":135
 *             elif line.startswith('delta'):
 *                     delta_split = line.split()
 *                     meshsize[delta_counter] = float(delta_split[delta_counter+1])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     delta_counter += 1
 * 
 */
        __pyx_t_33 = (__pyx_v_delta_counter + 1);
        __pyx_t_27 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_delta_split, __pyx_t_33, sizeof(long), PyInt_FromLong, 0, 1, 1);<span class='error_goto'> if (!__pyx_t_27) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_27);
        __pyx_t_29 = __Pyx_<span class='py_c_api'>PyObject_AsDouble</span>(__pyx_t_27);<span class='error_goto'> if (unlikely(__pyx_t_29 == ((double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_27); __pyx_t_27 = 0;
        __pyx_t_20 = __pyx_v_delta_counter;
        __pyx_t_34 = -1;
        if (__pyx_t_20 <code><</code> 0) {
          __pyx_t_20 += __pyx_pybuffernd_meshsize.diminfo[0].shape;
          if (unlikely(__pyx_t_20 <code><</code> 0)) __pyx_t_34 = 0;
        } else if (unlikely(__pyx_t_20 >= __pyx_pybuffernd_meshsize.diminfo[0].shape)) __pyx_t_34 = 0;
        if (unlikely(__pyx_t_34 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_34);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_meshsize.rcbuffer->pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_meshsize.diminfo[0].strides) = __pyx_t_29;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line136")'> 136:                     delta_counter += 1</pre>
<pre id='line136' class='code' style='background-color: #FFFFff'>
        /* "epitopsy/cython/dx_cython.pyx":136
 *                     delta_split = line.split()
 *                     meshsize[delta_counter] = float(delta_split[delta_counter+1])
 *                     delta_counter += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             if valuePattern.match(line):
 */
        __pyx_v_delta_counter = (__pyx_v_delta_counter + 1);
        goto __pyx_L42;
      }
      __pyx_L42:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line137")'> 137: </pre>
<pre id='line137' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF48' onclick='toggleDiv("line138")'> 138:             if valuePattern.match(line):</pre>
<pre id='line138' class='code' style='background-color: #FFFF48'>
      /* "epitopsy/cython/dx_cython.pyx":138
 *                     delta_counter += 1
 * 
 *             if valuePattern.match(line):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 break
 * 
 */
      __pyx_t_27 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_valuePattern, __pyx_n_s__match);<span class='error_goto'> if (unlikely(!__pyx_t_27)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_27);
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_line);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_line);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_line);
      __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_27, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_27); __pyx_t_27 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
      __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line139")'> 139:                 break</pre>
<pre id='line139' class='code' style='background-color: #FFFFe7'>
        /* "epitopsy/cython/dx_cython.pyx":139
 * 
 *             if valuePattern.match(line):
 *                 break             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef long i,j
 */
        goto __pyx_L40_break;
        goto __pyx_L43;
      }
      __pyx_L43:;
      goto __pyx_L41;
    }
    __pyx_L41:;
  }
  __pyx_L40_break:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line140")'> 140: </pre>
<pre id='line140' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line141")'> 141:     cdef long i,j</pre>
<pre id='line141' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line142")'> 142:     cdef long n_elements = dimension[0] * dimension[1] * dimension[2]</pre>
<pre id='line142' class='code' style='background-color: #FFFF9f'>
  /* "epitopsy/cython/dx_cython.pyx":142
 * 
 *     cdef long i,j
 *     cdef long n_elements = dimension[0] * dimension[1] * dimension[2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef long i_end = 1 + i_start + <code><</code>long> ceil( (<code><</code>double> n_elements) / 3.)
 *     for i in range(i_start, i_end):
 */
  __pyx_t_15 = 0;
  __pyx_t_34 = -1;
  if (__pyx_t_15 <code><</code> 0) {
    __pyx_t_15 += __pyx_pybuffernd_dimension.diminfo[0].shape;
    if (unlikely(__pyx_t_15 <code><</code> 0)) __pyx_t_34 = 0;
  } else if (unlikely(__pyx_t_15 >= __pyx_pybuffernd_dimension.diminfo[0].shape)) __pyx_t_34 = 0;
  if (unlikely(__pyx_t_34 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_34);
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_33 = 1;
  __pyx_t_34 = -1;
  if (__pyx_t_33 <code><</code> 0) {
    __pyx_t_33 += __pyx_pybuffernd_dimension.diminfo[0].shape;
    if (unlikely(__pyx_t_33 <code><</code> 0)) __pyx_t_34 = 0;
  } else if (unlikely(__pyx_t_33 >= __pyx_pybuffernd_dimension.diminfo[0].shape)) __pyx_t_34 = 0;
  if (unlikely(__pyx_t_34 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_34);
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_35 = 2;
  __pyx_t_34 = -1;
  if (__pyx_t_35 <code><</code> 0) {
    __pyx_t_35 += __pyx_pybuffernd_dimension.diminfo[0].shape;
    if (unlikely(__pyx_t_35 <code><</code> 0)) __pyx_t_34 = 0;
  } else if (unlikely(__pyx_t_35 >= __pyx_pybuffernd_dimension.diminfo[0].shape)) __pyx_t_34 = 0;
  if (unlikely(__pyx_t_34 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_34);
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_v_n_elements = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_dimension.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_dimension.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_dimension.rcbuffer->pybuffer.buf, __pyx_t_33, __pyx_pybuffernd_dimension.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_dimension.rcbuffer->pybuffer.buf, __pyx_t_35, __pyx_pybuffernd_dimension.diminfo[0].strides)));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line143")'> 143:     cdef long i_end = 1 + i_start + &lt;long&gt; ceil( (&lt;double&gt; n_elements) / 3.)</pre>
<pre id='line143' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":143
 *     cdef long i,j
 *     cdef long n_elements = dimension[0] * dimension[1] * dimension[2]
 *     cdef long i_end = 1 + i_start + <code><</code>long> ceil( (<code><</code>double> n_elements) / 3.)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     for i in range(i_start, i_end):
 *         line_content = content[i].split(' ')
 */
  __pyx_v_i_end = ((1 + __pyx_v_i_start) + ((long)ceil((((double)__pyx_v_n_elements) / 3.))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line144")'> 144:     for i in range(i_start, i_end):</pre>
<pre id='line144' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":144
 *     cdef long n_elements = dimension[0] * dimension[1] * dimension[2]
 *     cdef long i_end = 1 + i_start + <code><</code>long> ceil( (<code><</code>double> n_elements) / 3.)
 *     for i in range(i_start, i_end):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         line_content = content[i].split(' ')
 *         for j in range(3):
 */
  __pyx_t_36 = __pyx_v_i_end;
  for (__pyx_t_37 = __pyx_v_i_start; __pyx_t_37 <code><</code> __pyx_t_36; __pyx_t_37+=1) {
    __pyx_v_i = __pyx_t_37;
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line145")'> 145:         line_content = content[i].split(' ')</pre>
<pre id='line145' class='code' style='background-color: #FFFF55'>
    /* "epitopsy/cython/dx_cython.pyx":145
 *     cdef long i_end = 1 + i_start + <code><</code>long> ceil( (<code><</code>double> n_elements) / 3.)
 *     for i in range(i_start, i_end):
 *         line_content = content[i].split(' ')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for j in range(3):
 *             if counter <code><</code> n_elements:
 */
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_content, __pyx_v_i, sizeof(long), PyInt_FromLong, 0, 1, 1);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s__split);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, ((PyObject *)__pyx_k_tuple_49), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_line_content);
    __pyx_v_line_content = __pyx_t_3;
    __pyx_t_3 = 0;

  /* "epitopsy/cython/dx_cython.pyx":145
 *     cdef long i_end = 1 + i_start + <code><</code>long> ceil( (<code><</code>double> n_elements) / 3.)
 *     for i in range(i_start, i_end):
 *         line_content = content[i].split(' ')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for j in range(3):
 *             if counter <code><</code> n_elements:
 */
  __pyx_k_tuple_49 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_26));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_49)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_49);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_49));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line146")'> 146:         for j in range(3):</pre>
<pre id='line146' class='code' style='background-color: #FFFFff'>
    /* "epitopsy/cython/dx_cython.pyx":146
 *     for i in range(i_start, i_end):
 *         line_content = content[i].split(' ')
 *         for j in range(3):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if counter <code><</code> n_elements:
 *                 box[counter] = float(line_content[j])
 */
    for (__pyx_t_38 = 0; __pyx_t_38 <code><</code> 3; __pyx_t_38+=1) {
      __pyx_v_j = __pyx_t_38;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line147")'> 147:             if counter &lt; n_elements:</pre>
<pre id='line147' class='code' style='background-color: #FFFFff'>
      /* "epitopsy/cython/dx_cython.pyx":147
 *         line_content = content[i].split(' ')
 *         for j in range(3):
 *             if counter <code><</code> n_elements:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 box[counter] = float(line_content[j])
 *                 counter += 1
 */
      __pyx_t_4 = ((__pyx_v_counter <code><</code> __pyx_v_n_elements) != 0);
      if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line148")'> 148:                 box[counter] = float(line_content[j])</pre>
<pre id='line148' class='code' style='background-color: #FFFF66'>
        /* "epitopsy/cython/dx_cython.pyx":148
 *         for j in range(3):
 *             if counter <code><</code> n_elements:
 *                 box[counter] = float(line_content[j])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 counter += 1
 * 
 */
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_line_content, __pyx_v_j, sizeof(long), PyInt_FromLong, 0, 1, 1);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
        __pyx_t_29 = __Pyx_<span class='py_c_api'>PyObject_AsDouble</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_29 == ((double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_39 = __pyx_v_counter;
        __pyx_t_34 = -1;
        if (__pyx_t_39 <code><</code> 0) {
          __pyx_t_39 += __pyx_pybuffernd_box.diminfo[0].shape;
          if (unlikely(__pyx_t_39 <code><</code> 0)) __pyx_t_34 = 0;
        } else if (unlikely(__pyx_t_39 >= __pyx_pybuffernd_box.diminfo[0].shape)) __pyx_t_34 = 0;
        if (unlikely(__pyx_t_34 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_34);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_39, __pyx_pybuffernd_box.diminfo[0].strides) = __pyx_t_29;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line149")'> 149:                 counter += 1</pre>
<pre id='line149' class='code' style='background-color: #FFFFff'>
        /* "epitopsy/cython/dx_cython.pyx":149
 *             if counter <code><</code> n_elements:
 *                 box[counter] = float(line_content[j])
 *                 counter += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef np.ndarray[np.float64_t,ndim=3] box_3d = box.reshape(dimension)
 */
        __pyx_v_counter = (__pyx_v_counter + 1);
        goto __pyx_L48;
      }
      __pyx_L48:;
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line150")'> 150: </pre>
<pre id='line150' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF4b' onclick='toggleDiv("line151")'> 151:     cdef np.ndarray[np.float64_t,ndim=3] box_3d = box.reshape(dimension)</pre>
<pre id='line151' class='code' style='background-color: #FFFF4b'>
  /* "epitopsy/cython/dx_cython.pyx":151
 *                 counter += 1
 * 
 *     cdef np.ndarray[np.float64_t,ndim=3] box_3d = box.reshape(dimension)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     return [box_3d, meshsize, offset]
 */
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_box), __pyx_n_s__reshape);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_dimension));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, ((PyObject *)__pyx_v_dimension));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_dimension));
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_6), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_40 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_box_3d.rcbuffer->pybuffer, (PyObject*)__pyx_t_40, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) {
      __pyx_v_box_3d = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_box_3d.rcbuffer->pybuffer.buf = NULL;
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_box_3d.diminfo[0].strides = __pyx_pybuffernd_box_3d.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_box_3d.diminfo[0].shape = __pyx_pybuffernd_box_3d.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_box_3d.diminfo[1].strides = __pyx_pybuffernd_box_3d.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_box_3d.diminfo[1].shape = __pyx_pybuffernd_box_3d.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_box_3d.diminfo[2].strides = __pyx_pybuffernd_box_3d.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_box_3d.diminfo[2].shape = __pyx_pybuffernd_box_3d.rcbuffer->pybuffer.shape[2];
    }
  }
  __pyx_t_40 = 0;
  __pyx_v_box_3d = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line152")'> 152: </pre>
<pre id='line152' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF13' onclick='toggleDiv("line153")'> 153:     return [box_3d, meshsize, offset]</pre>
<pre id='line153' class='code' style='background-color: #FFFF13'>
  /* "epitopsy/cython/dx_cython.pyx":153
 *     cdef np.ndarray[np.float64_t,ndim=3] box_3d = box.reshape(dimension)
 * 
 *     return [box_3d, meshsize, offset]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * def write_box(outfile, np.ndarray[np.float64_t,ndim=3]box_np,int values_per_line):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 153; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_box_3d));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_box_3d));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_box_3d));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_meshsize));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_meshsize));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_meshsize));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_offset));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 2, ((PyObject *)__pyx_v_offset));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_offset));
  __pyx_r = ((PyObject *)__pyx_t_1);
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_26);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_27);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&__pyx_type, &__pyx_value, &__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box_3d.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_dimension.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_meshsize.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_offset.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython.read_dxfile", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box_3d.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_dimension.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_meshsize.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_offset.rcbuffer->pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_dimension);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_offset);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_meshsize);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dimensionPattern);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_lastHeaderLinePattern);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_objectPattern);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_valuePattern);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_originPattern);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_infile);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_content);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_box);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_line);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_matchedObject);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_matchedOrigin);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_delta_split);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_line_content);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_box_3d);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_filename);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_8epitopsy_6cython_9dx_cython_5write_box(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_8epitopsy_6cython_9dx_cython_5write_box = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("write_box"), (PyCFunction)__pyx_pw_8epitopsy_6cython_9dx_cython_5write_box, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_8epitopsy_6cython_9dx_cython_5write_box(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_outfile = 0;
  PyArrayObject *__pyx_v_box_np = 0;
  int __pyx_v_values_per_line;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("write_box (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__outfile,&__pyx_n_s__box_np,&__pyx_n_s__values_per_line,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__outfile)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__box_np)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("write_box", 1, 3, 3, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__values_per_line)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("write_box", 1, 3, 3, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "write_box") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_outfile = values[0];
    __pyx_v_box_np = ((PyArrayObject *)values[1]);
    __pyx_v_values_per_line = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[2]);<span class='error_goto'> if (unlikely((__pyx_v_values_per_line == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("write_box", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython.write_box", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_box_np), __pyx_ptype_5numpy_ndarray, 1, "box_np", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_8epitopsy_6cython_9dx_cython_4write_box(__pyx_self, __pyx_v_outfile, __pyx_v_box_np, __pyx_v_values_per_line);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line154")'> 154: </pre>
<pre id='line154' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line155")'> 155: def write_box(outfile, np.ndarray[np.float64_t,ndim=3]box_np,int values_per_line):</pre>
<pre id='line155' class='code' style='background-color: #FFFF5b'>
/* "epitopsy/cython/dx_cython.pyx":155
 *     return [box_3d, meshsize, offset]
 * 
 * def write_box(outfile, np.ndarray[np.float64_t,ndim=3]box_np,int values_per_line):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int value_count = 0
 *     cdef int x,y,z
 */

static PyObject *__pyx_pf_8epitopsy_6cython_9dx_cython_4write_box(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_outfile, PyArrayObject *__pyx_v_box_np, int __pyx_v_values_per_line) {
  int __pyx_v_value_count;
  int __pyx_v_x;
  int __pyx_v_y;
  int __pyx_v_z;
  int __pyx_v_xdim;
  int __pyx_v_ydim;
  int __pyx_v_zdim;
  __Pyx_memviewslice __pyx_v_box = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_LocalBuf_ND __pyx_pybuffernd_box_np;
  __Pyx_Buffer __pyx_pybuffer_box_np;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("write_box", 0);
  __pyx_pybuffer_box_np.pybuffer.buf = NULL;
  __pyx_pybuffer_box_np.refcount = 0;
  __pyx_pybuffernd_box_np.data = NULL;
  __pyx_pybuffernd_box_np.rcbuffer = &__pyx_pybuffer_box_np;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_box_np.rcbuffer->pybuffer, (PyObject*)__pyx_v_box_np, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_box_np.diminfo[0].strides = __pyx_pybuffernd_box_np.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_box_np.diminfo[0].shape = __pyx_pybuffernd_box_np.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_box_np.diminfo[1].strides = __pyx_pybuffernd_box_np.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_box_np.diminfo[1].shape = __pyx_pybuffernd_box_np.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_box_np.diminfo[2].strides = __pyx_pybuffernd_box_np.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_box_np.diminfo[2].shape = __pyx_pybuffernd_box_np.rcbuffer->pybuffer.shape[2];

  /* "epitopsy/cython/dx_cython.pyx":155
 *     return [box_3d, meshsize, offset]
 * 
 * def write_box(outfile, np.ndarray[np.float64_t,ndim=3]box_np,int values_per_line):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int value_count = 0
 *     cdef int x,y,z
 */
  __pyx_k_tuple_113 = <span class='py_c_api'>PyTuple_Pack</span>(11, ((PyObject *)__pyx_n_s__outfile), ((PyObject *)__pyx_n_s__box_np), ((PyObject *)__pyx_n_s__values_per_line), ((PyObject *)__pyx_n_s__value_count), ((PyObject *)__pyx_n_s__x), ((PyObject *)__pyx_n_s__y), ((PyObject *)__pyx_n_s__z), ((PyObject *)__pyx_n_s__xdim), ((PyObject *)__pyx_n_s__ydim), ((PyObject *)__pyx_n_s__zdim), ((PyObject *)__pyx_n_s__box));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_113)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_113);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_113));

  /* "epitopsy/cython/dx_cython.pyx":155
 *     return [box_3d, meshsize, offset]
 * 
 * def write_box(outfile, np.ndarray[np.float64_t,ndim=3]box_np,int values_per_line):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int value_count = 0
 *     cdef int x,y,z
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_8epitopsy_6cython_9dx_cython_5write_box, NULL, __pyx_n_s_110);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__write_box, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_114 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(3, 0, 11, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_113, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_109, __pyx_n_s__write_box, 155, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_114)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line156")'> 156:     cdef int value_count = 0</pre>
<pre id='line156' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":156
 * 
 * def write_box(outfile, np.ndarray[np.float64_t,ndim=3]box_np,int values_per_line):
 *     cdef int value_count = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int x,y,z
 *     cdef int xdim = box_np.shape[0]
 */
  __pyx_v_value_count = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line157")'> 157:     cdef int x,y,z</pre>
<pre id='line157' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line158")'> 158:     cdef int xdim = box_np.shape[0]</pre>
<pre id='line158' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":158
 *     cdef int value_count = 0
 *     cdef int x,y,z
 *     cdef int xdim = box_np.shape[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int ydim = box_np.shape[1]
 *     cdef int zdim = box_np.shape[2]
 */
  __pyx_v_xdim = (__pyx_v_box_np->dimensions[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line159")'> 159:     cdef int ydim = box_np.shape[1]</pre>
<pre id='line159' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":159
 *     cdef int x,y,z
 *     cdef int xdim = box_np.shape[0]
 *     cdef int ydim = box_np.shape[1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int zdim = box_np.shape[2]
 *     cdef double[:,:,:] box = box_np
 */
  __pyx_v_ydim = (__pyx_v_box_np->dimensions[1]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line160")'> 160:     cdef int zdim = box_np.shape[2]</pre>
<pre id='line160' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":160
 *     cdef int xdim = box_np.shape[0]
 *     cdef int ydim = box_np.shape[1]
 *     cdef int zdim = box_np.shape[2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef double[:,:,:] box = box_np
 *     for x in range(xdim):
 */
  __pyx_v_zdim = (__pyx_v_box_np->dimensions[2]);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line161")'> 161:     cdef double[:,:,:] box = box_np</pre>
<pre id='line161' class='code' style='background-color: #FFFFd4'>
  /* "epitopsy/cython/dx_cython.pyx":161
 *     cdef int ydim = box_np.shape[1]
 *     cdef int zdim = box_np.shape[2]
 *     cdef double[:,:,:] box = box_np             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     for x in range(xdim):
 *         for y in range(ydim):
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_double</span>(((PyObject *)__pyx_v_box_np));
  if (unlikely(!__pyx_t_1.memview))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_box = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line162")'> 162:     for x in range(xdim):</pre>
<pre id='line162' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":162
 *     cdef int zdim = box_np.shape[2]
 *     cdef double[:,:,:] box = box_np
 *     for x in range(xdim):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for y in range(ydim):
 *             for z in range(zdim):
 */
  __pyx_t_2 = __pyx_v_xdim;
  for (__pyx_t_3 = 0; __pyx_t_3 <code><</code> __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_x = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line163")'> 163:         for y in range(ydim):</pre>
<pre id='line163' class='code' style='background-color: #FFFFff'>
    /* "epitopsy/cython/dx_cython.pyx":163
 *     cdef double[:,:,:] box = box_np
 *     for x in range(xdim):
 *         for y in range(ydim):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for z in range(zdim):
 *                 outfile.write("{0:e} ".format(box[x, y, z]))
 */
    __pyx_t_4 = __pyx_v_ydim;
    for (__pyx_t_5 = 0; __pyx_t_5 <code><</code> __pyx_t_4; __pyx_t_5+=1) {
      __pyx_v_y = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line164")'> 164:             for z in range(zdim):</pre>
<pre id='line164' class='code' style='background-color: #FFFFff'>
      /* "epitopsy/cython/dx_cython.pyx":164
 *     for x in range(xdim):
 *         for y in range(ydim):
 *             for z in range(zdim):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 outfile.write("{0:e} ".format(box[x, y, z]))
 *                 value_count += 1
 */
      __pyx_t_6 = __pyx_v_zdim;
      for (__pyx_t_7 = 0; __pyx_t_7 <code><</code> __pyx_t_6; __pyx_t_7+=1) {
        __pyx_v_z = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFF2f' onclick='toggleDiv("line165")'> 165:                 outfile.write("{0:e} ".format(box[x, y, z]))</pre>
<pre id='line165' class='code' style='background-color: #FFFF2f'>
        /* "epitopsy/cython/dx_cython.pyx":165
 *         for y in range(ydim):
 *             for z in range(zdim):
 *                 outfile.write("{0:e} ".format(box[x, y, z]))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 value_count += 1
 *                 if value_count == values_per_line:
 */
        __pyx_t_8 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_outfile, __pyx_n_s__write);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
        __pyx_t_9 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(((PyObject *)__pyx_kp_s_50), __pyx_n_s__format);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
        __pyx_t_10 = __pyx_v_x;
        __pyx_t_11 = __pyx_v_y;
        __pyx_t_12 = __pyx_v_z;
        __pyx_t_13 = -1;
        if (__pyx_t_10 <code><</code> 0) {
          __pyx_t_10 += __pyx_v_box.shape[0];
          if (unlikely(__pyx_t_10 <code><</code> 0)) __pyx_t_13 = 0;
        } else if (unlikely(__pyx_t_10 >= __pyx_v_box.shape[0])) __pyx_t_13 = 0;
        if (__pyx_t_11 <code><</code> 0) {
          __pyx_t_11 += __pyx_v_box.shape[1];
          if (unlikely(__pyx_t_11 <code><</code> 0)) __pyx_t_13 = 1;
        } else if (unlikely(__pyx_t_11 >= __pyx_v_box.shape[1])) __pyx_t_13 = 1;
        if (__pyx_t_12 <code><</code> 0) {
          __pyx_t_12 += __pyx_v_box.shape[2];
          if (unlikely(__pyx_t_12 <code><</code> 0)) __pyx_t_13 = 2;
        } else if (unlikely(__pyx_t_12 >= __pyx_v_box.shape[2])) __pyx_t_13 = 2;
        if (unlikely(__pyx_t_13 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_14 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_10 * __pyx_v_box.strides[0]) ) + __pyx_t_11 * __pyx_v_box.strides[1]) ) + __pyx_t_12 * __pyx_v_box.strides[2]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
        __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_t_14);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_14);
        __pyx_t_14 = 0;
        __pyx_t_14 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_9, ((PyObject *)__pyx_t_15), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_15)); __pyx_t_15 = 0;
        __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_t_14);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_14);
        __pyx_t_14 = 0;
        __pyx_t_14 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_8, ((PyObject *)__pyx_t_15), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_15)); __pyx_t_15 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line166")'> 166:                 value_count += 1</pre>
<pre id='line166' class='code' style='background-color: #FFFFff'>
        /* "epitopsy/cython/dx_cython.pyx":166
 *             for z in range(zdim):
 *                 outfile.write("{0:e} ".format(box[x, y, z]))
 *                 value_count += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 if value_count == values_per_line:
 *                     outfile.write('\n')
 */
        __pyx_v_value_count = (__pyx_v_value_count + 1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line167")'> 167:                 if value_count == values_per_line:</pre>
<pre id='line167' class='code' style='background-color: #FFFFff'>
        /* "epitopsy/cython/dx_cython.pyx":167
 *                 outfile.write("{0:e} ".format(box[x, y, z]))
 *                 value_count += 1
 *                 if value_count == values_per_line:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     outfile.write('\n')
 *                     value_count = 0
 */
        __pyx_t_16 = ((__pyx_v_value_count == __pyx_v_values_per_line) != 0);
        if (__pyx_t_16) {
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line168")'> 168:                     outfile.write('\n')</pre>
<pre id='line168' class='code' style='background-color: #FFFF5e'>
          /* "epitopsy/cython/dx_cython.pyx":168
 *                 value_count += 1
 *                 if value_count == values_per_line:
 *                     outfile.write('\n')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     value_count = 0
 *     return None
 */
          __pyx_t_14 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_v_outfile, __pyx_n_s__write);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 168; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
          __pyx_t_15 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_14, ((PyObject *)__pyx_k_tuple_52), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 168; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;

  /* "epitopsy/cython/dx_cython.pyx":168
 *                 value_count += 1
 *                 if value_count == values_per_line:
 *                     outfile.write('\n')             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     value_count = 0
 *     return None
 */
  __pyx_k_tuple_52 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_51));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_52)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 168; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_52);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_52));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line169")'> 169:                     value_count = 0</pre>
<pre id='line169' class='code' style='background-color: #FFFFff'>
          /* "epitopsy/cython/dx_cython.pyx":169
 *                 if value_count == values_per_line:
 *                     outfile.write('\n')
 *                     value_count = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return None
 * 
 */
          __pyx_v_value_count = 0;
          goto __pyx_L9;
        }
        __pyx_L9:;
      }
    }
  }
</pre><pre class='line' style='background-color: #FFFF26' onclick='toggleDiv("line170")'> 170:     return None</pre>
<pre id='line170' class='code' style='background-color: #FFFF26'>
  /* "epitopsy/cython/dx_cython.pyx":170
 *                     outfile.write('\n')
 *                     value_count = 0
 *     return None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * def flood(np.ndarray[np.float64_t, ndim=3] box_np not None,
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_r = Py_None;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&__pyx_t_1, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&__pyx_type, &__pyx_value, &__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box_np.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython.write_box", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box_np.rcbuffer->pybuffer);
  __pyx_L2:;
  __PYX_XDEC_MEMVIEW(&__pyx_v_box, 1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_8epitopsy_6cython_9dx_cython_7flood(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_8epitopsy_6cython_9dx_cython_6flood[] = "\n    The VDW grid is a grid of 0's and 1's, like this:\n            1 1 1 1\n            1 0 0 1\n            1 0 1 1\n            1 1 1 1\n    The algorithm starts at [0,0,0] and appends the neighbors, which\n    have a value equal to a solvent grid node (i.e. 1), to the\n    newFront-list. After all neighbor nodes from the first list have\n    been checked, the list gets deleted and contains now the new\n    neighbors.\n    The process is repeated until now new neighbors are found, that is\n    there are no new neighbors.\n\n    Then the remaining solvent values are treated as protein nodes\n    (i.e. they are set to a peptide score, which is 0). All nodes\n    that have been assigned a temp value are then set back to 1.\n    ";
static PyMethodDef __pyx_mdef_8epitopsy_6cython_9dx_cython_7flood = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("flood"), (PyCFunction)__pyx_pw_8epitopsy_6cython_9dx_cython_7flood, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(__pyx_doc_8epitopsy_6cython_9dx_cython_6flood)};
static PyObject *__pyx_pw_8epitopsy_6cython_9dx_cython_7flood(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_box_np = 0;
  PyArrayObject *__pyx_v_neighbors = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("flood (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__box_np,&__pyx_n_s__neighbors,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__box_np)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__neighbors)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("flood", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "flood") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_box_np = ((PyArrayObject *)values[0]);
    __pyx_v_neighbors = ((PyArrayObject *)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("flood", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython.flood", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_box_np), __pyx_ptype_5numpy_ndarray, 0, "box_np", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_neighbors), __pyx_ptype_5numpy_ndarray, 1, "neighbors", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_8epitopsy_6cython_9dx_cython_6flood(__pyx_self, __pyx_v_box_np, __pyx_v_neighbors);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line171")'> 171: </pre>
<pre id='line171' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line172")'> 172: def flood(np.ndarray[np.float64_t, ndim=3] box_np not None,</pre>
<pre id='line172' class='code' style='background-color: #FFFF55'>
/* "epitopsy/cython/dx_cython.pyx":172
 *     return None
 * 
 * def flood(np.ndarray[np.float64_t, ndim=3] box_np not None,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         np.ndarray[np.int64_t, ndim=2] neighbors):
 *     """
 */

static PyObject *__pyx_pf_8epitopsy_6cython_9dx_cython_6flood(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_box_np, PyArrayObject *__pyx_v_neighbors) {
  __Pyx_memviewslice __pyx_v_box = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_xdim;
  int __pyx_v_ydim;
  int __pyx_v_zdim;
  int __pyx_v_j;
  int __pyx_v_n_iter;
  int __pyx_v_nx;
  int __pyx_v_ny;
  int __pyx_v_nz;
  int __pyx_v_neighbor_elements;
  int __pyx_v_x;
  int __pyx_v_y;
  int __pyx_v_z;
  CYTHON_UNUSED int __pyx_v_counter;
  int __pyx_v_posx;
  int __pyx_v_posy;
  int __pyx_v_posz;
  PyArrayObject *__pyx_v_waterFront = 0;
  PyArrayObject *__pyx_v_newFront = 0;
  int __pyx_v_water_counter;
  int __pyx_v_front_counter;
  __pyx_t_5numpy_float64_t __pyx_v_temp_value;
  __pyx_t_5numpy_float64_t __pyx_v_solventScore;
  __pyx_t_5numpy_float64_t __pyx_v_peptideScore;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_box_np;
  __Pyx_Buffer __pyx_pybuffer_box_np;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_neighbors;
  __Pyx_Buffer __pyx_pybuffer_neighbors;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_newFront;
  __Pyx_Buffer __pyx_pybuffer_newFront;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_waterFront;
  __Pyx_Buffer __pyx_pybuffer_waterFront;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("flood", 0);
  __pyx_pybuffer_waterFront.pybuffer.buf = NULL;
  __pyx_pybuffer_waterFront.refcount = 0;
  __pyx_pybuffernd_waterFront.data = NULL;
  __pyx_pybuffernd_waterFront.rcbuffer = &__pyx_pybuffer_waterFront;
  __pyx_pybuffer_newFront.pybuffer.buf = NULL;
  __pyx_pybuffer_newFront.refcount = 0;
  __pyx_pybuffernd_newFront.data = NULL;
  __pyx_pybuffernd_newFront.rcbuffer = &__pyx_pybuffer_newFront;
  __pyx_pybuffer_box_np.pybuffer.buf = NULL;
  __pyx_pybuffer_box_np.refcount = 0;
  __pyx_pybuffernd_box_np.data = NULL;
  __pyx_pybuffernd_box_np.rcbuffer = &__pyx_pybuffer_box_np;
  __pyx_pybuffer_neighbors.pybuffer.buf = NULL;
  __pyx_pybuffer_neighbors.refcount = 0;
  __pyx_pybuffernd_neighbors.data = NULL;
  __pyx_pybuffernd_neighbors.rcbuffer = &__pyx_pybuffer_neighbors;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_box_np.rcbuffer->pybuffer, (PyObject*)__pyx_v_box_np, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_box_np.diminfo[0].strides = __pyx_pybuffernd_box_np.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_box_np.diminfo[0].shape = __pyx_pybuffernd_box_np.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_box_np.diminfo[1].strides = __pyx_pybuffernd_box_np.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_box_np.diminfo[1].shape = __pyx_pybuffernd_box_np.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_box_np.diminfo[2].strides = __pyx_pybuffernd_box_np.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_box_np.diminfo[2].shape = __pyx_pybuffernd_box_np.rcbuffer->pybuffer.shape[2];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_neighbors.rcbuffer->pybuffer, (PyObject*)__pyx_v_neighbors, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_neighbors.diminfo[0].strides = __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_neighbors.diminfo[0].shape = __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_neighbors.diminfo[1].strides = __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_neighbors.diminfo[1].shape = __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.shape[1];

  /* "epitopsy/cython/dx_cython.pyx":172
 *     return None
 * 
 * def flood(np.ndarray[np.float64_t, ndim=3] box_np not None,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         np.ndarray[np.int64_t, ndim=2] neighbors):
 *     """
 */
  __pyx_k_tuple_115 = <span class='py_c_api'>PyTuple_Pack</span>(27, ((PyObject *)__pyx_n_s__box_np), ((PyObject *)__pyx_n_s__neighbors), ((PyObject *)__pyx_n_s__box), ((PyObject *)__pyx_n_s__xdim), ((PyObject *)__pyx_n_s__ydim), ((PyObject *)__pyx_n_s__zdim), ((PyObject *)__pyx_n_s__i), ((PyObject *)__pyx_n_s__j), ((PyObject *)__pyx_n_s__n_iter), ((PyObject *)__pyx_n_s__nx), ((PyObject *)__pyx_n_s__ny), ((PyObject *)__pyx_n_s__nz), ((PyObject *)__pyx_n_s__neighbor_elements), ((PyObject *)__pyx_n_s__x), ((PyObject *)__pyx_n_s__y), ((PyObject *)__pyx_n_s__z), ((PyObject *)__pyx_n_s__counter), ((PyObject *)__pyx_n_s__posx), ((PyObject *)__pyx_n_s__posy), ((PyObject *)__pyx_n_s__posz), ((PyObject *)__pyx_n_s__waterFront), ((PyObject *)__pyx_n_s__newFront), ((PyObject *)__pyx_n_s__water_counter), ((PyObject *)__pyx_n_s__front_counter), ((PyObject *)__pyx_n_s__temp_value), ((PyObject *)__pyx_n_s__solventScore), ((PyObject *)__pyx_n_s__peptideScore));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_115)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_115);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_115));

  /* "epitopsy/cython/dx_cython.pyx":172
 *     return None
 * 
 * def flood(np.ndarray[np.float64_t, ndim=3] box_np not None,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         np.ndarray[np.int64_t, ndim=2] neighbors):
 *     """
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_8epitopsy_6cython_9dx_cython_7flood, NULL, __pyx_n_s_110);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__flood, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_116 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(2, 0, 27, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_115, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_109, __pyx_n_s__flood, 172, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_116)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line173")'> 173:         np.ndarray[np.int64_t, ndim=2] neighbors):</pre>
<pre id='line173' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line174")'> 174:     """</pre>
<pre id='line174' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line175")'> 175:     The VDW grid is a grid of 0's and 1's, like this:</pre>
<pre id='line175' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line176")'> 176:             1 1 1 1</pre>
<pre id='line176' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line177")'> 177:             1 0 0 1</pre>
<pre id='line177' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line178")'> 178:             1 0 1 1</pre>
<pre id='line178' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line179")'> 179:             1 1 1 1</pre>
<pre id='line179' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line180")'> 180:     The algorithm starts at [0,0,0] and appends the neighbors, which</pre>
<pre id='line180' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line181")'> 181:     have a value equal to a solvent grid node (i.e. 1), to the</pre>
<pre id='line181' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line182")'> 182:     newFront-list. After all neighbor nodes from the first list have</pre>
<pre id='line182' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line183")'> 183:     been checked, the list gets deleted and contains now the new</pre>
<pre id='line183' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line184")'> 184:     neighbors.</pre>
<pre id='line184' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line185")'> 185:     The process is repeated until now new neighbors are found, that is</pre>
<pre id='line185' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line186")'> 186:     there are no new neighbors.</pre>
<pre id='line186' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line187")'> 187: </pre>
<pre id='line187' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line188")'> 188:     Then the remaining solvent values are treated as protein nodes</pre>
<pre id='line188' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line189")'> 189:     (i.e. they are set to a peptide score, which is 0). All nodes</pre>
<pre id='line189' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line190")'> 190:     that have been assigned a temp value are then set back to 1.</pre>
<pre id='line190' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line191")'> 191:     """</pre>
<pre id='line191' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line192")'> 192:     cdef double[:,:,:] box = box_np</pre>
<pre id='line192' class='code' style='background-color: #FFFFd4'>
  /* "epitopsy/cython/dx_cython.pyx":192
 *     that have been assigned a temp value are then set back to 1.
 *     """
 *     cdef double[:,:,:] box = box_np             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int xdim = box.shape[0]
 *     cdef int ydim = box.shape[1]
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_double</span>(((PyObject *)__pyx_v_box_np));
  if (unlikely(!__pyx_t_1.memview))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_box = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line193")'> 193:     cdef int xdim = box.shape[0]</pre>
<pre id='line193' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":193
 *     """
 *     cdef double[:,:,:] box = box_np
 *     cdef int xdim = box.shape[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int ydim = box.shape[1]
 *     cdef int zdim = box.shape[2]
 */
  __pyx_v_xdim = (__pyx_v_box.shape[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line194")'> 194:     cdef int ydim = box.shape[1]</pre>
<pre id='line194' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":194
 *     cdef double[:,:,:] box = box_np
 *     cdef int xdim = box.shape[0]
 *     cdef int ydim = box.shape[1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int zdim = box.shape[2]
 *     cdef int i,j
 */
  __pyx_v_ydim = (__pyx_v_box.shape[1]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line195")'> 195:     cdef int zdim = box.shape[2]</pre>
<pre id='line195' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":195
 *     cdef int xdim = box.shape[0]
 *     cdef int ydim = box.shape[1]
 *     cdef int zdim = box.shape[2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int i,j
 *     cdef int n_iter
 */
  __pyx_v_zdim = (__pyx_v_box.shape[2]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line196")'> 196:     cdef int i,j</pre>
<pre id='line196' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line197")'> 197:     cdef int n_iter</pre>
<pre id='line197' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line198")'> 198:     cdef int nx,ny,nz</pre>
<pre id='line198' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line199")'> 199:     cdef int neighbor_elements = neighbors.shape[0]</pre>
<pre id='line199' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":199
 *     cdef int n_iter
 *     cdef int nx,ny,nz
 *     cdef int neighbor_elements = neighbors.shape[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int x,y,z
 *     cdef int counter = 0
 */
  __pyx_v_neighbor_elements = (__pyx_v_neighbors->dimensions[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line200")'> 200:     cdef int x,y,z</pre>
<pre id='line200' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line201")'> 201:     cdef int counter = 0</pre>
<pre id='line201' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":201
 *     cdef int neighbor_elements = neighbors.shape[0]
 *     cdef int x,y,z
 *     cdef int counter = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int posx, posy, posz
 *     cdef np.ndarray[np.int64_t,ndim=2] waterFront = np.zeros([xdim*ydim*zdim,3],dtype = np.int64)
 */
  __pyx_v_counter = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line202")'> 202:     cdef int posx, posy, posz</pre>
<pre id='line202' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF24' onclick='toggleDiv("line203")'> 203:     cdef np.ndarray[np.int64_t,ndim=2] waterFront = np.zeros([xdim*ydim*zdim,3],dtype = np.int64)</pre>
<pre id='line203' class='code' style='background-color: #FFFF24'>
  /* "epitopsy/cython/dx_cython.pyx":203
 *     cdef int counter = 0
 *     cdef int posx, posy, posz
 *     cdef np.ndarray[np.int64_t,ndim=2] waterFront = np.zeros([xdim*ydim*zdim,3],dtype = np.int64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.ndarray[np.int64_t,ndim=2] newFront = np.zeros([xdim*ydim*zdim,3],dtype = np.int64)
 *     cdef int water_counter = 0
 */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s__zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(((__pyx_v_xdim * __pyx_v_ydim) * __pyx_v_zdim));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_3);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_t_4));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_4));
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_4));
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s__int64);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, ((PyObject *)__pyx_n_s__dtype), __pyx_t_6) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_2), ((PyObject *)__pyx_t_4));<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_waterFront.rcbuffer->pybuffer, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_waterFront = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_waterFront.rcbuffer->pybuffer.buf = NULL;
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_waterFront.diminfo[0].strides = __pyx_pybuffernd_waterFront.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_waterFront.diminfo[0].shape = __pyx_pybuffernd_waterFront.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_waterFront.diminfo[1].strides = __pyx_pybuffernd_waterFront.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_waterFront.diminfo[1].shape = __pyx_pybuffernd_waterFront.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_waterFront = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;
</pre><pre class='line' style='background-color: #FFFF24' onclick='toggleDiv("line204")'> 204:     cdef np.ndarray[np.int64_t,ndim=2] newFront = np.zeros([xdim*ydim*zdim,3],dtype = np.int64)</pre>
<pre id='line204' class='code' style='background-color: #FFFF24'>
  /* "epitopsy/cython/dx_cython.pyx":204
 *     cdef int posx, posy, posz
 *     cdef np.ndarray[np.int64_t,ndim=2] waterFront = np.zeros([xdim*ydim*zdim,3],dtype = np.int64)
 *     cdef np.ndarray[np.int64_t,ndim=2] newFront = np.zeros([xdim*ydim*zdim,3],dtype = np.int64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int water_counter = 0
 *     cdef int front_counter = 0
 */
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s__zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyInt_FromLong</span>(((__pyx_v_xdim * __pyx_v_ydim) * __pyx_v_zdim));<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_6);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_3);
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, ((PyObject *)__pyx_t_2));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_2));
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s__int64);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_4, ((PyObject *)__pyx_t_6), ((PyObject *)__pyx_t_2));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_newFront.rcbuffer->pybuffer, (PyObject*)__pyx_t_8, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_newFront = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_newFront.rcbuffer->pybuffer.buf = NULL;
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_newFront.diminfo[0].strides = __pyx_pybuffernd_newFront.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_newFront.diminfo[0].shape = __pyx_pybuffernd_newFront.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_newFront.diminfo[1].strides = __pyx_pybuffernd_newFront.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_newFront.diminfo[1].shape = __pyx_pybuffernd_newFront.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_8 = 0;
  __pyx_v_newFront = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line205")'> 205:     cdef int water_counter = 0</pre>
<pre id='line205' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":205
 *     cdef np.ndarray[np.int64_t,ndim=2] waterFront = np.zeros([xdim*ydim*zdim,3],dtype = np.int64)
 *     cdef np.ndarray[np.int64_t,ndim=2] newFront = np.zeros([xdim*ydim*zdim,3],dtype = np.int64)
 *     cdef int water_counter = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int front_counter = 0
 * 
 */
  __pyx_v_water_counter = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line206")'> 206:     cdef int front_counter = 0</pre>
<pre id='line206' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":206
 *     cdef np.ndarray[np.int64_t,ndim=2] newFront = np.zeros([xdim*ydim*zdim,3],dtype = np.int64)
 *     cdef int water_counter = 0
 *     cdef int front_counter = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef np.float64_t temp_value = -1
 */
  __pyx_v_front_counter = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line207")'> 207: </pre>
<pre id='line207' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line208")'> 208:     cdef np.float64_t temp_value = -1</pre>
<pre id='line208' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":208
 *     cdef int front_counter = 0
 * 
 *     cdef np.float64_t temp_value = -1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.float64_t solventScore = 1
 *     cdef np.float64_t peptideScore = 0
 */
  __pyx_v_temp_value = -1.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line209")'> 209:     cdef np.float64_t solventScore = 1</pre>
<pre id='line209' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":209
 * 
 *     cdef np.float64_t temp_value = -1
 *     cdef np.float64_t solventScore = 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.float64_t peptideScore = 0
 * 
 */
  __pyx_v_solventScore = 1.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line210")'> 210:     cdef np.float64_t peptideScore = 0</pre>
<pre id='line210' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":210
 *     cdef np.float64_t temp_value = -1
 *     cdef np.float64_t solventScore = 1
 *     cdef np.float64_t peptideScore = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     # reset counter and array
 */
  __pyx_v_peptideScore = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line211")'> 211: </pre>
<pre id='line211' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line212")'> 212:     # reset counter and array</pre>
<pre id='line212' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line213")'> 213:     waterFront[water_counter,0] = 0</pre>
<pre id='line213' class='code' style='background-color: #FFFFd4'>
  /* "epitopsy/cython/dx_cython.pyx":213
 * 
 *     # reset counter and array
 *     waterFront[water_counter,0] = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     waterFront[water_counter,1] = 0
 *     waterFront[water_counter,2] = 0
 */
  __pyx_t_9 = __pyx_v_water_counter;
  __pyx_t_10 = 0;
  __pyx_t_11 = -1;
  if (__pyx_t_9 <code><</code> 0) {
    __pyx_t_9 += __pyx_pybuffernd_waterFront.diminfo[0].shape;
    if (unlikely(__pyx_t_9 <code><</code> 0)) __pyx_t_11 = 0;
  } else if (unlikely(__pyx_t_9 >= __pyx_pybuffernd_waterFront.diminfo[0].shape)) __pyx_t_11 = 0;
  if (__pyx_t_10 <code><</code> 0) {
    __pyx_t_10 += __pyx_pybuffernd_waterFront.diminfo[1].shape;
    if (unlikely(__pyx_t_10 <code><</code> 0)) __pyx_t_11 = 1;
  } else if (unlikely(__pyx_t_10 >= __pyx_pybuffernd_waterFront.diminfo[1].shape)) __pyx_t_11 = 1;
  if (unlikely(__pyx_t_11 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_waterFront.rcbuffer->pybuffer.buf, __pyx_t_9, __pyx_pybuffernd_waterFront.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_waterFront.diminfo[1].strides) = 0;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line214")'> 214:     waterFront[water_counter,1] = 0</pre>
<pre id='line214' class='code' style='background-color: #FFFFd4'>
  /* "epitopsy/cython/dx_cython.pyx":214
 *     # reset counter and array
 *     waterFront[water_counter,0] = 0
 *     waterFront[water_counter,1] = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     waterFront[water_counter,2] = 0
 *     water_counter = 1
 */
  __pyx_t_11 = __pyx_v_water_counter;
  __pyx_t_12 = 1;
  __pyx_t_13 = -1;
  if (__pyx_t_11 <code><</code> 0) {
    __pyx_t_11 += __pyx_pybuffernd_waterFront.diminfo[0].shape;
    if (unlikely(__pyx_t_11 <code><</code> 0)) __pyx_t_13 = 0;
  } else if (unlikely(__pyx_t_11 >= __pyx_pybuffernd_waterFront.diminfo[0].shape)) __pyx_t_13 = 0;
  if (__pyx_t_12 <code><</code> 0) {
    __pyx_t_12 += __pyx_pybuffernd_waterFront.diminfo[1].shape;
    if (unlikely(__pyx_t_12 <code><</code> 0)) __pyx_t_13 = 1;
  } else if (unlikely(__pyx_t_12 >= __pyx_pybuffernd_waterFront.diminfo[1].shape)) __pyx_t_13 = 1;
  if (unlikely(__pyx_t_13 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_waterFront.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_waterFront.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_waterFront.diminfo[1].strides) = 0;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line215")'> 215:     waterFront[water_counter,2] = 0</pre>
<pre id='line215' class='code' style='background-color: #FFFFd4'>
  /* "epitopsy/cython/dx_cython.pyx":215
 *     waterFront[water_counter,0] = 0
 *     waterFront[water_counter,1] = 0
 *     waterFront[water_counter,2] = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     water_counter = 1
 *     while(water_counter > 0):
 */
  __pyx_t_13 = __pyx_v_water_counter;
  __pyx_t_14 = 2;
  __pyx_t_15 = -1;
  if (__pyx_t_13 <code><</code> 0) {
    __pyx_t_13 += __pyx_pybuffernd_waterFront.diminfo[0].shape;
    if (unlikely(__pyx_t_13 <code><</code> 0)) __pyx_t_15 = 0;
  } else if (unlikely(__pyx_t_13 >= __pyx_pybuffernd_waterFront.diminfo[0].shape)) __pyx_t_15 = 0;
  if (__pyx_t_14 <code><</code> 0) {
    __pyx_t_14 += __pyx_pybuffernd_waterFront.diminfo[1].shape;
    if (unlikely(__pyx_t_14 <code><</code> 0)) __pyx_t_15 = 1;
  } else if (unlikely(__pyx_t_14 >= __pyx_pybuffernd_waterFront.diminfo[1].shape)) __pyx_t_15 = 1;
  if (unlikely(__pyx_t_15 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_15);
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 215; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_waterFront.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_waterFront.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_waterFront.diminfo[1].strides) = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line216")'> 216:     water_counter = 1</pre>
<pre id='line216' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":216
 *     waterFront[water_counter,1] = 0
 *     waterFront[water_counter,2] = 0
 *     water_counter = 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     while(water_counter > 0):
 *         if front_counter > 0:
 */
  __pyx_v_water_counter = 1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line217")'> 217:     while(water_counter &gt; 0):</pre>
<pre id='line217' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":217
 *     waterFront[water_counter,2] = 0
 *     water_counter = 1
 *     while(water_counter > 0):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if front_counter > 0:
 *             front_counter = 0
 */
  while (1) {
    __pyx_t_16 = ((__pyx_v_water_counter > 0) != 0);
    if (!__pyx_t_16) break;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line218")'> 218:         if front_counter &gt; 0:</pre>
<pre id='line218' class='code' style='background-color: #FFFFff'>
    /* "epitopsy/cython/dx_cython.pyx":218
 *     water_counter = 1
 *     while(water_counter > 0):
 *         if front_counter > 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             front_counter = 0
 *         for j from 0 <code><</code>= j <code><</code> water_counter:
 */
    __pyx_t_16 = ((__pyx_v_front_counter > 0) != 0);
    if (__pyx_t_16) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line219")'> 219:             front_counter = 0</pre>
<pre id='line219' class='code' style='background-color: #FFFFff'>
      /* "epitopsy/cython/dx_cython.pyx":219
 *     while(water_counter > 0):
 *         if front_counter > 0:
 *             front_counter = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for j from 0 <code><</code>= j <code><</code> water_counter:
 *             posx = waterFront[j,0]
 */
      __pyx_v_front_counter = 0;
      goto __pyx_L5;
    }
    __pyx_L5:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line220")'> 220:         for j from 0 &lt;= j &lt; water_counter:</pre>
<pre id='line220' class='code' style='background-color: #FFFFff'>
    /* "epitopsy/cython/dx_cython.pyx":220
 *         if front_counter > 0:
 *             front_counter = 0
 *         for j from 0 <code><</code>= j <code><</code> water_counter:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             posx = waterFront[j,0]
 *             posy = waterFront[j,1]
 */
    __pyx_t_15 = __pyx_v_water_counter;
    for (__pyx_v_j = 0; __pyx_v_j <code><</code> __pyx_t_15; __pyx_v_j++) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line221")'> 221:             posx = waterFront[j,0]</pre>
<pre id='line221' class='code' style='background-color: #FFFFd4'>
      /* "epitopsy/cython/dx_cython.pyx":221
 *             front_counter = 0
 *         for j from 0 <code><</code>= j <code><</code> water_counter:
 *             posx = waterFront[j,0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             posy = waterFront[j,1]
 *             posz = waterFront[j,2]
 */
      __pyx_t_17 = __pyx_v_j;
      __pyx_t_18 = 0;
      __pyx_t_19 = -1;
      if (__pyx_t_17 <code><</code> 0) {
        __pyx_t_17 += __pyx_pybuffernd_waterFront.diminfo[0].shape;
        if (unlikely(__pyx_t_17 <code><</code> 0)) __pyx_t_19 = 0;
      } else if (unlikely(__pyx_t_17 >= __pyx_pybuffernd_waterFront.diminfo[0].shape)) __pyx_t_19 = 0;
      if (__pyx_t_18 <code><</code> 0) {
        __pyx_t_18 += __pyx_pybuffernd_waterFront.diminfo[1].shape;
        if (unlikely(__pyx_t_18 <code><</code> 0)) __pyx_t_19 = 1;
      } else if (unlikely(__pyx_t_18 >= __pyx_pybuffernd_waterFront.diminfo[1].shape)) __pyx_t_19 = 1;
      if (unlikely(__pyx_t_19 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
       <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_v_posx = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_waterFront.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_waterFront.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_waterFront.diminfo[1].strides));
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line222")'> 222:             posy = waterFront[j,1]</pre>
<pre id='line222' class='code' style='background-color: #FFFFd4'>
      /* "epitopsy/cython/dx_cython.pyx":222
 *         for j from 0 <code><</code>= j <code><</code> water_counter:
 *             posx = waterFront[j,0]
 *             posy = waterFront[j,1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             posz = waterFront[j,2]
 *             box[posx, posy,posz] = temp_value
 */
      __pyx_t_19 = __pyx_v_j;
      __pyx_t_20 = 1;
      __pyx_t_21 = -1;
      if (__pyx_t_19 <code><</code> 0) {
        __pyx_t_19 += __pyx_pybuffernd_waterFront.diminfo[0].shape;
        if (unlikely(__pyx_t_19 <code><</code> 0)) __pyx_t_21 = 0;
      } else if (unlikely(__pyx_t_19 >= __pyx_pybuffernd_waterFront.diminfo[0].shape)) __pyx_t_21 = 0;
      if (__pyx_t_20 <code><</code> 0) {
        __pyx_t_20 += __pyx_pybuffernd_waterFront.diminfo[1].shape;
        if (unlikely(__pyx_t_20 <code><</code> 0)) __pyx_t_21 = 1;
      } else if (unlikely(__pyx_t_20 >= __pyx_pybuffernd_waterFront.diminfo[1].shape)) __pyx_t_21 = 1;
      if (unlikely(__pyx_t_21 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
       <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_v_posy = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_waterFront.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_waterFront.diminfo[0].strides, __pyx_t_20, __pyx_pybuffernd_waterFront.diminfo[1].strides));
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line223")'> 223:             posz = waterFront[j,2]</pre>
<pre id='line223' class='code' style='background-color: #FFFFd4'>
      /* "epitopsy/cython/dx_cython.pyx":223
 *             posx = waterFront[j,0]
 *             posy = waterFront[j,1]
 *             posz = waterFront[j,2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             box[posx, posy,posz] = temp_value
 *             for n_iter from 0 <code><</code>= n_iter <code><</code> neighbor_elements:
 */
      __pyx_t_21 = __pyx_v_j;
      __pyx_t_22 = 2;
      __pyx_t_23 = -1;
      if (__pyx_t_21 <code><</code> 0) {
        __pyx_t_21 += __pyx_pybuffernd_waterFront.diminfo[0].shape;
        if (unlikely(__pyx_t_21 <code><</code> 0)) __pyx_t_23 = 0;
      } else if (unlikely(__pyx_t_21 >= __pyx_pybuffernd_waterFront.diminfo[0].shape)) __pyx_t_23 = 0;
      if (__pyx_t_22 <code><</code> 0) {
        __pyx_t_22 += __pyx_pybuffernd_waterFront.diminfo[1].shape;
        if (unlikely(__pyx_t_22 <code><</code> 0)) __pyx_t_23 = 1;
      } else if (unlikely(__pyx_t_22 >= __pyx_pybuffernd_waterFront.diminfo[1].shape)) __pyx_t_23 = 1;
      if (unlikely(__pyx_t_23 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_23);
       <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_v_posz = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_waterFront.rcbuffer->pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_waterFront.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_waterFront.diminfo[1].strides));
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line224")'> 224:             box[posx, posy,posz] = temp_value</pre>
<pre id='line224' class='code' style='background-color: #FFFFd4'>
      /* "epitopsy/cython/dx_cython.pyx":224
 *             posy = waterFront[j,1]
 *             posz = waterFront[j,2]
 *             box[posx, posy,posz] = temp_value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for n_iter from 0 <code><</code>= n_iter <code><</code> neighbor_elements:
 *                 nx = posx + neighbors[n_iter,0]
 */
      __pyx_t_23 = __pyx_v_posx;
      __pyx_t_24 = __pyx_v_posy;
      __pyx_t_25 = __pyx_v_posz;
      __pyx_t_26 = -1;
      if (__pyx_t_23 <code><</code> 0) {
        __pyx_t_23 += __pyx_v_box.shape[0];
        if (unlikely(__pyx_t_23 <code><</code> 0)) __pyx_t_26 = 0;
      } else if (unlikely(__pyx_t_23 >= __pyx_v_box.shape[0])) __pyx_t_26 = 0;
      if (__pyx_t_24 <code><</code> 0) {
        __pyx_t_24 += __pyx_v_box.shape[1];
        if (unlikely(__pyx_t_24 <code><</code> 0)) __pyx_t_26 = 1;
      } else if (unlikely(__pyx_t_24 >= __pyx_v_box.shape[1])) __pyx_t_26 = 1;
      if (__pyx_t_25 <code><</code> 0) {
        __pyx_t_25 += __pyx_v_box.shape[2];
        if (unlikely(__pyx_t_25 <code><</code> 0)) __pyx_t_26 = 2;
      } else if (unlikely(__pyx_t_25 >= __pyx_v_box.shape[2])) __pyx_t_26 = 2;
      if (unlikely(__pyx_t_26 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_26);
       <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_23 * __pyx_v_box.strides[0]) ) + __pyx_t_24 * __pyx_v_box.strides[1]) ) + __pyx_t_25 * __pyx_v_box.strides[2]) )) = __pyx_v_temp_value;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line225")'> 225:             for n_iter from 0 &lt;= n_iter &lt; neighbor_elements:</pre>
<pre id='line225' class='code' style='background-color: #FFFFff'>
      /* "epitopsy/cython/dx_cython.pyx":225
 *             posz = waterFront[j,2]
 *             box[posx, posy,posz] = temp_value
 *             for n_iter from 0 <code><</code>= n_iter <code><</code> neighbor_elements:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 nx = posx + neighbors[n_iter,0]
 *                 ny = posy + neighbors[n_iter,1]
 */
      __pyx_t_26 = __pyx_v_neighbor_elements;
      for (__pyx_v_n_iter = 0; __pyx_v_n_iter <code><</code> __pyx_t_26; __pyx_v_n_iter++) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line226")'> 226:                 nx = posx + neighbors[n_iter,0]</pre>
<pre id='line226' class='code' style='background-color: #FFFFd4'>
        /* "epitopsy/cython/dx_cython.pyx":226
 *             box[posx, posy,posz] = temp_value
 *             for n_iter from 0 <code><</code>= n_iter <code><</code> neighbor_elements:
 *                 nx = posx + neighbors[n_iter,0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 ny = posy + neighbors[n_iter,1]
 *                 nz = posz + neighbors[n_iter,2]
 */
        __pyx_t_27 = __pyx_v_n_iter;
        __pyx_t_28 = 0;
        __pyx_t_29 = -1;
        if (__pyx_t_27 <code><</code> 0) {
          __pyx_t_27 += __pyx_pybuffernd_neighbors.diminfo[0].shape;
          if (unlikely(__pyx_t_27 <code><</code> 0)) __pyx_t_29 = 0;
        } else if (unlikely(__pyx_t_27 >= __pyx_pybuffernd_neighbors.diminfo[0].shape)) __pyx_t_29 = 0;
        if (__pyx_t_28 <code><</code> 0) {
          __pyx_t_28 += __pyx_pybuffernd_neighbors.diminfo[1].shape;
          if (unlikely(__pyx_t_28 <code><</code> 0)) __pyx_t_29 = 1;
        } else if (unlikely(__pyx_t_28 >= __pyx_pybuffernd_neighbors.diminfo[1].shape)) __pyx_t_29 = 1;
        if (unlikely(__pyx_t_29 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_29);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_v_nx = (__pyx_v_posx + (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.buf, __pyx_t_27, __pyx_pybuffernd_neighbors.diminfo[0].strides, __pyx_t_28, __pyx_pybuffernd_neighbors.diminfo[1].strides)));
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line227")'> 227:                 ny = posy + neighbors[n_iter,1]</pre>
<pre id='line227' class='code' style='background-color: #FFFFd4'>
        /* "epitopsy/cython/dx_cython.pyx":227
 *             for n_iter from 0 <code><</code>= n_iter <code><</code> neighbor_elements:
 *                 nx = posx + neighbors[n_iter,0]
 *                 ny = posy + neighbors[n_iter,1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 nz = posz + neighbors[n_iter,2]
 *                 if (nx >= 0 and nx <code><</code> xdim and ny >= 0 and ny <code><</code> ydim and
 */
        __pyx_t_29 = __pyx_v_n_iter;
        __pyx_t_30 = 1;
        __pyx_t_31 = -1;
        if (__pyx_t_29 <code><</code> 0) {
          __pyx_t_29 += __pyx_pybuffernd_neighbors.diminfo[0].shape;
          if (unlikely(__pyx_t_29 <code><</code> 0)) __pyx_t_31 = 0;
        } else if (unlikely(__pyx_t_29 >= __pyx_pybuffernd_neighbors.diminfo[0].shape)) __pyx_t_31 = 0;
        if (__pyx_t_30 <code><</code> 0) {
          __pyx_t_30 += __pyx_pybuffernd_neighbors.diminfo[1].shape;
          if (unlikely(__pyx_t_30 <code><</code> 0)) __pyx_t_31 = 1;
        } else if (unlikely(__pyx_t_30 >= __pyx_pybuffernd_neighbors.diminfo[1].shape)) __pyx_t_31 = 1;
        if (unlikely(__pyx_t_31 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_31);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 227; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_v_ny = (__pyx_v_posy + (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.buf, __pyx_t_29, __pyx_pybuffernd_neighbors.diminfo[0].strides, __pyx_t_30, __pyx_pybuffernd_neighbors.diminfo[1].strides)));
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line228")'> 228:                 nz = posz + neighbors[n_iter,2]</pre>
<pre id='line228' class='code' style='background-color: #FFFFd4'>
        /* "epitopsy/cython/dx_cython.pyx":228
 *                 nx = posx + neighbors[n_iter,0]
 *                 ny = posy + neighbors[n_iter,1]
 *                 nz = posz + neighbors[n_iter,2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 if (nx >= 0 and nx <code><</code> xdim and ny >= 0 and ny <code><</code> ydim and
 *                     nz >= 0 and nz <code><</code> zdim):
 */
        __pyx_t_31 = __pyx_v_n_iter;
        __pyx_t_32 = 2;
        __pyx_t_33 = -1;
        if (__pyx_t_31 <code><</code> 0) {
          __pyx_t_31 += __pyx_pybuffernd_neighbors.diminfo[0].shape;
          if (unlikely(__pyx_t_31 <code><</code> 0)) __pyx_t_33 = 0;
        } else if (unlikely(__pyx_t_31 >= __pyx_pybuffernd_neighbors.diminfo[0].shape)) __pyx_t_33 = 0;
        if (__pyx_t_32 <code><</code> 0) {
          __pyx_t_32 += __pyx_pybuffernd_neighbors.diminfo[1].shape;
          if (unlikely(__pyx_t_32 <code><</code> 0)) __pyx_t_33 = 1;
        } else if (unlikely(__pyx_t_32 >= __pyx_pybuffernd_neighbors.diminfo[1].shape)) __pyx_t_33 = 1;
        if (unlikely(__pyx_t_33 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_33);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_v_nz = (__pyx_v_posz + (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.buf, __pyx_t_31, __pyx_pybuffernd_neighbors.diminfo[0].strides, __pyx_t_32, __pyx_pybuffernd_neighbors.diminfo[1].strides)));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line229")'> 229:                 if (nx &gt;= 0 and nx &lt; xdim and ny &gt;= 0 and ny &lt; ydim and</pre>
<pre id='line229' class='code' style='background-color: #FFFFff'>
        /* "epitopsy/cython/dx_cython.pyx":229
 *                 ny = posy + neighbors[n_iter,1]
 *                 nz = posz + neighbors[n_iter,2]
 *                 if (nx >= 0 and nx <code><</code> xdim and ny >= 0 and ny <code><</code> ydim and             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     nz >= 0 and nz <code><</code> zdim):
 *                     if box[nx,ny,nz] == solventScore:
 */
        __pyx_t_16 = ((__pyx_v_nx >= 0) != 0);
        if (__pyx_t_16) {
          __pyx_t_34 = ((__pyx_v_nx <code><</code> __pyx_v_xdim) != 0);
          if (__pyx_t_34) {
            __pyx_t_35 = ((__pyx_v_ny >= 0) != 0);
            if (__pyx_t_35) {
              __pyx_t_36 = ((__pyx_v_ny <code><</code> __pyx_v_ydim) != 0);
              if (__pyx_t_36) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line230")'> 230:                     nz &gt;= 0 and nz &lt; zdim):</pre>
<pre id='line230' class='code' style='background-color: #FFFFff'>
                /* "epitopsy/cython/dx_cython.pyx":230
 *                 nz = posz + neighbors[n_iter,2]
 *                 if (nx >= 0 and nx <code><</code> xdim and ny >= 0 and ny <code><</code> ydim and
 *                     nz >= 0 and nz <code><</code> zdim):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     if box[nx,ny,nz] == solventScore:
 *                         box[nx, ny, nz] = temp_value
 */
                __pyx_t_37 = ((__pyx_v_nz >= 0) != 0);
                if (__pyx_t_37) {
                  __pyx_t_38 = ((__pyx_v_nz <code><</code> __pyx_v_zdim) != 0);
                  __pyx_t_39 = __pyx_t_38;
                } else {
                  __pyx_t_39 = __pyx_t_37;
                }
                __pyx_t_37 = __pyx_t_39;
              } else {
                __pyx_t_37 = __pyx_t_36;
              }
              __pyx_t_36 = __pyx_t_37;
            } else {
              __pyx_t_36 = __pyx_t_35;
            }
            __pyx_t_35 = __pyx_t_36;
          } else {
            __pyx_t_35 = __pyx_t_34;
          }
          __pyx_t_34 = __pyx_t_35;
        } else {
          __pyx_t_34 = __pyx_t_16;
        }
        if (__pyx_t_34) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line231")'> 231:                     if box[nx,ny,nz] == solventScore:</pre>
<pre id='line231' class='code' style='background-color: #FFFFd4'>
          /* "epitopsy/cython/dx_cython.pyx":231
 *                 if (nx >= 0 and nx <code><</code> xdim and ny >= 0 and ny <code><</code> ydim and
 *                     nz >= 0 and nz <code><</code> zdim):
 *                     if box[nx,ny,nz] == solventScore:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         box[nx, ny, nz] = temp_value
 *                         newFront[front_counter,0] = nx
 */
          __pyx_t_33 = __pyx_v_nx;
          __pyx_t_40 = __pyx_v_ny;
          __pyx_t_41 = __pyx_v_nz;
          __pyx_t_42 = -1;
          if (__pyx_t_33 <code><</code> 0) {
            __pyx_t_33 += __pyx_v_box.shape[0];
            if (unlikely(__pyx_t_33 <code><</code> 0)) __pyx_t_42 = 0;
          } else if (unlikely(__pyx_t_33 >= __pyx_v_box.shape[0])) __pyx_t_42 = 0;
          if (__pyx_t_40 <code><</code> 0) {
            __pyx_t_40 += __pyx_v_box.shape[1];
            if (unlikely(__pyx_t_40 <code><</code> 0)) __pyx_t_42 = 1;
          } else if (unlikely(__pyx_t_40 >= __pyx_v_box.shape[1])) __pyx_t_42 = 1;
          if (__pyx_t_41 <code><</code> 0) {
            __pyx_t_41 += __pyx_v_box.shape[2];
            if (unlikely(__pyx_t_41 <code><</code> 0)) __pyx_t_42 = 2;
          } else if (unlikely(__pyx_t_41 >= __pyx_v_box.shape[2])) __pyx_t_42 = 2;
          if (unlikely(__pyx_t_42 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_42);
           <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_t_34 = (((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_33 * __pyx_v_box.strides[0]) ) + __pyx_t_40 * __pyx_v_box.strides[1]) ) + __pyx_t_41 * __pyx_v_box.strides[2]) ))) == __pyx_v_solventScore) != 0);
          if (__pyx_t_34) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line232")'> 232:                         box[nx, ny, nz] = temp_value</pre>
<pre id='line232' class='code' style='background-color: #FFFFd4'>
            /* "epitopsy/cython/dx_cython.pyx":232
 *                     nz >= 0 and nz <code><</code> zdim):
 *                     if box[nx,ny,nz] == solventScore:
 *                         box[nx, ny, nz] = temp_value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         newFront[front_counter,0] = nx
 *                         newFront[front_counter,1] = ny
 */
            __pyx_t_42 = __pyx_v_nx;
            __pyx_t_43 = __pyx_v_ny;
            __pyx_t_44 = __pyx_v_nz;
            __pyx_t_45 = -1;
            if (__pyx_t_42 <code><</code> 0) {
              __pyx_t_42 += __pyx_v_box.shape[0];
              if (unlikely(__pyx_t_42 <code><</code> 0)) __pyx_t_45 = 0;
            } else if (unlikely(__pyx_t_42 >= __pyx_v_box.shape[0])) __pyx_t_45 = 0;
            if (__pyx_t_43 <code><</code> 0) {
              __pyx_t_43 += __pyx_v_box.shape[1];
              if (unlikely(__pyx_t_43 <code><</code> 0)) __pyx_t_45 = 1;
            } else if (unlikely(__pyx_t_43 >= __pyx_v_box.shape[1])) __pyx_t_45 = 1;
            if (__pyx_t_44 <code><</code> 0) {
              __pyx_t_44 += __pyx_v_box.shape[2];
              if (unlikely(__pyx_t_44 <code><</code> 0)) __pyx_t_45 = 2;
            } else if (unlikely(__pyx_t_44 >= __pyx_v_box.shape[2])) __pyx_t_45 = 2;
            if (unlikely(__pyx_t_45 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_45);
             <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_42 * __pyx_v_box.strides[0]) ) + __pyx_t_43 * __pyx_v_box.strides[1]) ) + __pyx_t_44 * __pyx_v_box.strides[2]) )) = __pyx_v_temp_value;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line233")'> 233:                         newFront[front_counter,0] = nx</pre>
<pre id='line233' class='code' style='background-color: #FFFFd4'>
            /* "epitopsy/cython/dx_cython.pyx":233
 *                     if box[nx,ny,nz] == solventScore:
 *                         box[nx, ny, nz] = temp_value
 *                         newFront[front_counter,0] = nx             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         newFront[front_counter,1] = ny
 *                         newFront[front_counter,2] = nz
 */
            __pyx_t_45 = __pyx_v_front_counter;
            __pyx_t_46 = 0;
            __pyx_t_47 = -1;
            if (__pyx_t_45 <code><</code> 0) {
              __pyx_t_45 += __pyx_pybuffernd_newFront.diminfo[0].shape;
              if (unlikely(__pyx_t_45 <code><</code> 0)) __pyx_t_47 = 0;
            } else if (unlikely(__pyx_t_45 >= __pyx_pybuffernd_newFront.diminfo[0].shape)) __pyx_t_47 = 0;
            if (__pyx_t_46 <code><</code> 0) {
              __pyx_t_46 += __pyx_pybuffernd_newFront.diminfo[1].shape;
              if (unlikely(__pyx_t_46 <code><</code> 0)) __pyx_t_47 = 1;
            } else if (unlikely(__pyx_t_46 >= __pyx_pybuffernd_newFront.diminfo[1].shape)) __pyx_t_47 = 1;
            if (unlikely(__pyx_t_47 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_47);
             <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_newFront.rcbuffer->pybuffer.buf, __pyx_t_45, __pyx_pybuffernd_newFront.diminfo[0].strides, __pyx_t_46, __pyx_pybuffernd_newFront.diminfo[1].strides) = __pyx_v_nx;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line234")'> 234:                         newFront[front_counter,1] = ny</pre>
<pre id='line234' class='code' style='background-color: #FFFFd4'>
            /* "epitopsy/cython/dx_cython.pyx":234
 *                         box[nx, ny, nz] = temp_value
 *                         newFront[front_counter,0] = nx
 *                         newFront[front_counter,1] = ny             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         newFront[front_counter,2] = nz
 *                         front_counter = front_counter + 1
 */
            __pyx_t_47 = __pyx_v_front_counter;
            __pyx_t_48 = 1;
            __pyx_t_49 = -1;
            if (__pyx_t_47 <code><</code> 0) {
              __pyx_t_47 += __pyx_pybuffernd_newFront.diminfo[0].shape;
              if (unlikely(__pyx_t_47 <code><</code> 0)) __pyx_t_49 = 0;
            } else if (unlikely(__pyx_t_47 >= __pyx_pybuffernd_newFront.diminfo[0].shape)) __pyx_t_49 = 0;
            if (__pyx_t_48 <code><</code> 0) {
              __pyx_t_48 += __pyx_pybuffernd_newFront.diminfo[1].shape;
              if (unlikely(__pyx_t_48 <code><</code> 0)) __pyx_t_49 = 1;
            } else if (unlikely(__pyx_t_48 >= __pyx_pybuffernd_newFront.diminfo[1].shape)) __pyx_t_49 = 1;
            if (unlikely(__pyx_t_49 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_49);
             <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_newFront.rcbuffer->pybuffer.buf, __pyx_t_47, __pyx_pybuffernd_newFront.diminfo[0].strides, __pyx_t_48, __pyx_pybuffernd_newFront.diminfo[1].strides) = __pyx_v_ny;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line235")'> 235:                         newFront[front_counter,2] = nz</pre>
<pre id='line235' class='code' style='background-color: #FFFFd4'>
            /* "epitopsy/cython/dx_cython.pyx":235
 *                         newFront[front_counter,0] = nx
 *                         newFront[front_counter,1] = ny
 *                         newFront[front_counter,2] = nz             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         front_counter = front_counter + 1
 *         if water_counter > 0:
 */
            __pyx_t_49 = __pyx_v_front_counter;
            __pyx_t_50 = 2;
            __pyx_t_51 = -1;
            if (__pyx_t_49 <code><</code> 0) {
              __pyx_t_49 += __pyx_pybuffernd_newFront.diminfo[0].shape;
              if (unlikely(__pyx_t_49 <code><</code> 0)) __pyx_t_51 = 0;
            } else if (unlikely(__pyx_t_49 >= __pyx_pybuffernd_newFront.diminfo[0].shape)) __pyx_t_51 = 0;
            if (__pyx_t_50 <code><</code> 0) {
              __pyx_t_50 += __pyx_pybuffernd_newFront.diminfo[1].shape;
              if (unlikely(__pyx_t_50 <code><</code> 0)) __pyx_t_51 = 1;
            } else if (unlikely(__pyx_t_50 >= __pyx_pybuffernd_newFront.diminfo[1].shape)) __pyx_t_51 = 1;
            if (unlikely(__pyx_t_51 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_51);
             <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_newFront.rcbuffer->pybuffer.buf, __pyx_t_49, __pyx_pybuffernd_newFront.diminfo[0].strides, __pyx_t_50, __pyx_pybuffernd_newFront.diminfo[1].strides) = __pyx_v_nz;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line236")'> 236:                         front_counter = front_counter + 1</pre>
<pre id='line236' class='code' style='background-color: #FFFFff'>
            /* "epitopsy/cython/dx_cython.pyx":236
 *                         newFront[front_counter,1] = ny
 *                         newFront[front_counter,2] = nz
 *                         front_counter = front_counter + 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if water_counter > 0:
 *             water_counter = front_counter
 */
            __pyx_v_front_counter = (__pyx_v_front_counter + 1);
            goto __pyx_L11;
          }
          __pyx_L11:;
          goto __pyx_L10;
        }
        __pyx_L10:;
      }
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line237")'> 237:         if water_counter &gt; 0:</pre>
<pre id='line237' class='code' style='background-color: #FFFFff'>
    /* "epitopsy/cython/dx_cython.pyx":237
 *                         newFront[front_counter,2] = nz
 *                         front_counter = front_counter + 1
 *         if water_counter > 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             water_counter = front_counter
 *             waterFront[0:water_counter,:] = newFront[0:water_counter,:]
 */
    __pyx_t_34 = ((__pyx_v_water_counter > 0) != 0);
    if (__pyx_t_34) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line238")'> 238:             water_counter = front_counter</pre>
<pre id='line238' class='code' style='background-color: #FFFFff'>
      /* "epitopsy/cython/dx_cython.pyx":238
 *                         front_counter = front_counter + 1
 *         if water_counter > 0:
 *             water_counter = front_counter             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             waterFront[0:water_counter,:] = newFront[0:water_counter,:]
 * 
 */
      __pyx_v_water_counter = __pyx_v_front_counter;
</pre><pre class='line' style='background-color: #FFFF23' onclick='toggleDiv("line239")'> 239:             waterFront[0:water_counter,:] = newFront[0:water_counter,:]</pre>
<pre id='line239' class='code' style='background-color: #FFFF23'>
      /* "epitopsy/cython/dx_cython.pyx":239
 *         if water_counter > 0:
 *             water_counter = front_counter
 *             waterFront[0:water_counter,:] = newFront[0:water_counter,:]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     for x in range(xdim):
 */
      __pyx_t_5 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_water_counter);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
      __pyx_t_2 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_0, __pyx_t_5, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_k_slice_53);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_k_slice_53);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_k_slice_53);
      __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_newFront), ((PyObject *)__pyx_t_5));<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_water_counter);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
      __pyx_t_6 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_0, __pyx_t_5, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;

  /* "epitopsy/cython/dx_cython.pyx":239
 *         if water_counter > 0:
 *             water_counter = front_counter
 *             waterFront[0:water_counter,:] = newFront[0:water_counter,:]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     for x in range(xdim):
 */
  __pyx_k_slice_53 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_k_slice_53)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_slice_53);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_k_slice_53);
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_k_slice_54);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_k_slice_54);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_k_slice_54);
      __pyx_t_6 = 0;
      if (<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_waterFront), ((PyObject *)__pyx_t_5), __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      goto __pyx_L12;
    }
    __pyx_L12:;
  }
  __pyx_k_slice_54 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_k_slice_54)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_slice_54);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_k_slice_54);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line240")'> 240: </pre>
<pre id='line240' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line241")'> 241:     for x in range(xdim):</pre>
<pre id='line241' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":241
 *             waterFront[0:water_counter,:] = newFront[0:water_counter,:]
 * 
 *     for x in range(xdim):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for y in range(ydim):
 *             for z in range(zdim):
 */
  __pyx_t_15 = __pyx_v_xdim;
  for (__pyx_t_26 = 0; __pyx_t_26 <code><</code> __pyx_t_15; __pyx_t_26+=1) {
    __pyx_v_x = __pyx_t_26;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line242")'> 242:         for y in range(ydim):</pre>
<pre id='line242' class='code' style='background-color: #FFFFff'>
    /* "epitopsy/cython/dx_cython.pyx":242
 * 
 *     for x in range(xdim):
 *         for y in range(ydim):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for z in range(zdim):
 *                 if box[x,y,z] == temp_value:
 */
    __pyx_t_51 = __pyx_v_ydim;
    for (__pyx_t_52 = 0; __pyx_t_52 <code><</code> __pyx_t_51; __pyx_t_52+=1) {
      __pyx_v_y = __pyx_t_52;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line243")'> 243:             for z in range(zdim):</pre>
<pre id='line243' class='code' style='background-color: #FFFFff'>
      /* "epitopsy/cython/dx_cython.pyx":243
 *     for x in range(xdim):
 *         for y in range(ydim):
 *             for z in range(zdim):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 if box[x,y,z] == temp_value:
 *                     # this should be the solvent
 */
      __pyx_t_53 = __pyx_v_zdim;
      for (__pyx_t_54 = 0; __pyx_t_54 <code><</code> __pyx_t_53; __pyx_t_54+=1) {
        __pyx_v_z = __pyx_t_54;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line244")'> 244:                 if box[x,y,z] == temp_value:</pre>
<pre id='line244' class='code' style='background-color: #FFFFd4'>
        /* "epitopsy/cython/dx_cython.pyx":244
 *         for y in range(ydim):
 *             for z in range(zdim):
 *                 if box[x,y,z] == temp_value:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     # this should be the solvent
 *                     box[x,y,z] = solventScore
 */
        __pyx_t_55 = __pyx_v_x;
        __pyx_t_56 = __pyx_v_y;
        __pyx_t_57 = __pyx_v_z;
        __pyx_t_58 = -1;
        if (__pyx_t_55 <code><</code> 0) {
          __pyx_t_55 += __pyx_v_box.shape[0];
          if (unlikely(__pyx_t_55 <code><</code> 0)) __pyx_t_58 = 0;
        } else if (unlikely(__pyx_t_55 >= __pyx_v_box.shape[0])) __pyx_t_58 = 0;
        if (__pyx_t_56 <code><</code> 0) {
          __pyx_t_56 += __pyx_v_box.shape[1];
          if (unlikely(__pyx_t_56 <code><</code> 0)) __pyx_t_58 = 1;
        } else if (unlikely(__pyx_t_56 >= __pyx_v_box.shape[1])) __pyx_t_58 = 1;
        if (__pyx_t_57 <code><</code> 0) {
          __pyx_t_57 += __pyx_v_box.shape[2];
          if (unlikely(__pyx_t_57 <code><</code> 0)) __pyx_t_58 = 2;
        } else if (unlikely(__pyx_t_57 >= __pyx_v_box.shape[2])) __pyx_t_58 = 2;
        if (unlikely(__pyx_t_58 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_58);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 244; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_34 = (((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_55 * __pyx_v_box.strides[0]) ) + __pyx_t_56 * __pyx_v_box.strides[1]) ) + __pyx_t_57 * __pyx_v_box.strides[2]) ))) == __pyx_v_temp_value) != 0);
        if (__pyx_t_34) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line245")'> 245:                     # this should be the solvent</pre>
<pre id='line245' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line246")'> 246:                     box[x,y,z] = solventScore</pre>
<pre id='line246' class='code' style='background-color: #FFFFd4'>
          /* "epitopsy/cython/dx_cython.pyx":246
 *                 if box[x,y,z] == temp_value:
 *                     # this should be the solvent
 *                     box[x,y,z] = solventScore             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 else:
 *                     # this is all protein
 */
          __pyx_t_58 = __pyx_v_x;
          __pyx_t_59 = __pyx_v_y;
          __pyx_t_60 = __pyx_v_z;
          __pyx_t_61 = -1;
          if (__pyx_t_58 <code><</code> 0) {
            __pyx_t_58 += __pyx_v_box.shape[0];
            if (unlikely(__pyx_t_58 <code><</code> 0)) __pyx_t_61 = 0;
          } else if (unlikely(__pyx_t_58 >= __pyx_v_box.shape[0])) __pyx_t_61 = 0;
          if (__pyx_t_59 <code><</code> 0) {
            __pyx_t_59 += __pyx_v_box.shape[1];
            if (unlikely(__pyx_t_59 <code><</code> 0)) __pyx_t_61 = 1;
          } else if (unlikely(__pyx_t_59 >= __pyx_v_box.shape[1])) __pyx_t_61 = 1;
          if (__pyx_t_60 <code><</code> 0) {
            __pyx_t_60 += __pyx_v_box.shape[2];
            if (unlikely(__pyx_t_60 <code><</code> 0)) __pyx_t_61 = 2;
          } else if (unlikely(__pyx_t_60 >= __pyx_v_box.shape[2])) __pyx_t_61 = 2;
          if (unlikely(__pyx_t_61 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_61);
           <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_58 * __pyx_v_box.strides[0]) ) + __pyx_t_59 * __pyx_v_box.strides[1]) ) + __pyx_t_60 * __pyx_v_box.strides[2]) )) = __pyx_v_solventScore;
          goto __pyx_L19;
        }
        /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line247")'> 247:                 else:</pre>
<pre id='line247' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line248")'> 248:                     # this is all protein</pre>
<pre id='line248' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line249")'> 249:                     box[x,y,z] = peptideScore</pre>
<pre id='line249' class='code' style='background-color: #FFFFd4'>
          /* "epitopsy/cython/dx_cython.pyx":249
 *                 else:
 *                     # this is all protein
 *                     box[x,y,z] = peptideScore             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     return box_np
 */
          __pyx_t_61 = __pyx_v_x;
          __pyx_t_62 = __pyx_v_y;
          __pyx_t_63 = __pyx_v_z;
          __pyx_t_64 = -1;
          if (__pyx_t_61 <code><</code> 0) {
            __pyx_t_61 += __pyx_v_box.shape[0];
            if (unlikely(__pyx_t_61 <code><</code> 0)) __pyx_t_64 = 0;
          } else if (unlikely(__pyx_t_61 >= __pyx_v_box.shape[0])) __pyx_t_64 = 0;
          if (__pyx_t_62 <code><</code> 0) {
            __pyx_t_62 += __pyx_v_box.shape[1];
            if (unlikely(__pyx_t_62 <code><</code> 0)) __pyx_t_64 = 1;
          } else if (unlikely(__pyx_t_62 >= __pyx_v_box.shape[1])) __pyx_t_64 = 1;
          if (__pyx_t_63 <code><</code> 0) {
            __pyx_t_63 += __pyx_v_box.shape[2];
            if (unlikely(__pyx_t_63 <code><</code> 0)) __pyx_t_64 = 2;
          } else if (unlikely(__pyx_t_63 >= __pyx_v_box.shape[2])) __pyx_t_64 = 2;
          if (unlikely(__pyx_t_64 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_64);
           <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_61 * __pyx_v_box.strides[0]) ) + __pyx_t_62 * __pyx_v_box.strides[1]) ) + __pyx_t_63 * __pyx_v_box.strides[2]) )) = __pyx_v_peptideScore;
        }
        __pyx_L19:;
      }
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line250")'> 250: </pre>
<pre id='line250' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF1f' onclick='toggleDiv("line251")'> 251:     return box_np</pre>
<pre id='line251' class='code' style='background-color: #FFFF1f'>
  /* "epitopsy/cython/dx_cython.pyx":251
 *                     box[x,y,z] = peptideScore
 * 
 *     return box_np             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_box_np));
  __pyx_r = ((PyObject *)__pyx_v_box_np);
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&__pyx_t_1, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&__pyx_type, &__pyx_value, &__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box_np.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_neighbors.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_newFront.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_waterFront.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython.flood", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box_np.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_neighbors.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_newFront.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_waterFront.rcbuffer->pybuffer);
  __pyx_L2:;
  __PYX_XDEC_MEMVIEW(&__pyx_v_box, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_waterFront);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_newFront);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_8epitopsy_6cython_9dx_cython_9floodxy(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_8epitopsy_6cython_9dx_cython_8floodxy[] = "\n    The VDW grid is a grid of 0's and 1's, like this:\n            1 1 1 1\n            1 0 0 1\n            1 0 1 1\n            1 1 1 1\n    The algorithm starts at [0,0,0] and appends the neighbors, which\n    have a value equal to a solvent grid node (i.e. 1), to the\n    newFront-list. After all neighbor nodes from the first list have\n    been checked, the list gets deleted and contains now the new\n    neighbors.\n    The process is repeated until now new neighbors are found, that is\n    there are no new neighbors.\n\n    Then the remaining solvent values are treated as protein nodes\n    (i.e. they are set to a peptide score, which is 0). All nodes\n    that have been assigned a temp value are then set back to 1.\n    ";
static PyMethodDef __pyx_mdef_8epitopsy_6cython_9dx_cython_9floodxy = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("floodxy"), (PyCFunction)__pyx_pw_8epitopsy_6cython_9dx_cython_9floodxy, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(__pyx_doc_8epitopsy_6cython_9dx_cython_8floodxy)};
static PyObject *__pyx_pw_8epitopsy_6cython_9dx_cython_9floodxy(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_box_np = 0;
  PyArrayObject *__pyx_v_neighbors = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("floodxy (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__box_np,&__pyx_n_s__neighbors,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__box_np)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__neighbors)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("floodxy", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "floodxy") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_box_np = ((PyArrayObject *)values[0]);
    __pyx_v_neighbors = ((PyArrayObject *)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("floodxy", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython.floodxy", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_box_np), __pyx_ptype_5numpy_ndarray, 0, "box_np", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_neighbors), __pyx_ptype_5numpy_ndarray, 1, "neighbors", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_8epitopsy_6cython_9dx_cython_8floodxy(__pyx_self, __pyx_v_box_np, __pyx_v_neighbors);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line252")'> 252: </pre>
<pre id='line252' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line253")'> 253: </pre>
<pre id='line253' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line254")'> 254: def floodxy(np.ndarray[np.float64_t, ndim=3] box_np not None,</pre>
<pre id='line254' class='code' style='background-color: #FFFF55'>
/* "epitopsy/cython/dx_cython.pyx":254
 * 
 * 
 * def floodxy(np.ndarray[np.float64_t, ndim=3] box_np not None,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         np.ndarray[np.int64_t, ndim=2] neighbors):
 *     """
 */

static PyObject *__pyx_pf_8epitopsy_6cython_9dx_cython_8floodxy(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_box_np, PyArrayObject *__pyx_v_neighbors) {
  __Pyx_memviewslice __pyx_v_box = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_xdim;
  int __pyx_v_ydim;
  int __pyx_v_zdim;
  int __pyx_v_j;
  int __pyx_v_n_iter;
  int __pyx_v_nx;
  int __pyx_v_ny;
  int __pyx_v_nz;
  int __pyx_v_neighbor_elements;
  int __pyx_v_x;
  int __pyx_v_y;
  int __pyx_v_z;
  CYTHON_UNUSED int __pyx_v_counter;
  int __pyx_v_posx;
  int __pyx_v_posy;
  int __pyx_v_posz;
  PyArrayObject *__pyx_v_waterFront = 0;
  PyArrayObject *__pyx_v_newFront = 0;
  int __pyx_v_water_counter;
  int __pyx_v_front_counter;
  __pyx_t_5numpy_float64_t __pyx_v_temp_value;
  __pyx_t_5numpy_float64_t __pyx_v_solventScore;
  __pyx_t_5numpy_float64_t __pyx_v_peptideScore;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_box_np;
  __Pyx_Buffer __pyx_pybuffer_box_np;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_neighbors;
  __Pyx_Buffer __pyx_pybuffer_neighbors;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_newFront;
  __Pyx_Buffer __pyx_pybuffer_newFront;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_waterFront;
  __Pyx_Buffer __pyx_pybuffer_waterFront;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("floodxy", 0);
  __pyx_pybuffer_waterFront.pybuffer.buf = NULL;
  __pyx_pybuffer_waterFront.refcount = 0;
  __pyx_pybuffernd_waterFront.data = NULL;
  __pyx_pybuffernd_waterFront.rcbuffer = &__pyx_pybuffer_waterFront;
  __pyx_pybuffer_newFront.pybuffer.buf = NULL;
  __pyx_pybuffer_newFront.refcount = 0;
  __pyx_pybuffernd_newFront.data = NULL;
  __pyx_pybuffernd_newFront.rcbuffer = &__pyx_pybuffer_newFront;
  __pyx_pybuffer_box_np.pybuffer.buf = NULL;
  __pyx_pybuffer_box_np.refcount = 0;
  __pyx_pybuffernd_box_np.data = NULL;
  __pyx_pybuffernd_box_np.rcbuffer = &__pyx_pybuffer_box_np;
  __pyx_pybuffer_neighbors.pybuffer.buf = NULL;
  __pyx_pybuffer_neighbors.refcount = 0;
  __pyx_pybuffernd_neighbors.data = NULL;
  __pyx_pybuffernd_neighbors.rcbuffer = &__pyx_pybuffer_neighbors;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_box_np.rcbuffer->pybuffer, (PyObject*)__pyx_v_box_np, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_box_np.diminfo[0].strides = __pyx_pybuffernd_box_np.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_box_np.diminfo[0].shape = __pyx_pybuffernd_box_np.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_box_np.diminfo[1].strides = __pyx_pybuffernd_box_np.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_box_np.diminfo[1].shape = __pyx_pybuffernd_box_np.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_box_np.diminfo[2].strides = __pyx_pybuffernd_box_np.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_box_np.diminfo[2].shape = __pyx_pybuffernd_box_np.rcbuffer->pybuffer.shape[2];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_neighbors.rcbuffer->pybuffer, (PyObject*)__pyx_v_neighbors, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_neighbors.diminfo[0].strides = __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_neighbors.diminfo[0].shape = __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_neighbors.diminfo[1].strides = __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_neighbors.diminfo[1].shape = __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.shape[1];

  /* "epitopsy/cython/dx_cython.pyx":254
 * 
 * 
 * def floodxy(np.ndarray[np.float64_t, ndim=3] box_np not None,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         np.ndarray[np.int64_t, ndim=2] neighbors):
 *     """
 */
  __pyx_k_tuple_117 = <span class='py_c_api'>PyTuple_Pack</span>(27, ((PyObject *)__pyx_n_s__box_np), ((PyObject *)__pyx_n_s__neighbors), ((PyObject *)__pyx_n_s__box), ((PyObject *)__pyx_n_s__xdim), ((PyObject *)__pyx_n_s__ydim), ((PyObject *)__pyx_n_s__zdim), ((PyObject *)__pyx_n_s__i), ((PyObject *)__pyx_n_s__j), ((PyObject *)__pyx_n_s__n_iter), ((PyObject *)__pyx_n_s__nx), ((PyObject *)__pyx_n_s__ny), ((PyObject *)__pyx_n_s__nz), ((PyObject *)__pyx_n_s__neighbor_elements), ((PyObject *)__pyx_n_s__x), ((PyObject *)__pyx_n_s__y), ((PyObject *)__pyx_n_s__z), ((PyObject *)__pyx_n_s__counter), ((PyObject *)__pyx_n_s__posx), ((PyObject *)__pyx_n_s__posy), ((PyObject *)__pyx_n_s__posz), ((PyObject *)__pyx_n_s__waterFront), ((PyObject *)__pyx_n_s__newFront), ((PyObject *)__pyx_n_s__water_counter), ((PyObject *)__pyx_n_s__front_counter), ((PyObject *)__pyx_n_s__temp_value), ((PyObject *)__pyx_n_s__solventScore), ((PyObject *)__pyx_n_s__peptideScore));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_117)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_117);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_117));

  /* "epitopsy/cython/dx_cython.pyx":254
 * 
 * 
 * def floodxy(np.ndarray[np.float64_t, ndim=3] box_np not None,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         np.ndarray[np.int64_t, ndim=2] neighbors):
 *     """
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_8epitopsy_6cython_9dx_cython_9floodxy, NULL, __pyx_n_s_110);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__floodxy, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_118 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(2, 0, 27, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_117, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_109, __pyx_n_s__floodxy, 254, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_118)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line255")'> 255:         np.ndarray[np.int64_t, ndim=2] neighbors):</pre>
<pre id='line255' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line256")'> 256:     """</pre>
<pre id='line256' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line257")'> 257:     The VDW grid is a grid of 0's and 1's, like this:</pre>
<pre id='line257' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line258")'> 258:             1 1 1 1</pre>
<pre id='line258' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line259")'> 259:             1 0 0 1</pre>
<pre id='line259' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line260")'> 260:             1 0 1 1</pre>
<pre id='line260' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line261")'> 261:             1 1 1 1</pre>
<pre id='line261' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line262")'> 262:     The algorithm starts at [0,0,0] and appends the neighbors, which</pre>
<pre id='line262' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line263")'> 263:     have a value equal to a solvent grid node (i.e. 1), to the</pre>
<pre id='line263' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line264")'> 264:     newFront-list. After all neighbor nodes from the first list have</pre>
<pre id='line264' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line265")'> 265:     been checked, the list gets deleted and contains now the new</pre>
<pre id='line265' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line266")'> 266:     neighbors.</pre>
<pre id='line266' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line267")'> 267:     The process is repeated until now new neighbors are found, that is</pre>
<pre id='line267' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line268")'> 268:     there are no new neighbors.</pre>
<pre id='line268' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line269")'> 269: </pre>
<pre id='line269' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line270")'> 270:     Then the remaining solvent values are treated as protein nodes</pre>
<pre id='line270' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line271")'> 271:     (i.e. they are set to a peptide score, which is 0). All nodes</pre>
<pre id='line271' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line272")'> 272:     that have been assigned a temp value are then set back to 1.</pre>
<pre id='line272' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line273")'> 273:     """</pre>
<pre id='line273' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line274")'> 274:     cdef double[:,:,:] box = box_np</pre>
<pre id='line274' class='code' style='background-color: #FFFFd4'>
  /* "epitopsy/cython/dx_cython.pyx":274
 *     that have been assigned a temp value are then set back to 1.
 *     """
 *     cdef double[:,:,:] box = box_np             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int xdim = box.shape[0]
 *     cdef int ydim = box.shape[1]
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_double</span>(((PyObject *)__pyx_v_box_np));
  if (unlikely(!__pyx_t_1.memview))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_box = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line275")'> 275:     cdef int xdim = box.shape[0]</pre>
<pre id='line275' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":275
 *     """
 *     cdef double[:,:,:] box = box_np
 *     cdef int xdim = box.shape[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int ydim = box.shape[1]
 *     cdef int zdim = box.shape[2]
 */
  __pyx_v_xdim = (__pyx_v_box.shape[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line276")'> 276:     cdef int ydim = box.shape[1]</pre>
<pre id='line276' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":276
 *     cdef double[:,:,:] box = box_np
 *     cdef int xdim = box.shape[0]
 *     cdef int ydim = box.shape[1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int zdim = box.shape[2]
 *     cdef int i,j
 */
  __pyx_v_ydim = (__pyx_v_box.shape[1]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line277")'> 277:     cdef int zdim = box.shape[2]</pre>
<pre id='line277' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":277
 *     cdef int xdim = box.shape[0]
 *     cdef int ydim = box.shape[1]
 *     cdef int zdim = box.shape[2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int i,j
 *     cdef int n_iter
 */
  __pyx_v_zdim = (__pyx_v_box.shape[2]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line278")'> 278:     cdef int i,j</pre>
<pre id='line278' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line279")'> 279:     cdef int n_iter</pre>
<pre id='line279' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line280")'> 280:     cdef int nx,ny,nz</pre>
<pre id='line280' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line281")'> 281:     cdef int neighbor_elements = neighbors.shape[0]</pre>
<pre id='line281' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":281
 *     cdef int n_iter
 *     cdef int nx,ny,nz
 *     cdef int neighbor_elements = neighbors.shape[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int x,y,z
 *     cdef int counter = 0
 */
  __pyx_v_neighbor_elements = (__pyx_v_neighbors->dimensions[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line282")'> 282:     cdef int x,y,z</pre>
<pre id='line282' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line283")'> 283:     cdef int counter = 0</pre>
<pre id='line283' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":283
 *     cdef int neighbor_elements = neighbors.shape[0]
 *     cdef int x,y,z
 *     cdef int counter = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int posx, posy, posz
 *     cdef np.ndarray[np.int64_t,ndim=2] waterFront = np.zeros([xdim*ydim,2],dtype = np.int64)
 */
  __pyx_v_counter = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line284")'> 284:     cdef int posx, posy, posz</pre>
<pre id='line284' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF24' onclick='toggleDiv("line285")'> 285:     cdef np.ndarray[np.int64_t,ndim=2] waterFront = np.zeros([xdim*ydim,2],dtype = np.int64)</pre>
<pre id='line285' class='code' style='background-color: #FFFF24'>
  /* "epitopsy/cython/dx_cython.pyx":285
 *     cdef int counter = 0
 *     cdef int posx, posy, posz
 *     cdef np.ndarray[np.int64_t,ndim=2] waterFront = np.zeros([xdim*ydim,2],dtype = np.int64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.ndarray[np.int64_t,ndim=2] newFront = np.zeros([xdim*ydim,2],dtype = np.int64)
 *     cdef int water_counter = 0
 */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s__zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_xdim * __pyx_v_ydim));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_t_4));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_4));
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_4));
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s__int64);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, ((PyObject *)__pyx_n_s__dtype), __pyx_t_6) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_2), ((PyObject *)__pyx_t_4));<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_waterFront.rcbuffer->pybuffer, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_waterFront = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_waterFront.rcbuffer->pybuffer.buf = NULL;
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_waterFront.diminfo[0].strides = __pyx_pybuffernd_waterFront.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_waterFront.diminfo[0].shape = __pyx_pybuffernd_waterFront.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_waterFront.diminfo[1].strides = __pyx_pybuffernd_waterFront.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_waterFront.diminfo[1].shape = __pyx_pybuffernd_waterFront.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_waterFront = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;
</pre><pre class='line' style='background-color: #FFFF24' onclick='toggleDiv("line286")'> 286:     cdef np.ndarray[np.int64_t,ndim=2] newFront = np.zeros([xdim*ydim,2],dtype = np.int64)</pre>
<pre id='line286' class='code' style='background-color: #FFFF24'>
  /* "epitopsy/cython/dx_cython.pyx":286
 *     cdef int posx, posy, posz
 *     cdef np.ndarray[np.int64_t,ndim=2] waterFront = np.zeros([xdim*ydim,2],dtype = np.int64)
 *     cdef np.ndarray[np.int64_t,ndim=2] newFront = np.zeros([xdim*ydim,2],dtype = np.int64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int water_counter = 0
 *     cdef int front_counter = 0
 */
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s__zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_xdim * __pyx_v_ydim));<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_6);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_2);
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, ((PyObject *)__pyx_t_2));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_2));
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s__int64);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), __pyx_t_5) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_4, ((PyObject *)__pyx_t_6), ((PyObject *)__pyx_t_2));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_newFront.rcbuffer->pybuffer, (PyObject*)__pyx_t_8, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_newFront = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_newFront.rcbuffer->pybuffer.buf = NULL;
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_newFront.diminfo[0].strides = __pyx_pybuffernd_newFront.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_newFront.diminfo[0].shape = __pyx_pybuffernd_newFront.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_newFront.diminfo[1].strides = __pyx_pybuffernd_newFront.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_newFront.diminfo[1].shape = __pyx_pybuffernd_newFront.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_8 = 0;
  __pyx_v_newFront = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line287")'> 287:     cdef int water_counter = 0</pre>
<pre id='line287' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":287
 *     cdef np.ndarray[np.int64_t,ndim=2] waterFront = np.zeros([xdim*ydim,2],dtype = np.int64)
 *     cdef np.ndarray[np.int64_t,ndim=2] newFront = np.zeros([xdim*ydim,2],dtype = np.int64)
 *     cdef int water_counter = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int front_counter = 0
 * 
 */
  __pyx_v_water_counter = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line288")'> 288:     cdef int front_counter = 0</pre>
<pre id='line288' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":288
 *     cdef np.ndarray[np.int64_t,ndim=2] newFront = np.zeros([xdim*ydim,2],dtype = np.int64)
 *     cdef int water_counter = 0
 *     cdef int front_counter = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef np.float64_t temp_value = -1
 */
  __pyx_v_front_counter = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line289")'> 289: </pre>
<pre id='line289' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line290")'> 290:     cdef np.float64_t temp_value = -1</pre>
<pre id='line290' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":290
 *     cdef int front_counter = 0
 * 
 *     cdef np.float64_t temp_value = -1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.float64_t solventScore = 1
 *     cdef np.float64_t peptideScore = 0
 */
  __pyx_v_temp_value = -1.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line291")'> 291:     cdef np.float64_t solventScore = 1</pre>
<pre id='line291' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":291
 * 
 *     cdef np.float64_t temp_value = -1
 *     cdef np.float64_t solventScore = 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.float64_t peptideScore = 0
 * 
 */
  __pyx_v_solventScore = 1.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line292")'> 292:     cdef np.float64_t peptideScore = 0</pre>
<pre id='line292' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":292
 *     cdef np.float64_t temp_value = -1
 *     cdef np.float64_t solventScore = 1
 *     cdef np.float64_t peptideScore = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     # reset counter and array
 */
  __pyx_v_peptideScore = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line293")'> 293: </pre>
<pre id='line293' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line294")'> 294:     # reset counter and array</pre>
<pre id='line294' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line295")'> 295:     for posz in range(zdim):</pre>
<pre id='line295' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":295
 * 
 *     # reset counter and array
 *     for posz in range(zdim):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         waterFront[water_counter,0] = 0
 *         waterFront[water_counter,1] = 0
 */
  __pyx_t_9 = __pyx_v_zdim;
  for (__pyx_t_10 = 0; __pyx_t_10 <code><</code> __pyx_t_9; __pyx_t_10+=1) {
    __pyx_v_posz = __pyx_t_10;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line296")'> 296:         waterFront[water_counter,0] = 0</pre>
<pre id='line296' class='code' style='background-color: #FFFFd4'>
    /* "epitopsy/cython/dx_cython.pyx":296
 *     # reset counter and array
 *     for posz in range(zdim):
 *         waterFront[water_counter,0] = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         waterFront[water_counter,1] = 0
 *         water_counter = 1
 */
    __pyx_t_11 = __pyx_v_water_counter;
    __pyx_t_12 = 0;
    __pyx_t_13 = -1;
    if (__pyx_t_11 <code><</code> 0) {
      __pyx_t_11 += __pyx_pybuffernd_waterFront.diminfo[0].shape;
      if (unlikely(__pyx_t_11 <code><</code> 0)) __pyx_t_13 = 0;
    } else if (unlikely(__pyx_t_11 >= __pyx_pybuffernd_waterFront.diminfo[0].shape)) __pyx_t_13 = 0;
    if (__pyx_t_12 <code><</code> 0) {
      __pyx_t_12 += __pyx_pybuffernd_waterFront.diminfo[1].shape;
      if (unlikely(__pyx_t_12 <code><</code> 0)) __pyx_t_13 = 1;
    } else if (unlikely(__pyx_t_12 >= __pyx_pybuffernd_waterFront.diminfo[1].shape)) __pyx_t_13 = 1;
    if (unlikely(__pyx_t_13 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_waterFront.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_waterFront.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_waterFront.diminfo[1].strides) = 0;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line297")'> 297:         waterFront[water_counter,1] = 0</pre>
<pre id='line297' class='code' style='background-color: #FFFFd4'>
    /* "epitopsy/cython/dx_cython.pyx":297
 *     for posz in range(zdim):
 *         waterFront[water_counter,0] = 0
 *         waterFront[water_counter,1] = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         water_counter = 1
 *         while(water_counter > 0):
 */
    __pyx_t_13 = __pyx_v_water_counter;
    __pyx_t_14 = 1;
    __pyx_t_15 = -1;
    if (__pyx_t_13 <code><</code> 0) {
      __pyx_t_13 += __pyx_pybuffernd_waterFront.diminfo[0].shape;
      if (unlikely(__pyx_t_13 <code><</code> 0)) __pyx_t_15 = 0;
    } else if (unlikely(__pyx_t_13 >= __pyx_pybuffernd_waterFront.diminfo[0].shape)) __pyx_t_15 = 0;
    if (__pyx_t_14 <code><</code> 0) {
      __pyx_t_14 += __pyx_pybuffernd_waterFront.diminfo[1].shape;
      if (unlikely(__pyx_t_14 <code><</code> 0)) __pyx_t_15 = 1;
    } else if (unlikely(__pyx_t_14 >= __pyx_pybuffernd_waterFront.diminfo[1].shape)) __pyx_t_15 = 1;
    if (unlikely(__pyx_t_15 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_15);
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 297; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_waterFront.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_waterFront.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_waterFront.diminfo[1].strides) = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line298")'> 298:         water_counter = 1</pre>
<pre id='line298' class='code' style='background-color: #FFFFff'>
    /* "epitopsy/cython/dx_cython.pyx":298
 *         waterFront[water_counter,0] = 0
 *         waterFront[water_counter,1] = 0
 *         water_counter = 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         while(water_counter > 0):
 *             if front_counter > 0:
 */
    __pyx_v_water_counter = 1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line299")'> 299:         while(water_counter &gt; 0):</pre>
<pre id='line299' class='code' style='background-color: #FFFFff'>
    /* "epitopsy/cython/dx_cython.pyx":299
 *         waterFront[water_counter,1] = 0
 *         water_counter = 1
 *         while(water_counter > 0):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if front_counter > 0:
 *                 front_counter = 0
 */
    while (1) {
      __pyx_t_16 = ((__pyx_v_water_counter > 0) != 0);
      if (!__pyx_t_16) break;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line300")'> 300:             if front_counter &gt; 0:</pre>
<pre id='line300' class='code' style='background-color: #FFFFff'>
      /* "epitopsy/cython/dx_cython.pyx":300
 *         water_counter = 1
 *         while(water_counter > 0):
 *             if front_counter > 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 front_counter = 0
 *             for j from 0 <code><</code>= j <code><</code> water_counter:
 */
      __pyx_t_16 = ((__pyx_v_front_counter > 0) != 0);
      if (__pyx_t_16) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line301")'> 301:                 front_counter = 0</pre>
<pre id='line301' class='code' style='background-color: #FFFFff'>
        /* "epitopsy/cython/dx_cython.pyx":301
 *         while(water_counter > 0):
 *             if front_counter > 0:
 *                 front_counter = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for j from 0 <code><</code>= j <code><</code> water_counter:
 *                 posx = waterFront[j,0]
 */
        __pyx_v_front_counter = 0;
        goto __pyx_L7;
      }
      __pyx_L7:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line302")'> 302:             for j from 0 &lt;= j &lt; water_counter:</pre>
<pre id='line302' class='code' style='background-color: #FFFFff'>
      /* "epitopsy/cython/dx_cython.pyx":302
 *             if front_counter > 0:
 *                 front_counter = 0
 *             for j from 0 <code><</code>= j <code><</code> water_counter:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 posx = waterFront[j,0]
 *                 posy = waterFront[j,1]
 */
      __pyx_t_15 = __pyx_v_water_counter;
      for (__pyx_v_j = 0; __pyx_v_j <code><</code> __pyx_t_15; __pyx_v_j++) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line303")'> 303:                 posx = waterFront[j,0]</pre>
<pre id='line303' class='code' style='background-color: #FFFFd4'>
        /* "epitopsy/cython/dx_cython.pyx":303
 *                 front_counter = 0
 *             for j from 0 <code><</code>= j <code><</code> water_counter:
 *                 posx = waterFront[j,0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 posy = waterFront[j,1]
 *                 box[posx, posy,posz] = temp_value
 */
        __pyx_t_17 = __pyx_v_j;
        __pyx_t_18 = 0;
        __pyx_t_19 = -1;
        if (__pyx_t_17 <code><</code> 0) {
          __pyx_t_17 += __pyx_pybuffernd_waterFront.diminfo[0].shape;
          if (unlikely(__pyx_t_17 <code><</code> 0)) __pyx_t_19 = 0;
        } else if (unlikely(__pyx_t_17 >= __pyx_pybuffernd_waterFront.diminfo[0].shape)) __pyx_t_19 = 0;
        if (__pyx_t_18 <code><</code> 0) {
          __pyx_t_18 += __pyx_pybuffernd_waterFront.diminfo[1].shape;
          if (unlikely(__pyx_t_18 <code><</code> 0)) __pyx_t_19 = 1;
        } else if (unlikely(__pyx_t_18 >= __pyx_pybuffernd_waterFront.diminfo[1].shape)) __pyx_t_19 = 1;
        if (unlikely(__pyx_t_19 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_v_posx = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_waterFront.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_waterFront.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_waterFront.diminfo[1].strides));
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line304")'> 304:                 posy = waterFront[j,1]</pre>
<pre id='line304' class='code' style='background-color: #FFFFd4'>
        /* "epitopsy/cython/dx_cython.pyx":304
 *             for j from 0 <code><</code>= j <code><</code> water_counter:
 *                 posx = waterFront[j,0]
 *                 posy = waterFront[j,1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 box[posx, posy,posz] = temp_value
 *                 for n_iter from 0 <code><</code>= n_iter <code><</code> neighbor_elements:
 */
        __pyx_t_19 = __pyx_v_j;
        __pyx_t_20 = 1;
        __pyx_t_21 = -1;
        if (__pyx_t_19 <code><</code> 0) {
          __pyx_t_19 += __pyx_pybuffernd_waterFront.diminfo[0].shape;
          if (unlikely(__pyx_t_19 <code><</code> 0)) __pyx_t_21 = 0;
        } else if (unlikely(__pyx_t_19 >= __pyx_pybuffernd_waterFront.diminfo[0].shape)) __pyx_t_21 = 0;
        if (__pyx_t_20 <code><</code> 0) {
          __pyx_t_20 += __pyx_pybuffernd_waterFront.diminfo[1].shape;
          if (unlikely(__pyx_t_20 <code><</code> 0)) __pyx_t_21 = 1;
        } else if (unlikely(__pyx_t_20 >= __pyx_pybuffernd_waterFront.diminfo[1].shape)) __pyx_t_21 = 1;
        if (unlikely(__pyx_t_21 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_v_posy = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_waterFront.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_waterFront.diminfo[0].strides, __pyx_t_20, __pyx_pybuffernd_waterFront.diminfo[1].strides));
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line305")'> 305:                 box[posx, posy,posz] = temp_value</pre>
<pre id='line305' class='code' style='background-color: #FFFFd4'>
        /* "epitopsy/cython/dx_cython.pyx":305
 *                 posx = waterFront[j,0]
 *                 posy = waterFront[j,1]
 *                 box[posx, posy,posz] = temp_value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for n_iter from 0 <code><</code>= n_iter <code><</code> neighbor_elements:
 *                     nx = posx + neighbors[n_iter,0]
 */
        __pyx_t_21 = __pyx_v_posx;
        __pyx_t_22 = __pyx_v_posy;
        __pyx_t_23 = __pyx_v_posz;
        __pyx_t_24 = -1;
        if (__pyx_t_21 <code><</code> 0) {
          __pyx_t_21 += __pyx_v_box.shape[0];
          if (unlikely(__pyx_t_21 <code><</code> 0)) __pyx_t_24 = 0;
        } else if (unlikely(__pyx_t_21 >= __pyx_v_box.shape[0])) __pyx_t_24 = 0;
        if (__pyx_t_22 <code><</code> 0) {
          __pyx_t_22 += __pyx_v_box.shape[1];
          if (unlikely(__pyx_t_22 <code><</code> 0)) __pyx_t_24 = 1;
        } else if (unlikely(__pyx_t_22 >= __pyx_v_box.shape[1])) __pyx_t_24 = 1;
        if (__pyx_t_23 <code><</code> 0) {
          __pyx_t_23 += __pyx_v_box.shape[2];
          if (unlikely(__pyx_t_23 <code><</code> 0)) __pyx_t_24 = 2;
        } else if (unlikely(__pyx_t_23 >= __pyx_v_box.shape[2])) __pyx_t_24 = 2;
        if (unlikely(__pyx_t_24 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_24);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_21 * __pyx_v_box.strides[0]) ) + __pyx_t_22 * __pyx_v_box.strides[1]) ) + __pyx_t_23 * __pyx_v_box.strides[2]) )) = __pyx_v_temp_value;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line306")'> 306:                 for n_iter from 0 &lt;= n_iter &lt; neighbor_elements:</pre>
<pre id='line306' class='code' style='background-color: #FFFFff'>
        /* "epitopsy/cython/dx_cython.pyx":306
 *                 posy = waterFront[j,1]
 *                 box[posx, posy,posz] = temp_value
 *                 for n_iter from 0 <code><</code>= n_iter <code><</code> neighbor_elements:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     nx = posx + neighbors[n_iter,0]
 *                     ny = posy + neighbors[n_iter,1]
 */
        __pyx_t_24 = __pyx_v_neighbor_elements;
        for (__pyx_v_n_iter = 0; __pyx_v_n_iter <code><</code> __pyx_t_24; __pyx_v_n_iter++) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line307")'> 307:                     nx = posx + neighbors[n_iter,0]</pre>
<pre id='line307' class='code' style='background-color: #FFFFd4'>
          /* "epitopsy/cython/dx_cython.pyx":307
 *                 box[posx, posy,posz] = temp_value
 *                 for n_iter from 0 <code><</code>= n_iter <code><</code> neighbor_elements:
 *                     nx = posx + neighbors[n_iter,0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     ny = posy + neighbors[n_iter,1]
 *                     nz = posz
 */
          __pyx_t_25 = __pyx_v_n_iter;
          __pyx_t_26 = 0;
          __pyx_t_27 = -1;
          if (__pyx_t_25 <code><</code> 0) {
            __pyx_t_25 += __pyx_pybuffernd_neighbors.diminfo[0].shape;
            if (unlikely(__pyx_t_25 <code><</code> 0)) __pyx_t_27 = 0;
          } else if (unlikely(__pyx_t_25 >= __pyx_pybuffernd_neighbors.diminfo[0].shape)) __pyx_t_27 = 0;
          if (__pyx_t_26 <code><</code> 0) {
            __pyx_t_26 += __pyx_pybuffernd_neighbors.diminfo[1].shape;
            if (unlikely(__pyx_t_26 <code><</code> 0)) __pyx_t_27 = 1;
          } else if (unlikely(__pyx_t_26 >= __pyx_pybuffernd_neighbors.diminfo[1].shape)) __pyx_t_27 = 1;
          if (unlikely(__pyx_t_27 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_27);
           <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 307; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_v_nx = (__pyx_v_posx + (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.buf, __pyx_t_25, __pyx_pybuffernd_neighbors.diminfo[0].strides, __pyx_t_26, __pyx_pybuffernd_neighbors.diminfo[1].strides)));
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line308")'> 308:                     ny = posy + neighbors[n_iter,1]</pre>
<pre id='line308' class='code' style='background-color: #FFFFd4'>
          /* "epitopsy/cython/dx_cython.pyx":308
 *                 for n_iter from 0 <code><</code>= n_iter <code><</code> neighbor_elements:
 *                     nx = posx + neighbors[n_iter,0]
 *                     ny = posy + neighbors[n_iter,1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     nz = posz
 *                     if (nx >= 0 and nx <code><</code> xdim and ny >= 0 and ny <code><</code> ydim):
 */
          __pyx_t_27 = __pyx_v_n_iter;
          __pyx_t_28 = 1;
          __pyx_t_29 = -1;
          if (__pyx_t_27 <code><</code> 0) {
            __pyx_t_27 += __pyx_pybuffernd_neighbors.diminfo[0].shape;
            if (unlikely(__pyx_t_27 <code><</code> 0)) __pyx_t_29 = 0;
          } else if (unlikely(__pyx_t_27 >= __pyx_pybuffernd_neighbors.diminfo[0].shape)) __pyx_t_29 = 0;
          if (__pyx_t_28 <code><</code> 0) {
            __pyx_t_28 += __pyx_pybuffernd_neighbors.diminfo[1].shape;
            if (unlikely(__pyx_t_28 <code><</code> 0)) __pyx_t_29 = 1;
          } else if (unlikely(__pyx_t_28 >= __pyx_pybuffernd_neighbors.diminfo[1].shape)) __pyx_t_29 = 1;
          if (unlikely(__pyx_t_29 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_29);
           <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 308; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_v_ny = (__pyx_v_posy + (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.buf, __pyx_t_27, __pyx_pybuffernd_neighbors.diminfo[0].strides, __pyx_t_28, __pyx_pybuffernd_neighbors.diminfo[1].strides)));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line309")'> 309:                     nz = posz</pre>
<pre id='line309' class='code' style='background-color: #FFFFff'>
          /* "epitopsy/cython/dx_cython.pyx":309
 *                     nx = posx + neighbors[n_iter,0]
 *                     ny = posy + neighbors[n_iter,1]
 *                     nz = posz             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     if (nx >= 0 and nx <code><</code> xdim and ny >= 0 and ny <code><</code> ydim):
 *                         if box[nx,ny,nz] == solventScore:
 */
          __pyx_v_nz = __pyx_v_posz;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line310")'> 310:                     if (nx &gt;= 0 and nx &lt; xdim and ny &gt;= 0 and ny &lt; ydim):</pre>
<pre id='line310' class='code' style='background-color: #FFFFff'>
          /* "epitopsy/cython/dx_cython.pyx":310
 *                     ny = posy + neighbors[n_iter,1]
 *                     nz = posz
 *                     if (nx >= 0 and nx <code><</code> xdim and ny >= 0 and ny <code><</code> ydim):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         if box[nx,ny,nz] == solventScore:
 *                             box[nx, ny, nz] = temp_value
 */
          __pyx_t_16 = ((__pyx_v_nx >= 0) != 0);
          if (__pyx_t_16) {
            __pyx_t_30 = ((__pyx_v_nx <code><</code> __pyx_v_xdim) != 0);
            if (__pyx_t_30) {
              __pyx_t_31 = ((__pyx_v_ny >= 0) != 0);
              if (__pyx_t_31) {
                __pyx_t_32 = ((__pyx_v_ny <code><</code> __pyx_v_ydim) != 0);
                __pyx_t_33 = __pyx_t_32;
              } else {
                __pyx_t_33 = __pyx_t_31;
              }
              __pyx_t_31 = __pyx_t_33;
            } else {
              __pyx_t_31 = __pyx_t_30;
            }
            __pyx_t_30 = __pyx_t_31;
          } else {
            __pyx_t_30 = __pyx_t_16;
          }
          if (__pyx_t_30) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line311")'> 311:                         if box[nx,ny,nz] == solventScore:</pre>
<pre id='line311' class='code' style='background-color: #FFFFd4'>
            /* "epitopsy/cython/dx_cython.pyx":311
 *                     nz = posz
 *                     if (nx >= 0 and nx <code><</code> xdim and ny >= 0 and ny <code><</code> ydim):
 *                         if box[nx,ny,nz] == solventScore:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             box[nx, ny, nz] = temp_value
 *                             newFront[front_counter,0] = nx
 */
            __pyx_t_29 = __pyx_v_nx;
            __pyx_t_34 = __pyx_v_ny;
            __pyx_t_35 = __pyx_v_nz;
            __pyx_t_36 = -1;
            if (__pyx_t_29 <code><</code> 0) {
              __pyx_t_29 += __pyx_v_box.shape[0];
              if (unlikely(__pyx_t_29 <code><</code> 0)) __pyx_t_36 = 0;
            } else if (unlikely(__pyx_t_29 >= __pyx_v_box.shape[0])) __pyx_t_36 = 0;
            if (__pyx_t_34 <code><</code> 0) {
              __pyx_t_34 += __pyx_v_box.shape[1];
              if (unlikely(__pyx_t_34 <code><</code> 0)) __pyx_t_36 = 1;
            } else if (unlikely(__pyx_t_34 >= __pyx_v_box.shape[1])) __pyx_t_36 = 1;
            if (__pyx_t_35 <code><</code> 0) {
              __pyx_t_35 += __pyx_v_box.shape[2];
              if (unlikely(__pyx_t_35 <code><</code> 0)) __pyx_t_36 = 2;
            } else if (unlikely(__pyx_t_35 >= __pyx_v_box.shape[2])) __pyx_t_36 = 2;
            if (unlikely(__pyx_t_36 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_36);
             <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            __pyx_t_30 = (((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_29 * __pyx_v_box.strides[0]) ) + __pyx_t_34 * __pyx_v_box.strides[1]) ) + __pyx_t_35 * __pyx_v_box.strides[2]) ))) == __pyx_v_solventScore) != 0);
            if (__pyx_t_30) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line312")'> 312:                             box[nx, ny, nz] = temp_value</pre>
<pre id='line312' class='code' style='background-color: #FFFFd4'>
              /* "epitopsy/cython/dx_cython.pyx":312
 *                     if (nx >= 0 and nx <code><</code> xdim and ny >= 0 and ny <code><</code> ydim):
 *                         if box[nx,ny,nz] == solventScore:
 *                             box[nx, ny, nz] = temp_value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             newFront[front_counter,0] = nx
 *                             newFront[front_counter,1] = ny
 */
              __pyx_t_36 = __pyx_v_nx;
              __pyx_t_37 = __pyx_v_ny;
              __pyx_t_38 = __pyx_v_nz;
              __pyx_t_39 = -1;
              if (__pyx_t_36 <code><</code> 0) {
                __pyx_t_36 += __pyx_v_box.shape[0];
                if (unlikely(__pyx_t_36 <code><</code> 0)) __pyx_t_39 = 0;
              } else if (unlikely(__pyx_t_36 >= __pyx_v_box.shape[0])) __pyx_t_39 = 0;
              if (__pyx_t_37 <code><</code> 0) {
                __pyx_t_37 += __pyx_v_box.shape[1];
                if (unlikely(__pyx_t_37 <code><</code> 0)) __pyx_t_39 = 1;
              } else if (unlikely(__pyx_t_37 >= __pyx_v_box.shape[1])) __pyx_t_39 = 1;
              if (__pyx_t_38 <code><</code> 0) {
                __pyx_t_38 += __pyx_v_box.shape[2];
                if (unlikely(__pyx_t_38 <code><</code> 0)) __pyx_t_39 = 2;
              } else if (unlikely(__pyx_t_38 >= __pyx_v_box.shape[2])) __pyx_t_39 = 2;
              if (unlikely(__pyx_t_39 != -1)) {
                <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_39);
               <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              }
              *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_36 * __pyx_v_box.strides[0]) ) + __pyx_t_37 * __pyx_v_box.strides[1]) ) + __pyx_t_38 * __pyx_v_box.strides[2]) )) = __pyx_v_temp_value;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line313")'> 313:                             newFront[front_counter,0] = nx</pre>
<pre id='line313' class='code' style='background-color: #FFFFd4'>
              /* "epitopsy/cython/dx_cython.pyx":313
 *                         if box[nx,ny,nz] == solventScore:
 *                             box[nx, ny, nz] = temp_value
 *                             newFront[front_counter,0] = nx             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             newFront[front_counter,1] = ny
 *                             front_counter = front_counter + 1
 */
              __pyx_t_39 = __pyx_v_front_counter;
              __pyx_t_40 = 0;
              __pyx_t_41 = -1;
              if (__pyx_t_39 <code><</code> 0) {
                __pyx_t_39 += __pyx_pybuffernd_newFront.diminfo[0].shape;
                if (unlikely(__pyx_t_39 <code><</code> 0)) __pyx_t_41 = 0;
              } else if (unlikely(__pyx_t_39 >= __pyx_pybuffernd_newFront.diminfo[0].shape)) __pyx_t_41 = 0;
              if (__pyx_t_40 <code><</code> 0) {
                __pyx_t_40 += __pyx_pybuffernd_newFront.diminfo[1].shape;
                if (unlikely(__pyx_t_40 <code><</code> 0)) __pyx_t_41 = 1;
              } else if (unlikely(__pyx_t_40 >= __pyx_pybuffernd_newFront.diminfo[1].shape)) __pyx_t_41 = 1;
              if (unlikely(__pyx_t_41 != -1)) {
                <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_41);
               <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 313; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              }
              *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_newFront.rcbuffer->pybuffer.buf, __pyx_t_39, __pyx_pybuffernd_newFront.diminfo[0].strides, __pyx_t_40, __pyx_pybuffernd_newFront.diminfo[1].strides) = __pyx_v_nx;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line314")'> 314:                             newFront[front_counter,1] = ny</pre>
<pre id='line314' class='code' style='background-color: #FFFFd4'>
              /* "epitopsy/cython/dx_cython.pyx":314
 *                             box[nx, ny, nz] = temp_value
 *                             newFront[front_counter,0] = nx
 *                             newFront[front_counter,1] = ny             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             front_counter = front_counter + 1
 *             if water_counter > 0:
 */
              __pyx_t_41 = __pyx_v_front_counter;
              __pyx_t_42 = 1;
              __pyx_t_43 = -1;
              if (__pyx_t_41 <code><</code> 0) {
                __pyx_t_41 += __pyx_pybuffernd_newFront.diminfo[0].shape;
                if (unlikely(__pyx_t_41 <code><</code> 0)) __pyx_t_43 = 0;
              } else if (unlikely(__pyx_t_41 >= __pyx_pybuffernd_newFront.diminfo[0].shape)) __pyx_t_43 = 0;
              if (__pyx_t_42 <code><</code> 0) {
                __pyx_t_42 += __pyx_pybuffernd_newFront.diminfo[1].shape;
                if (unlikely(__pyx_t_42 <code><</code> 0)) __pyx_t_43 = 1;
              } else if (unlikely(__pyx_t_42 >= __pyx_pybuffernd_newFront.diminfo[1].shape)) __pyx_t_43 = 1;
              if (unlikely(__pyx_t_43 != -1)) {
                <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_43);
               <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              }
              *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_newFront.rcbuffer->pybuffer.buf, __pyx_t_41, __pyx_pybuffernd_newFront.diminfo[0].strides, __pyx_t_42, __pyx_pybuffernd_newFront.diminfo[1].strides) = __pyx_v_ny;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line315")'> 315:                             front_counter = front_counter + 1</pre>
<pre id='line315' class='code' style='background-color: #FFFFff'>
              /* "epitopsy/cython/dx_cython.pyx":315
 *                             newFront[front_counter,0] = nx
 *                             newFront[front_counter,1] = ny
 *                             front_counter = front_counter + 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if water_counter > 0:
 *                 water_counter = front_counter
 */
              __pyx_v_front_counter = (__pyx_v_front_counter + 1);
              goto __pyx_L13;
            }
            __pyx_L13:;
            goto __pyx_L12;
          }
          __pyx_L12:;
        }
      }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line316")'> 316:             if water_counter &gt; 0:</pre>
<pre id='line316' class='code' style='background-color: #FFFFff'>
      /* "epitopsy/cython/dx_cython.pyx":316
 *                             newFront[front_counter,1] = ny
 *                             front_counter = front_counter + 1
 *             if water_counter > 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 water_counter = front_counter
 *                 waterFront[0:water_counter,:] = newFront[0:water_counter,:]
 */
      __pyx_t_30 = ((__pyx_v_water_counter > 0) != 0);
      if (__pyx_t_30) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line317")'> 317:                 water_counter = front_counter</pre>
<pre id='line317' class='code' style='background-color: #FFFFff'>
        /* "epitopsy/cython/dx_cython.pyx":317
 *                             front_counter = front_counter + 1
 *             if water_counter > 0:
 *                 water_counter = front_counter             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 waterFront[0:water_counter,:] = newFront[0:water_counter,:]
 * 
 */
        __pyx_v_water_counter = __pyx_v_front_counter;
</pre><pre class='line' style='background-color: #FFFF23' onclick='toggleDiv("line318")'> 318:                 waterFront[0:water_counter,:] = newFront[0:water_counter,:]</pre>
<pre id='line318' class='code' style='background-color: #FFFF23'>
        /* "epitopsy/cython/dx_cython.pyx":318
 *             if water_counter > 0:
 *                 water_counter = front_counter
 *                 waterFront[0:water_counter,:] = newFront[0:water_counter,:]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     for x in range(xdim):
 */
        __pyx_t_5 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_water_counter);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
        __pyx_t_2 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_0, __pyx_t_5, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_k_slice_55);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_k_slice_55);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_k_slice_55);
        __pyx_t_2 = 0;
        __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_newFront), ((PyObject *)__pyx_t_5));<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
        __pyx_t_5 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_water_counter);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
        __pyx_t_6 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_0, __pyx_t_5, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;

  /* "epitopsy/cython/dx_cython.pyx":318
 *             if water_counter > 0:
 *                 water_counter = front_counter
 *                 waterFront[0:water_counter,:] = newFront[0:water_counter,:]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     for x in range(xdim):
 */
  __pyx_k_slice_55 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_k_slice_55)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_slice_55);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_k_slice_55);
        __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_k_slice_56);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_k_slice_56);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_k_slice_56);
        __pyx_t_6 = 0;
        if (<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_waterFront), ((PyObject *)__pyx_t_5), __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        goto __pyx_L14;
      }
      __pyx_L14:;
    }
  }
  __pyx_k_slice_56 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_k_slice_56)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_slice_56);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_k_slice_56);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line319")'> 319: </pre>
<pre id='line319' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line320")'> 320:     for x in range(xdim):</pre>
<pre id='line320' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":320
 *                 waterFront[0:water_counter,:] = newFront[0:water_counter,:]
 * 
 *     for x in range(xdim):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for y in range(ydim):
 *             for z in range(zdim):
 */
  __pyx_t_9 = __pyx_v_xdim;
  for (__pyx_t_10 = 0; __pyx_t_10 <code><</code> __pyx_t_9; __pyx_t_10+=1) {
    __pyx_v_x = __pyx_t_10;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line321")'> 321:         for y in range(ydim):</pre>
<pre id='line321' class='code' style='background-color: #FFFFff'>
    /* "epitopsy/cython/dx_cython.pyx":321
 * 
 *     for x in range(xdim):
 *         for y in range(ydim):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for z in range(zdim):
 *                 if box[x,y,z] == temp_value:
 */
    __pyx_t_15 = __pyx_v_ydim;
    for (__pyx_t_24 = 0; __pyx_t_24 <code><</code> __pyx_t_15; __pyx_t_24+=1) {
      __pyx_v_y = __pyx_t_24;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line322")'> 322:             for z in range(zdim):</pre>
<pre id='line322' class='code' style='background-color: #FFFFff'>
      /* "epitopsy/cython/dx_cython.pyx":322
 *     for x in range(xdim):
 *         for y in range(ydim):
 *             for z in range(zdim):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 if box[x,y,z] == temp_value:
 *                     # this should be the solvent
 */
      __pyx_t_43 = __pyx_v_zdim;
      for (__pyx_t_44 = 0; __pyx_t_44 <code><</code> __pyx_t_43; __pyx_t_44+=1) {
        __pyx_v_z = __pyx_t_44;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line323")'> 323:                 if box[x,y,z] == temp_value:</pre>
<pre id='line323' class='code' style='background-color: #FFFFd4'>
        /* "epitopsy/cython/dx_cython.pyx":323
 *         for y in range(ydim):
 *             for z in range(zdim):
 *                 if box[x,y,z] == temp_value:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     # this should be the solvent
 *                     box[x,y,z] = solventScore
 */
        __pyx_t_45 = __pyx_v_x;
        __pyx_t_46 = __pyx_v_y;
        __pyx_t_47 = __pyx_v_z;
        __pyx_t_48 = -1;
        if (__pyx_t_45 <code><</code> 0) {
          __pyx_t_45 += __pyx_v_box.shape[0];
          if (unlikely(__pyx_t_45 <code><</code> 0)) __pyx_t_48 = 0;
        } else if (unlikely(__pyx_t_45 >= __pyx_v_box.shape[0])) __pyx_t_48 = 0;
        if (__pyx_t_46 <code><</code> 0) {
          __pyx_t_46 += __pyx_v_box.shape[1];
          if (unlikely(__pyx_t_46 <code><</code> 0)) __pyx_t_48 = 1;
        } else if (unlikely(__pyx_t_46 >= __pyx_v_box.shape[1])) __pyx_t_48 = 1;
        if (__pyx_t_47 <code><</code> 0) {
          __pyx_t_47 += __pyx_v_box.shape[2];
          if (unlikely(__pyx_t_47 <code><</code> 0)) __pyx_t_48 = 2;
        } else if (unlikely(__pyx_t_47 >= __pyx_v_box.shape[2])) __pyx_t_48 = 2;
        if (unlikely(__pyx_t_48 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_48);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 323; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_30 = (((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_45 * __pyx_v_box.strides[0]) ) + __pyx_t_46 * __pyx_v_box.strides[1]) ) + __pyx_t_47 * __pyx_v_box.strides[2]) ))) == __pyx_v_temp_value) != 0);
        if (__pyx_t_30) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line324")'> 324:                     # this should be the solvent</pre>
<pre id='line324' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line325")'> 325:                     box[x,y,z] = solventScore</pre>
<pre id='line325' class='code' style='background-color: #FFFFd4'>
          /* "epitopsy/cython/dx_cython.pyx":325
 *                 if box[x,y,z] == temp_value:
 *                     # this should be the solvent
 *                     box[x,y,z] = solventScore             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 else:
 *                     # this is all protein
 */
          __pyx_t_48 = __pyx_v_x;
          __pyx_t_49 = __pyx_v_y;
          __pyx_t_50 = __pyx_v_z;
          __pyx_t_51 = -1;
          if (__pyx_t_48 <code><</code> 0) {
            __pyx_t_48 += __pyx_v_box.shape[0];
            if (unlikely(__pyx_t_48 <code><</code> 0)) __pyx_t_51 = 0;
          } else if (unlikely(__pyx_t_48 >= __pyx_v_box.shape[0])) __pyx_t_51 = 0;
          if (__pyx_t_49 <code><</code> 0) {
            __pyx_t_49 += __pyx_v_box.shape[1];
            if (unlikely(__pyx_t_49 <code><</code> 0)) __pyx_t_51 = 1;
          } else if (unlikely(__pyx_t_49 >= __pyx_v_box.shape[1])) __pyx_t_51 = 1;
          if (__pyx_t_50 <code><</code> 0) {
            __pyx_t_50 += __pyx_v_box.shape[2];
            if (unlikely(__pyx_t_50 <code><</code> 0)) __pyx_t_51 = 2;
          } else if (unlikely(__pyx_t_50 >= __pyx_v_box.shape[2])) __pyx_t_51 = 2;
          if (unlikely(__pyx_t_51 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_51);
           <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_48 * __pyx_v_box.strides[0]) ) + __pyx_t_49 * __pyx_v_box.strides[1]) ) + __pyx_t_50 * __pyx_v_box.strides[2]) )) = __pyx_v_solventScore;
          goto __pyx_L21;
        }
        /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line326")'> 326:                 else:</pre>
<pre id='line326' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line327")'> 327:                     # this is all protein</pre>
<pre id='line327' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line328")'> 328:                     box[x,y,z] = peptideScore</pre>
<pre id='line328' class='code' style='background-color: #FFFFd4'>
          /* "epitopsy/cython/dx_cython.pyx":328
 *                 else:
 *                     # this is all protein
 *                     box[x,y,z] = peptideScore             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     return box_np
 */
          __pyx_t_51 = __pyx_v_x;
          __pyx_t_52 = __pyx_v_y;
          __pyx_t_53 = __pyx_v_z;
          __pyx_t_54 = -1;
          if (__pyx_t_51 <code><</code> 0) {
            __pyx_t_51 += __pyx_v_box.shape[0];
            if (unlikely(__pyx_t_51 <code><</code> 0)) __pyx_t_54 = 0;
          } else if (unlikely(__pyx_t_51 >= __pyx_v_box.shape[0])) __pyx_t_54 = 0;
          if (__pyx_t_52 <code><</code> 0) {
            __pyx_t_52 += __pyx_v_box.shape[1];
            if (unlikely(__pyx_t_52 <code><</code> 0)) __pyx_t_54 = 1;
          } else if (unlikely(__pyx_t_52 >= __pyx_v_box.shape[1])) __pyx_t_54 = 1;
          if (__pyx_t_53 <code><</code> 0) {
            __pyx_t_53 += __pyx_v_box.shape[2];
            if (unlikely(__pyx_t_53 <code><</code> 0)) __pyx_t_54 = 2;
          } else if (unlikely(__pyx_t_53 >= __pyx_v_box.shape[2])) __pyx_t_54 = 2;
          if (unlikely(__pyx_t_54 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_54);
           <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_51 * __pyx_v_box.strides[0]) ) + __pyx_t_52 * __pyx_v_box.strides[1]) ) + __pyx_t_53 * __pyx_v_box.strides[2]) )) = __pyx_v_peptideScore;
        }
        __pyx_L21:;
      }
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line329")'> 329: </pre>
<pre id='line329' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF1a' onclick='toggleDiv("line330")'> 330:     return box_np</pre>
<pre id='line330' class='code' style='background-color: #FFFF1a'>
  /* "epitopsy/cython/dx_cython.pyx":330
 *                     box[x,y,z] = peptideScore
 * 
 *     return box_np             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_box_np));
  __pyx_r = ((PyObject *)__pyx_v_box_np);
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&__pyx_t_1, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&__pyx_type, &__pyx_value, &__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box_np.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_neighbors.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_newFront.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_waterFront.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython.floodxy", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box_np.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_neighbors.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_newFront.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_waterFront.rcbuffer->pybuffer);
  __pyx_L2:;
  __PYX_XDEC_MEMVIEW(&__pyx_v_box, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_waterFront);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_newFront);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_8epitopsy_6cython_9dx_cython_11get_sas(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_8epitopsy_6cython_9dx_cython_11get_sas = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("get_sas"), (PyCFunction)__pyx_pw_8epitopsy_6cython_9dx_cython_11get_sas, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_8epitopsy_6cython_9dx_cython_11get_sas(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_box = 0;
  PyObject *__pyx_v_protein_score = 0;
  PyObject *__pyx_v_solvent_score = 0;
  PyObject *__pyx_v_probe_radius = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_sas (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__box,&__pyx_n_s__protein_score,&__pyx_n_s__solvent_score,&__pyx_n_s__probe_radius,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__box)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__protein_score)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_sas", 1, 4, 4, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__solvent_score)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_sas", 1, 4, 4, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__probe_radius)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_sas", 1, 4, 4, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_sas") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_box = ((PyArrayObject *)values[0]);
    __pyx_v_protein_score = values[1];
    __pyx_v_solvent_score = values[2];
    __pyx_v_probe_radius = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_sas", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython.get_sas", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_box), __pyx_ptype_5numpy_ndarray, 1, "box", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_8epitopsy_6cython_9dx_cython_10get_sas(__pyx_self, __pyx_v_box, __pyx_v_protein_score, __pyx_v_solvent_score, __pyx_v_probe_radius);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line331")'> 331: </pre>
<pre id='line331' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line332")'> 332: </pre>
<pre id='line332' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line333")'> 333: def get_sas(np.ndarray[np.float64_t, ndim=3] box,</pre>
<pre id='line333' class='code' style='background-color: #FFFF5b'>
/* "epitopsy/cython/dx_cython.pyx":333
 * 
 * 
 * def get_sas(np.ndarray[np.float64_t, ndim=3] box,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         protein_score, solvent_score, probe_radius):
 *     return _get_sas(box, <code><</code>float> protein_score, <code><</code>float> solvent_score,
 */

static PyObject *__pyx_pf_8epitopsy_6cython_9dx_cython_10get_sas(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_box, PyObject *__pyx_v_protein_score, PyObject *__pyx_v_solvent_score, PyObject *__pyx_v_probe_radius) {
  __Pyx_LocalBuf_ND __pyx_pybuffernd_box;
  __Pyx_Buffer __pyx_pybuffer_box;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_sas", 0);
  __pyx_pybuffer_box.pybuffer.buf = NULL;
  __pyx_pybuffer_box.refcount = 0;
  __pyx_pybuffernd_box.data = NULL;
  __pyx_pybuffernd_box.rcbuffer = &__pyx_pybuffer_box;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer, (PyObject*)__pyx_v_box, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_box.diminfo[0].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_box.diminfo[0].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_box.diminfo[1].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_box.diminfo[1].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_box.diminfo[2].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_box.diminfo[2].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[2];

  /* "epitopsy/cython/dx_cython.pyx":333
 * 
 * 
 * def get_sas(np.ndarray[np.float64_t, ndim=3] box,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         protein_score, solvent_score, probe_radius):
 *     return _get_sas(box, <code><</code>float> protein_score, <code><</code>float> solvent_score,
 */
  __pyx_k_tuple_119 = <span class='py_c_api'>PyTuple_Pack</span>(4, ((PyObject *)__pyx_n_s__box), ((PyObject *)__pyx_n_s__protein_score), ((PyObject *)__pyx_n_s__solvent_score), ((PyObject *)__pyx_n_s__probe_radius));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_119)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_119);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_119));

  /* "epitopsy/cython/dx_cython.pyx":333
 * 
 * 
 * def get_sas(np.ndarray[np.float64_t, ndim=3] box,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         protein_score, solvent_score, probe_radius):
 *     return _get_sas(box, <code><</code>float> protein_score, <code><</code>float> solvent_score,
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_8epitopsy_6cython_9dx_cython_11get_sas, NULL, __pyx_n_s_110);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__get_sas, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_120 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(4, 0, 4, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_119, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_109, __pyx_n_s__get_sas, 333, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_120)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line334")'> 334:         protein_score, solvent_score, probe_radius):</pre>
<pre id='line334' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF52' onclick='toggleDiv("line335")'> 335:     return _get_sas(box, &lt;float&gt; protein_score, &lt;float&gt; solvent_score,</pre>
<pre id='line335' class='code' style='background-color: #FFFF52'>
  /* "epitopsy/cython/dx_cython.pyx":335
 * def get_sas(np.ndarray[np.float64_t, ndim=3] box,
 *         protein_score, solvent_score, probe_radius):
 *     return _get_sas(box, <code><</code>float> protein_score, <code><</code>float> solvent_score,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     <code><</code>float> probe_radius)
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_protein_score);<span class='error_goto'> if (unlikely((__pyx_t_1 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_solvent_score);<span class='error_goto'> if (unlikely((__pyx_t_2 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line336")'> 336:                     &lt;float&gt; probe_radius)</pre>
<pre id='line336' class='code' style='background-color: #FFFF4d'>
  /* "epitopsy/cython/dx_cython.pyx":336
 *         protein_score, solvent_score, probe_radius):
 *     return _get_sas(box, <code><</code>float> protein_score, <code><</code>float> solvent_score,
 *                     <code><</code>float> probe_radius)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef np.ndarray _get_sas(np.ndarray[np.float64_t, ndim=3] box,
 */
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_probe_radius);<span class='error_goto'> if (unlikely((__pyx_t_3 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = ((PyObject *)__pyx_f_8epitopsy_6cython_9dx_cython__get_sas(((PyArrayObject *)__pyx_v_box), ((float)__pyx_t_1), ((float)__pyx_t_2), ((float)__pyx_t_3)));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&__pyx_type, &__pyx_value, &__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython.get_sas", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line337")'> 337: </pre>
<pre id='line337' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line338")'> 338: cdef np.ndarray _get_sas(np.ndarray[np.float64_t, ndim=3] box,</pre>
<pre id='line338' class='code' style='background-color: #FFFFd4'>
/* "epitopsy/cython/dx_cython.pyx":338
 *                     <code><</code>float> probe_radius)
 * 
 * cdef np.ndarray _get_sas(np.ndarray[np.float64_t, ndim=3] box,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         float protein_score, float solvent_score, float probe_radius):
 *     cdef int xdim = box.shape[0]
 */

static PyArrayObject *__pyx_f_8epitopsy_6cython_9dx_cython__get_sas(PyArrayObject *__pyx_v_box, float __pyx_v_protein_score, float __pyx_v_solvent_score, float __pyx_v_probe_radius) {
  int __pyx_v_xdim;
  int __pyx_v_ydim;
  int __pyx_v_zdim;
  PyObject *__pyx_v_neighbors_list = 0;
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_k;
  int __pyx_v_n;
  int __pyx_v_x;
  int __pyx_v_y;
  int __pyx_v_z;
  int __pyx_v_nx;
  int __pyx_v_ny;
  int __pyx_v_nz;
  int __pyx_v_probe_int;
  float __pyx_v_temp_score;
  float __pyx_v_surface_score;
  PyArrayObject *__pyx_v_neighbors = 0;
  int __pyx_v_neighbor_elements;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_box;
  __Pyx_Buffer __pyx_pybuffer_box;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_neighbors;
  __Pyx_Buffer __pyx_pybuffer_neighbors;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_get_sas", 0);
  __pyx_pybuffer_neighbors.pybuffer.buf = NULL;
  __pyx_pybuffer_neighbors.refcount = 0;
  __pyx_pybuffernd_neighbors.data = NULL;
  __pyx_pybuffernd_neighbors.rcbuffer = &__pyx_pybuffer_neighbors;
  __pyx_pybuffer_box.pybuffer.buf = NULL;
  __pyx_pybuffer_box.refcount = 0;
  __pyx_pybuffernd_box.data = NULL;
  __pyx_pybuffernd_box.rcbuffer = &__pyx_pybuffer_box;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer, (PyObject*)__pyx_v_box, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 3, 0, __pyx_stack) == -1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_box.diminfo[0].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_box.diminfo[0].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_box.diminfo[1].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_box.diminfo[1].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_box.diminfo[2].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_box.diminfo[2].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[2];
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line339")'> 339:         float protein_score, float solvent_score, float probe_radius):</pre>
<pre id='line339' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line340")'> 340:     cdef int xdim = box.shape[0]</pre>
<pre id='line340' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":340
 * cdef np.ndarray _get_sas(np.ndarray[np.float64_t, ndim=3] box,
 *         float protein_score, float solvent_score, float probe_radius):
 *     cdef int xdim = box.shape[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int ydim = box.shape[1]
 *     cdef int zdim = box.shape[2]
 */
  __pyx_v_xdim = (__pyx_v_box->dimensions[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line341")'> 341:     cdef int ydim = box.shape[1]</pre>
<pre id='line341' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":341
 *         float protein_score, float solvent_score, float probe_radius):
 *     cdef int xdim = box.shape[0]
 *     cdef int ydim = box.shape[1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int zdim = box.shape[2]
 *     cdef list neighbors_list = []
 */
  __pyx_v_ydim = (__pyx_v_box->dimensions[1]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line342")'> 342:     cdef int zdim = box.shape[2]</pre>
<pre id='line342' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":342
 *     cdef int xdim = box.shape[0]
 *     cdef int ydim = box.shape[1]
 *     cdef int zdim = box.shape[2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef list neighbors_list = []
 *     cdef int i,j,k, n
 */
  __pyx_v_zdim = (__pyx_v_box->dimensions[2]);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line343")'> 343:     cdef list neighbors_list = []</pre>
<pre id='line343' class='code' style='background-color: #FFFFaa'>
  /* "epitopsy/cython/dx_cython.pyx":343
 *     cdef int ydim = box.shape[1]
 *     cdef int zdim = box.shape[2]
 *     cdef list neighbors_list = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int i,j,k, n
 *     cdef int x,y,z
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 343; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_neighbors_list = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line344")'> 344:     cdef int i,j,k, n</pre>
<pre id='line344' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line345")'> 345:     cdef int x,y,z</pre>
<pre id='line345' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line346")'> 346:     cdef int nx,ny,nz</pre>
<pre id='line346' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line347")'> 347:     cdef int probe_int = int(round(probe_radius))</pre>
<pre id='line347' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":347
 *     cdef int x,y,z
 *     cdef int nx,ny,nz
 *     cdef int probe_int = int(round(probe_radius))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef float temp_score = -10
 *     cdef float surface_score = -11
 */
  __pyx_v_probe_int = ((int)round(__pyx_v_probe_radius));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line348")'> 348:     cdef float temp_score = -10</pre>
<pre id='line348' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":348
 *     cdef int nx,ny,nz
 *     cdef int probe_int = int(round(probe_radius))
 *     cdef float temp_score = -10             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef float surface_score = -11
 *     for i from -probe_int <code><</code>= i <code><</code>= probe_int:
 */
  __pyx_v_temp_score = -10.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line349")'> 349:     cdef float surface_score = -11</pre>
<pre id='line349' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":349
 *     cdef int probe_int = int(round(probe_radius))
 *     cdef float temp_score = -10
 *     cdef float surface_score = -11             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     for i from -probe_int <code><</code>= i <code><</code>= probe_int:
 *         for j from -probe_int <code><</code>= j <code><</code>= probe_int:
 */
  __pyx_v_surface_score = -11.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line350")'> 350:     for i from -probe_int &lt;= i &lt;= probe_int:</pre>
<pre id='line350' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":350
 *     cdef float temp_score = -10
 *     cdef float surface_score = -11
 *     for i from -probe_int <code><</code>= i <code><</code>= probe_int:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for j from -probe_int <code><</code>= j <code><</code>= probe_int:
 *             for k from -probe_int <code><</code>= k <code><</code>= probe_int:
 */
  __pyx_t_2 = __pyx_v_probe_int;
  for (__pyx_v_i = (-__pyx_v_probe_int); __pyx_v_i <code><</code>= __pyx_t_2; __pyx_v_i++) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line351")'> 351:         for j from -probe_int &lt;= j &lt;= probe_int:</pre>
<pre id='line351' class='code' style='background-color: #FFFFff'>
    /* "epitopsy/cython/dx_cython.pyx":351
 *     cdef float surface_score = -11
 *     for i from -probe_int <code><</code>= i <code><</code>= probe_int:
 *         for j from -probe_int <code><</code>= j <code><</code>= probe_int:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for k from -probe_int <code><</code>= k <code><</code>= probe_int:
 *                 if i == 0 and j == 0 and k ==0:
 */
    __pyx_t_3 = __pyx_v_probe_int;
    for (__pyx_v_j = (-__pyx_v_probe_int); __pyx_v_j <code><</code>= __pyx_t_3; __pyx_v_j++) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line352")'> 352:             for k from -probe_int &lt;= k &lt;= probe_int:</pre>
<pre id='line352' class='code' style='background-color: #FFFFff'>
      /* "epitopsy/cython/dx_cython.pyx":352
 *     for i from -probe_int <code><</code>= i <code><</code>= probe_int:
 *         for j from -probe_int <code><</code>= j <code><</code>= probe_int:
 *             for k from -probe_int <code><</code>= k <code><</code>= probe_int:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 if i == 0 and j == 0 and k ==0:
 *                     continue
 */
      __pyx_t_4 = __pyx_v_probe_int;
      for (__pyx_v_k = (-__pyx_v_probe_int); __pyx_v_k <code><</code>= __pyx_t_4; __pyx_v_k++) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line353")'> 353:                 if i == 0 and j == 0 and k ==0:</pre>
<pre id='line353' class='code' style='background-color: #FFFFff'>
        /* "epitopsy/cython/dx_cython.pyx":353
 *         for j from -probe_int <code><</code>= j <code><</code>= probe_int:
 *             for k from -probe_int <code><</code>= k <code><</code>= probe_int:
 *                 if i == 0 and j == 0 and k ==0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     continue
 *                 else:
 */
        __pyx_t_5 = ((__pyx_v_i == 0) != 0);
        if (__pyx_t_5) {
          __pyx_t_6 = ((__pyx_v_j == 0) != 0);
          if (__pyx_t_6) {
            __pyx_t_7 = ((__pyx_v_k == 0) != 0);
            __pyx_t_8 = __pyx_t_7;
          } else {
            __pyx_t_8 = __pyx_t_6;
          }
          __pyx_t_6 = __pyx_t_8;
        } else {
          __pyx_t_6 = __pyx_t_5;
        }
        if (__pyx_t_6) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line354")'> 354:                     continue</pre>
<pre id='line354' class='code' style='background-color: #FFFFff'>
          /* "epitopsy/cython/dx_cython.pyx":354
 *             for k from -probe_int <code><</code>= k <code><</code>= probe_int:
 *                 if i == 0 and j == 0 and k ==0:
 *                     continue             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 else:
 *                     if _vec_distance(i,j,k,0,0,0) <code><</code>= probe_radius:
 */
          goto __pyx_L7_continue;
          goto __pyx_L9;
        }
        /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line355")'> 355:                 else:</pre>
<pre id='line355' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line356")'> 356:                     if _vec_distance(i,j,k,0,0,0) &lt;= probe_radius:</pre>
<pre id='line356' class='code' style='background-color: #FFFFff'>
          /* "epitopsy/cython/dx_cython.pyx":356
 *                     continue
 *                 else:
 *                     if _vec_distance(i,j,k,0,0,0) <code><</code>= probe_radius:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         neighbors_list.append([i,j,k])
 * 
 */
          __pyx_t_6 = ((__pyx_f_8epitopsy_6cython_9dx_cython__vec_distance(__pyx_v_i, __pyx_v_j, __pyx_v_k, 0, 0, 0) <code><</code>= __pyx_v_probe_radius) != 0);
          if (__pyx_t_6) {
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line357")'> 357:                         neighbors_list.append([i,j,k])</pre>
<pre id='line357' class='code' style='background-color: #FFFF41'>
            /* "epitopsy/cython/dx_cython.pyx":357
 *                 else:
 *                     if _vec_distance(i,j,k,0,0,0) <code><</code>= probe_radius:
 *                         neighbors_list.append([i,j,k])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef np.ndarray[np.int64_t, ndim=2] neighbors = np.array(neighbors_list, dtype=np.int64)
 */
            __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 357; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
            __pyx_t_9 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_j);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 357; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
            __pyx_t_10 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 357; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
            __pyx_t_11 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 357; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
            <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_1);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
            <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_11, 1, __pyx_t_9);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_9);
            <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_11, 2, __pyx_t_10);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_10);
            __pyx_t_1 = 0;
            __pyx_t_9 = 0;
            __pyx_t_10 = 0;
            __pyx_t_12 = __Pyx_<span class='py_c_api'>PyList_Append</span>(__pyx_v_neighbors_list, ((PyObject *)__pyx_t_11));<span class='error_goto'> if (unlikely(__pyx_t_12 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 357; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_11)); __pyx_t_11 = 0;
            goto __pyx_L10;
          }
          __pyx_L10:;
        }
        __pyx_L9:;
        __pyx_L7_continue:;
      }
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line358")'> 358: </pre>
<pre id='line358' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2c' onclick='toggleDiv("line359")'> 359:     cdef np.ndarray[np.int64_t, ndim=2] neighbors = np.array(neighbors_list, dtype=np.int64)</pre>
<pre id='line359' class='code' style='background-color: #FFFF2c'>
  /* "epitopsy/cython/dx_cython.pyx":359
 *                         neighbors_list.append([i,j,k])
 * 
 *     cdef np.ndarray[np.int64_t, ndim=2] neighbors = np.array(neighbors_list, dtype=np.int64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int neighbor_elements = neighbors.shape[0]
 * 
 */
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
  __pyx_t_10 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s__array);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_neighbors_list));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, ((PyObject *)__pyx_v_neighbors_list));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_neighbors_list));
  __pyx_t_9 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_9));
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_13 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__int64);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, ((PyObject *)__pyx_n_s__dtype), __pyx_t_13) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  __pyx_t_13 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_10, ((PyObject *)__pyx_t_11), ((PyObject *)__pyx_t_9));<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_11)); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_9)); __pyx_t_9 = 0;
  if (!(likely(((__pyx_t_13) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_13, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_14 = ((PyArrayObject *)__pyx_t_13);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_neighbors.rcbuffer->pybuffer, (PyObject*)__pyx_t_14, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_neighbors = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.buf = NULL;
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_neighbors.diminfo[0].strides = __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_neighbors.diminfo[0].shape = __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_neighbors.diminfo[1].strides = __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_neighbors.diminfo[1].shape = __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_14 = 0;
  __pyx_v_neighbors = ((PyArrayObject *)__pyx_t_13);
  __pyx_t_13 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line360")'> 360:     cdef int neighbor_elements = neighbors.shape[0]</pre>
<pre id='line360' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":360
 * 
 *     cdef np.ndarray[np.int64_t, ndim=2] neighbors = np.array(neighbors_list, dtype=np.int64)
 *     cdef int neighbor_elements = neighbors.shape[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     for x in range(xdim):
 */
  __pyx_v_neighbor_elements = (__pyx_v_neighbors->dimensions[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line361")'> 361: </pre>
<pre id='line361' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line362")'> 362:     for x in range(xdim):</pre>
<pre id='line362' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":362
 *     cdef int neighbor_elements = neighbors.shape[0]
 * 
 *     for x in range(xdim):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for y in range(ydim):
 *             for z in range(zdim):
 */
  __pyx_t_2 = __pyx_v_xdim;
  for (__pyx_t_3 = 0; __pyx_t_3 <code><</code> __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_x = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line363")'> 363:         for y in range(ydim):</pre>
<pre id='line363' class='code' style='background-color: #FFFFff'>
    /* "epitopsy/cython/dx_cython.pyx":363
 * 
 *     for x in range(xdim):
 *         for y in range(ydim):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for z in range(zdim):
 *                 if box[x,y,z] == solvent_score:
 */
    __pyx_t_4 = __pyx_v_ydim;
    for (__pyx_t_15 = 0; __pyx_t_15 <code><</code> __pyx_t_4; __pyx_t_15+=1) {
      __pyx_v_y = __pyx_t_15;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line364")'> 364:             for z in range(zdim):</pre>
<pre id='line364' class='code' style='background-color: #FFFFff'>
      /* "epitopsy/cython/dx_cython.pyx":364
 *     for x in range(xdim):
 *         for y in range(ydim):
 *             for z in range(zdim):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 if box[x,y,z] == solvent_score:
 *                     # assume that this is a valid solvent grid point
 */
      __pyx_t_16 = __pyx_v_zdim;
      for (__pyx_t_17 = 0; __pyx_t_17 <code><</code> __pyx_t_16; __pyx_t_17+=1) {
        __pyx_v_z = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line365")'> 365:                 if box[x,y,z] == solvent_score:</pre>
<pre id='line365' class='code' style='background-color: #FFFFd4'>
        /* "epitopsy/cython/dx_cython.pyx":365
 *         for y in range(ydim):
 *             for z in range(zdim):
 *                 if box[x,y,z] == solvent_score:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     # assume that this is a valid solvent grid point
 *                     box[x,y,z] = temp_score
 */
        __pyx_t_18 = __pyx_v_x;
        __pyx_t_19 = __pyx_v_y;
        __pyx_t_20 = __pyx_v_z;
        __pyx_t_21 = -1;
        if (__pyx_t_18 <code><</code> 0) {
          __pyx_t_18 += __pyx_pybuffernd_box.diminfo[0].shape;
          if (unlikely(__pyx_t_18 <code><</code> 0)) __pyx_t_21 = 0;
        } else if (unlikely(__pyx_t_18 >= __pyx_pybuffernd_box.diminfo[0].shape)) __pyx_t_21 = 0;
        if (__pyx_t_19 <code><</code> 0) {
          __pyx_t_19 += __pyx_pybuffernd_box.diminfo[1].shape;
          if (unlikely(__pyx_t_19 <code><</code> 0)) __pyx_t_21 = 1;
        } else if (unlikely(__pyx_t_19 >= __pyx_pybuffernd_box.diminfo[1].shape)) __pyx_t_21 = 1;
        if (__pyx_t_20 <code><</code> 0) {
          __pyx_t_20 += __pyx_pybuffernd_box.diminfo[2].shape;
          if (unlikely(__pyx_t_20 <code><</code> 0)) __pyx_t_21 = 2;
        } else if (unlikely(__pyx_t_20 >= __pyx_pybuffernd_box.diminfo[2].shape)) __pyx_t_21 = 2;
        if (unlikely(__pyx_t_21 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_6 = (((*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_19, __pyx_pybuffernd_box.diminfo[1].strides, __pyx_t_20, __pyx_pybuffernd_box.diminfo[2].strides)) == __pyx_v_solvent_score) != 0);
        if (__pyx_t_6) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line366")'> 366:                     # assume that this is a valid solvent grid point</pre>
<pre id='line366' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line367")'> 367:                     box[x,y,z] = temp_score</pre>
<pre id='line367' class='code' style='background-color: #FFFFd4'>
          /* "epitopsy/cython/dx_cython.pyx":367
 *                 if box[x,y,z] == solvent_score:
 *                     # assume that this is a valid solvent grid point
 *                     box[x,y,z] = temp_score             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     # check neighbors, if they are also solvent
 *                     for n in range(neighbor_elements):
 */
          __pyx_t_21 = __pyx_v_x;
          __pyx_t_22 = __pyx_v_y;
          __pyx_t_23 = __pyx_v_z;
          __pyx_t_24 = -1;
          if (__pyx_t_21 <code><</code> 0) {
            __pyx_t_21 += __pyx_pybuffernd_box.diminfo[0].shape;
            if (unlikely(__pyx_t_21 <code><</code> 0)) __pyx_t_24 = 0;
          } else if (unlikely(__pyx_t_21 >= __pyx_pybuffernd_box.diminfo[0].shape)) __pyx_t_24 = 0;
          if (__pyx_t_22 <code><</code> 0) {
            __pyx_t_22 += __pyx_pybuffernd_box.diminfo[1].shape;
            if (unlikely(__pyx_t_22 <code><</code> 0)) __pyx_t_24 = 1;
          } else if (unlikely(__pyx_t_22 >= __pyx_pybuffernd_box.diminfo[1].shape)) __pyx_t_24 = 1;
          if (__pyx_t_23 <code><</code> 0) {
            __pyx_t_23 += __pyx_pybuffernd_box.diminfo[2].shape;
            if (unlikely(__pyx_t_23 <code><</code> 0)) __pyx_t_24 = 2;
          } else if (unlikely(__pyx_t_23 >= __pyx_pybuffernd_box.diminfo[2].shape)) __pyx_t_24 = 2;
          if (unlikely(__pyx_t_24 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_24);
           <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 367; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_box.diminfo[1].strides, __pyx_t_23, __pyx_pybuffernd_box.diminfo[2].strides) = __pyx_v_temp_score;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line368")'> 368:                     # check neighbors, if they are also solvent</pre>
<pre id='line368' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line369")'> 369:                     for n in range(neighbor_elements):</pre>
<pre id='line369' class='code' style='background-color: #FFFFff'>
          /* "epitopsy/cython/dx_cython.pyx":369
 *                     box[x,y,z] = temp_score
 *                     # check neighbors, if they are also solvent
 *                     for n in range(neighbor_elements):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         nx = x + neighbors[n,0]
 *                         ny = y + neighbors[n,1]
 */
          __pyx_t_24 = __pyx_v_neighbor_elements;
          for (__pyx_t_25 = 0; __pyx_t_25 <code><</code> __pyx_t_24; __pyx_t_25+=1) {
            __pyx_v_n = __pyx_t_25;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line370")'> 370:                         nx = x + neighbors[n,0]</pre>
<pre id='line370' class='code' style='background-color: #FFFFd4'>
            /* "epitopsy/cython/dx_cython.pyx":370
 *                     # check neighbors, if they are also solvent
 *                     for n in range(neighbor_elements):
 *                         nx = x + neighbors[n,0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         ny = y + neighbors[n,1]
 *                         nz = z + neighbors[n,2]
 */
            __pyx_t_26 = __pyx_v_n;
            __pyx_t_27 = 0;
            __pyx_t_28 = -1;
            if (__pyx_t_26 <code><</code> 0) {
              __pyx_t_26 += __pyx_pybuffernd_neighbors.diminfo[0].shape;
              if (unlikely(__pyx_t_26 <code><</code> 0)) __pyx_t_28 = 0;
            } else if (unlikely(__pyx_t_26 >= __pyx_pybuffernd_neighbors.diminfo[0].shape)) __pyx_t_28 = 0;
            if (__pyx_t_27 <code><</code> 0) {
              __pyx_t_27 += __pyx_pybuffernd_neighbors.diminfo[1].shape;
              if (unlikely(__pyx_t_27 <code><</code> 0)) __pyx_t_28 = 1;
            } else if (unlikely(__pyx_t_27 >= __pyx_pybuffernd_neighbors.diminfo[1].shape)) __pyx_t_28 = 1;
            if (unlikely(__pyx_t_28 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_28);
             <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            __pyx_v_nx = (__pyx_v_x + (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.buf, __pyx_t_26, __pyx_pybuffernd_neighbors.diminfo[0].strides, __pyx_t_27, __pyx_pybuffernd_neighbors.diminfo[1].strides)));
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line371")'> 371:                         ny = y + neighbors[n,1]</pre>
<pre id='line371' class='code' style='background-color: #FFFFd4'>
            /* "epitopsy/cython/dx_cython.pyx":371
 *                     for n in range(neighbor_elements):
 *                         nx = x + neighbors[n,0]
 *                         ny = y + neighbors[n,1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         nz = z + neighbors[n,2]
 *                         if (nx >= 0 and nx <code><</code> xdim
 */
            __pyx_t_28 = __pyx_v_n;
            __pyx_t_29 = 1;
            __pyx_t_30 = -1;
            if (__pyx_t_28 <code><</code> 0) {
              __pyx_t_28 += __pyx_pybuffernd_neighbors.diminfo[0].shape;
              if (unlikely(__pyx_t_28 <code><</code> 0)) __pyx_t_30 = 0;
            } else if (unlikely(__pyx_t_28 >= __pyx_pybuffernd_neighbors.diminfo[0].shape)) __pyx_t_30 = 0;
            if (__pyx_t_29 <code><</code> 0) {
              __pyx_t_29 += __pyx_pybuffernd_neighbors.diminfo[1].shape;
              if (unlikely(__pyx_t_29 <code><</code> 0)) __pyx_t_30 = 1;
            } else if (unlikely(__pyx_t_29 >= __pyx_pybuffernd_neighbors.diminfo[1].shape)) __pyx_t_30 = 1;
            if (unlikely(__pyx_t_30 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_30);
             <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            __pyx_v_ny = (__pyx_v_y + (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.buf, __pyx_t_28, __pyx_pybuffernd_neighbors.diminfo[0].strides, __pyx_t_29, __pyx_pybuffernd_neighbors.diminfo[1].strides)));
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line372")'> 372:                         nz = z + neighbors[n,2]</pre>
<pre id='line372' class='code' style='background-color: #FFFFd4'>
            /* "epitopsy/cython/dx_cython.pyx":372
 *                         nx = x + neighbors[n,0]
 *                         ny = y + neighbors[n,1]
 *                         nz = z + neighbors[n,2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         if (nx >= 0 and nx <code><</code> xdim
 *                             and ny >= 0 and ny <code><</code> ydim
 */
            __pyx_t_30 = __pyx_v_n;
            __pyx_t_31 = 2;
            __pyx_t_32 = -1;
            if (__pyx_t_30 <code><</code> 0) {
              __pyx_t_30 += __pyx_pybuffernd_neighbors.diminfo[0].shape;
              if (unlikely(__pyx_t_30 <code><</code> 0)) __pyx_t_32 = 0;
            } else if (unlikely(__pyx_t_30 >= __pyx_pybuffernd_neighbors.diminfo[0].shape)) __pyx_t_32 = 0;
            if (__pyx_t_31 <code><</code> 0) {
              __pyx_t_31 += __pyx_pybuffernd_neighbors.diminfo[1].shape;
              if (unlikely(__pyx_t_31 <code><</code> 0)) __pyx_t_32 = 1;
            } else if (unlikely(__pyx_t_31 >= __pyx_pybuffernd_neighbors.diminfo[1].shape)) __pyx_t_32 = 1;
            if (unlikely(__pyx_t_32 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_32);
             <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 372; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            __pyx_v_nz = (__pyx_v_z + (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.buf, __pyx_t_30, __pyx_pybuffernd_neighbors.diminfo[0].strides, __pyx_t_31, __pyx_pybuffernd_neighbors.diminfo[1].strides)));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line373")'> 373:                         if (nx &gt;= 0 and nx &lt; xdim</pre>
<pre id='line373' class='code' style='background-color: #FFFFff'>
            /* "epitopsy/cython/dx_cython.pyx":373
 *                         ny = y + neighbors[n,1]
 *                         nz = z + neighbors[n,2]
 *                         if (nx >= 0 and nx <code><</code> xdim             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             and ny >= 0 and ny <code><</code> ydim
 *                             and nz >= 0 and nz <code><</code> zdim):
 */
            __pyx_t_6 = ((__pyx_v_nx >= 0) != 0);
            if (__pyx_t_6) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line374")'> 374:                             and ny &gt;= 0 and ny &lt; ydim</pre>
<pre id='line374' class='code' style='background-color: #FFFFff'>
              /* "epitopsy/cython/dx_cython.pyx":374
 *                         nz = z + neighbors[n,2]
 *                         if (nx >= 0 and nx <code><</code> xdim
 *                             and ny >= 0 and ny <code><</code> ydim             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             and nz >= 0 and nz <code><</code> zdim):
 *                             if box[nx,ny,nz] == protein_score:
 */
              __pyx_t_5 = ((__pyx_v_nx <code><</code> __pyx_v_xdim) != 0);
              if (__pyx_t_5) {
                __pyx_t_8 = ((__pyx_v_ny >= 0) != 0);
                if (__pyx_t_8) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line375")'> 375:                             and nz &gt;= 0 and nz &lt; zdim):</pre>
<pre id='line375' class='code' style='background-color: #FFFFff'>
                  /* "epitopsy/cython/dx_cython.pyx":375
 *                         if (nx >= 0 and nx <code><</code> xdim
 *                             and ny >= 0 and ny <code><</code> ydim
 *                             and nz >= 0 and nz <code><</code> zdim):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             if box[nx,ny,nz] == protein_score:
 *                                 # point of x,y,z is to close to the protein
 */
                  __pyx_t_7 = ((__pyx_v_ny <code><</code> __pyx_v_ydim) != 0);
                  if (__pyx_t_7) {
                    __pyx_t_33 = ((__pyx_v_nz >= 0) != 0);
                    if (__pyx_t_33) {
                      __pyx_t_34 = ((__pyx_v_nz <code><</code> __pyx_v_zdim) != 0);
                      __pyx_t_35 = __pyx_t_34;
                    } else {
                      __pyx_t_35 = __pyx_t_33;
                    }
                    __pyx_t_33 = __pyx_t_35;
                  } else {
                    __pyx_t_33 = __pyx_t_7;
                  }
                  __pyx_t_7 = __pyx_t_33;
                } else {
                  __pyx_t_7 = __pyx_t_8;
                }
                __pyx_t_8 = __pyx_t_7;
              } else {
                __pyx_t_8 = __pyx_t_5;
              }
              __pyx_t_5 = __pyx_t_8;
            } else {
              __pyx_t_5 = __pyx_t_6;
            }
            if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line376")'> 376:                             if box[nx,ny,nz] == protein_score:</pre>
<pre id='line376' class='code' style='background-color: #FFFFd4'>
              /* "epitopsy/cython/dx_cython.pyx":376
 *                             and ny >= 0 and ny <code><</code> ydim
 *                             and nz >= 0 and nz <code><</code> zdim):
 *                             if box[nx,ny,nz] == protein_score:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 # point of x,y,z is to close to the protein
 *                                 box[x,y,z] = surface_score
 */
              __pyx_t_32 = __pyx_v_nx;
              __pyx_t_36 = __pyx_v_ny;
              __pyx_t_37 = __pyx_v_nz;
              __pyx_t_38 = -1;
              if (__pyx_t_32 <code><</code> 0) {
                __pyx_t_32 += __pyx_pybuffernd_box.diminfo[0].shape;
                if (unlikely(__pyx_t_32 <code><</code> 0)) __pyx_t_38 = 0;
              } else if (unlikely(__pyx_t_32 >= __pyx_pybuffernd_box.diminfo[0].shape)) __pyx_t_38 = 0;
              if (__pyx_t_36 <code><</code> 0) {
                __pyx_t_36 += __pyx_pybuffernd_box.diminfo[1].shape;
                if (unlikely(__pyx_t_36 <code><</code> 0)) __pyx_t_38 = 1;
              } else if (unlikely(__pyx_t_36 >= __pyx_pybuffernd_box.diminfo[1].shape)) __pyx_t_38 = 1;
              if (__pyx_t_37 <code><</code> 0) {
                __pyx_t_37 += __pyx_pybuffernd_box.diminfo[2].shape;
                if (unlikely(__pyx_t_37 <code><</code> 0)) __pyx_t_38 = 2;
              } else if (unlikely(__pyx_t_37 >= __pyx_pybuffernd_box.diminfo[2].shape)) __pyx_t_38 = 2;
              if (unlikely(__pyx_t_38 != -1)) {
                <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_38);
               <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              }
              __pyx_t_5 = (((*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_32, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_36, __pyx_pybuffernd_box.diminfo[1].strides, __pyx_t_37, __pyx_pybuffernd_box.diminfo[2].strides)) == __pyx_v_protein_score) != 0);
              if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line377")'> 377:                                 # point of x,y,z is to close to the protein</pre>
<pre id='line377' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line378")'> 378:                                 box[x,y,z] = surface_score</pre>
<pre id='line378' class='code' style='background-color: #FFFFd4'>
                /* "epitopsy/cython/dx_cython.pyx":378
 *                             if box[nx,ny,nz] == protein_score:
 *                                 # point of x,y,z is to close to the protein
 *                                 box[x,y,z] = surface_score             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 break
 * 
 */
                __pyx_t_38 = __pyx_v_x;
                __pyx_t_39 = __pyx_v_y;
                __pyx_t_40 = __pyx_v_z;
                __pyx_t_41 = -1;
                if (__pyx_t_38 <code><</code> 0) {
                  __pyx_t_38 += __pyx_pybuffernd_box.diminfo[0].shape;
                  if (unlikely(__pyx_t_38 <code><</code> 0)) __pyx_t_41 = 0;
                } else if (unlikely(__pyx_t_38 >= __pyx_pybuffernd_box.diminfo[0].shape)) __pyx_t_41 = 0;
                if (__pyx_t_39 <code><</code> 0) {
                  __pyx_t_39 += __pyx_pybuffernd_box.diminfo[1].shape;
                  if (unlikely(__pyx_t_39 <code><</code> 0)) __pyx_t_41 = 1;
                } else if (unlikely(__pyx_t_39 >= __pyx_pybuffernd_box.diminfo[1].shape)) __pyx_t_41 = 1;
                if (__pyx_t_40 <code><</code> 0) {
                  __pyx_t_40 += __pyx_pybuffernd_box.diminfo[2].shape;
                  if (unlikely(__pyx_t_40 <code><</code> 0)) __pyx_t_41 = 2;
                } else if (unlikely(__pyx_t_40 >= __pyx_pybuffernd_box.diminfo[2].shape)) __pyx_t_41 = 2;
                if (unlikely(__pyx_t_41 != -1)) {
                  <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_41);
                 <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                }
                *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_38, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_39, __pyx_pybuffernd_box.diminfo[1].strides, __pyx_t_40, __pyx_pybuffernd_box.diminfo[2].strides) = __pyx_v_surface_score;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line379")'> 379:                                 break</pre>
<pre id='line379' class='code' style='background-color: #FFFFff'>
                /* "epitopsy/cython/dx_cython.pyx":379
 *                                 # point of x,y,z is to close to the protein
 *                                 box[x,y,z] = surface_score
 *                                 break             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     for x in range(xdim):
 */
                goto __pyx_L19_break;
                goto __pyx_L21;
              }
              __pyx_L21:;
              goto __pyx_L20;
            }
            __pyx_L20:;
          }
          __pyx_L19_break:;
          goto __pyx_L17;
        }
        __pyx_L17:;
      }
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line380")'> 380: </pre>
<pre id='line380' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line381")'> 381:     for x in range(xdim):</pre>
<pre id='line381' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":381
 *                                 break
 * 
 *     for x in range(xdim):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for y in range(ydim):
 *             for z in range(zdim):
 */
  __pyx_t_2 = __pyx_v_xdim;
  for (__pyx_t_3 = 0; __pyx_t_3 <code><</code> __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_x = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line382")'> 382:         for y in range(ydim):</pre>
<pre id='line382' class='code' style='background-color: #FFFFff'>
    /* "epitopsy/cython/dx_cython.pyx":382
 * 
 *     for x in range(xdim):
 *         for y in range(ydim):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for z in range(zdim):
 *                 if box[x,y,z] == temp_score:
 */
    __pyx_t_4 = __pyx_v_ydim;
    for (__pyx_t_15 = 0; __pyx_t_15 <code><</code> __pyx_t_4; __pyx_t_15+=1) {
      __pyx_v_y = __pyx_t_15;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line383")'> 383:             for z in range(zdim):</pre>
<pre id='line383' class='code' style='background-color: #FFFFff'>
      /* "epitopsy/cython/dx_cython.pyx":383
 *     for x in range(xdim):
 *         for y in range(ydim):
 *             for z in range(zdim):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 if box[x,y,z] == temp_score:
 *                     # this should be the solvent
 */
      __pyx_t_16 = __pyx_v_zdim;
      for (__pyx_t_17 = 0; __pyx_t_17 <code><</code> __pyx_t_16; __pyx_t_17+=1) {
        __pyx_v_z = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line384")'> 384:                 if box[x,y,z] == temp_score:</pre>
<pre id='line384' class='code' style='background-color: #FFFFd4'>
        /* "epitopsy/cython/dx_cython.pyx":384
 *         for y in range(ydim):
 *             for z in range(zdim):
 *                 if box[x,y,z] == temp_score:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     # this should be the solvent
 *                     box[x,y,z] = solvent_score
 */
        __pyx_t_24 = __pyx_v_x;
        __pyx_t_25 = __pyx_v_y;
        __pyx_t_41 = __pyx_v_z;
        __pyx_t_42 = -1;
        if (__pyx_t_24 <code><</code> 0) {
          __pyx_t_24 += __pyx_pybuffernd_box.diminfo[0].shape;
          if (unlikely(__pyx_t_24 <code><</code> 0)) __pyx_t_42 = 0;
        } else if (unlikely(__pyx_t_24 >= __pyx_pybuffernd_box.diminfo[0].shape)) __pyx_t_42 = 0;
        if (__pyx_t_25 <code><</code> 0) {
          __pyx_t_25 += __pyx_pybuffernd_box.diminfo[1].shape;
          if (unlikely(__pyx_t_25 <code><</code> 0)) __pyx_t_42 = 1;
        } else if (unlikely(__pyx_t_25 >= __pyx_pybuffernd_box.diminfo[1].shape)) __pyx_t_42 = 1;
        if (__pyx_t_41 <code><</code> 0) {
          __pyx_t_41 += __pyx_pybuffernd_box.diminfo[2].shape;
          if (unlikely(__pyx_t_41 <code><</code> 0)) __pyx_t_42 = 2;
        } else if (unlikely(__pyx_t_41 >= __pyx_pybuffernd_box.diminfo[2].shape)) __pyx_t_42 = 2;
        if (unlikely(__pyx_t_42 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_42);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_5 = (((*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_24, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_25, __pyx_pybuffernd_box.diminfo[1].strides, __pyx_t_41, __pyx_pybuffernd_box.diminfo[2].strides)) == __pyx_v_temp_score) != 0);
        if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line385")'> 385:                     # this should be the solvent</pre>
<pre id='line385' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line386")'> 386:                     box[x,y,z] = solvent_score</pre>
<pre id='line386' class='code' style='background-color: #FFFFd4'>
          /* "epitopsy/cython/dx_cython.pyx":386
 *                 if box[x,y,z] == temp_score:
 *                     # this should be the solvent
 *                     box[x,y,z] = solvent_score             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 else:
 *                     # this is all protein
 */
          __pyx_t_42 = __pyx_v_x;
          __pyx_t_43 = __pyx_v_y;
          __pyx_t_44 = __pyx_v_z;
          __pyx_t_45 = -1;
          if (__pyx_t_42 <code><</code> 0) {
            __pyx_t_42 += __pyx_pybuffernd_box.diminfo[0].shape;
            if (unlikely(__pyx_t_42 <code><</code> 0)) __pyx_t_45 = 0;
          } else if (unlikely(__pyx_t_42 >= __pyx_pybuffernd_box.diminfo[0].shape)) __pyx_t_45 = 0;
          if (__pyx_t_43 <code><</code> 0) {
            __pyx_t_43 += __pyx_pybuffernd_box.diminfo[1].shape;
            if (unlikely(__pyx_t_43 <code><</code> 0)) __pyx_t_45 = 1;
          } else if (unlikely(__pyx_t_43 >= __pyx_pybuffernd_box.diminfo[1].shape)) __pyx_t_45 = 1;
          if (__pyx_t_44 <code><</code> 0) {
            __pyx_t_44 += __pyx_pybuffernd_box.diminfo[2].shape;
            if (unlikely(__pyx_t_44 <code><</code> 0)) __pyx_t_45 = 2;
          } else if (unlikely(__pyx_t_44 >= __pyx_pybuffernd_box.diminfo[2].shape)) __pyx_t_45 = 2;
          if (unlikely(__pyx_t_45 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_45);
           <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_42, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_43, __pyx_pybuffernd_box.diminfo[1].strides, __pyx_t_44, __pyx_pybuffernd_box.diminfo[2].strides) = __pyx_v_solvent_score;
          goto __pyx_L28;
        }
        /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line387")'> 387:                 else:</pre>
<pre id='line387' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line388")'> 388:                     # this is all protein</pre>
<pre id='line388' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line389")'> 389:                     box[x,y,z] = protein_score</pre>
<pre id='line389' class='code' style='background-color: #FFFFd4'>
          /* "epitopsy/cython/dx_cython.pyx":389
 *                 else:
 *                     # this is all protein
 *                     box[x,y,z] = protein_score             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     return box
 */
          __pyx_t_45 = __pyx_v_x;
          __pyx_t_46 = __pyx_v_y;
          __pyx_t_47 = __pyx_v_z;
          __pyx_t_48 = -1;
          if (__pyx_t_45 <code><</code> 0) {
            __pyx_t_45 += __pyx_pybuffernd_box.diminfo[0].shape;
            if (unlikely(__pyx_t_45 <code><</code> 0)) __pyx_t_48 = 0;
          } else if (unlikely(__pyx_t_45 >= __pyx_pybuffernd_box.diminfo[0].shape)) __pyx_t_48 = 0;
          if (__pyx_t_46 <code><</code> 0) {
            __pyx_t_46 += __pyx_pybuffernd_box.diminfo[1].shape;
            if (unlikely(__pyx_t_46 <code><</code> 0)) __pyx_t_48 = 1;
          } else if (unlikely(__pyx_t_46 >= __pyx_pybuffernd_box.diminfo[1].shape)) __pyx_t_48 = 1;
          if (__pyx_t_47 <code><</code> 0) {
            __pyx_t_47 += __pyx_pybuffernd_box.diminfo[2].shape;
            if (unlikely(__pyx_t_47 <code><</code> 0)) __pyx_t_48 = 2;
          } else if (unlikely(__pyx_t_47 >= __pyx_pybuffernd_box.diminfo[2].shape)) __pyx_t_48 = 2;
          if (unlikely(__pyx_t_48 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_48);
           <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_45, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_46, __pyx_pybuffernd_box.diminfo[1].strides, __pyx_t_47, __pyx_pybuffernd_box.diminfo[2].strides) = __pyx_v_protein_score;
        }
        __pyx_L28:;
      }
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line390")'> 390: </pre>
<pre id='line390' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF1f' onclick='toggleDiv("line391")'> 391:     return box</pre>
<pre id='line391' class='code' style='background-color: #FFFF1f'>
  /* "epitopsy/cython/dx_cython.pyx":391
 *                     box[x,y,z] = protein_score
 * 
 *     return box             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_box));
  __pyx_r = ((PyArrayObject *)__pyx_v_box);
  goto __pyx_L0;

  __pyx_r = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&__pyx_type, &__pyx_value, &__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_neighbors.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython._get_sas", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_neighbors.rcbuffer->pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_neighbors_list);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_neighbors);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>((PyObject *)__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_8epitopsy_6cython_9dx_cython_13determine_actual_surface_nodes(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_8epitopsy_6cython_9dx_cython_13determine_actual_surface_nodes = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("determine_actual_surface_nodes"), (PyCFunction)__pyx_pw_8epitopsy_6cython_9dx_cython_13determine_actual_surface_nodes, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_8epitopsy_6cython_9dx_cython_13determine_actual_surface_nodes(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_box = 0;
  PyObject *__pyx_v_score = 0;
  PyArrayObject *__pyx_v_neighbors = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("determine_actual_surface_nodes (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__box,&__pyx_n_s__score,&__pyx_n_s__neighbors,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__box)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__score)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("determine_actual_surface_nodes", 1, 3, 3, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__neighbors)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("determine_actual_surface_nodes", 1, 3, 3, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "determine_actual_surface_nodes") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_box = ((PyArrayObject *)values[0]);
    __pyx_v_score = values[1];
    __pyx_v_neighbors = ((PyArrayObject *)values[2]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("determine_actual_surface_nodes", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython.determine_actual_surface_nodes", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_box), __pyx_ptype_5numpy_ndarray, 1, "box", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_neighbors), __pyx_ptype_5numpy_ndarray, 1, "neighbors", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_8epitopsy_6cython_9dx_cython_12determine_actual_surface_nodes(__pyx_self, __pyx_v_box, __pyx_v_score, __pyx_v_neighbors);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line392")'> 392: </pre>
<pre id='line392' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line393")'> 393: </pre>
<pre id='line393' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line394")'> 394: def determine_actual_surface_nodes(np.ndarray[np.float64_t, ndim=3] box,</pre>
<pre id='line394' class='code' style='background-color: #FFFF55'>
/* "epitopsy/cython/dx_cython.pyx":394
 * 
 * 
 * def determine_actual_surface_nodes(np.ndarray[np.float64_t, ndim=3] box,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         score, np.ndarray[np.int64_t, ndim = 2] neighbors):
 *     surface_candidates = np.nonzero(box != score)
 */

static PyObject *__pyx_pf_8epitopsy_6cython_9dx_cython_12determine_actual_surface_nodes(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_box, PyObject *__pyx_v_score, PyArrayObject *__pyx_v_neighbors) {
  PyObject *__pyx_v_surface_candidates = NULL;
  PyObject *__pyx_v_surface_nodes = NULL;
  float __pyx_v_solventScore;
  int __pyx_v_neighbor_elements;
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_nx;
  int __pyx_v_ny;
  int __pyx_v_nz;
  int __pyx_v_posx;
  int __pyx_v_posy;
  int __pyx_v_posz;
  int __pyx_v_xdim;
  int __pyx_v_ydim;
  int __pyx_v_zdim;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_box;
  __Pyx_Buffer __pyx_pybuffer_box;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_neighbors;
  __Pyx_Buffer __pyx_pybuffer_neighbors;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("determine_actual_surface_nodes", 0);
  __pyx_pybuffer_box.pybuffer.buf = NULL;
  __pyx_pybuffer_box.refcount = 0;
  __pyx_pybuffernd_box.data = NULL;
  __pyx_pybuffernd_box.rcbuffer = &__pyx_pybuffer_box;
  __pyx_pybuffer_neighbors.pybuffer.buf = NULL;
  __pyx_pybuffer_neighbors.refcount = 0;
  __pyx_pybuffernd_neighbors.data = NULL;
  __pyx_pybuffernd_neighbors.rcbuffer = &__pyx_pybuffer_neighbors;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer, (PyObject*)__pyx_v_box, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_box.diminfo[0].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_box.diminfo[0].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_box.diminfo[1].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_box.diminfo[1].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_box.diminfo[2].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_box.diminfo[2].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[2];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_neighbors.rcbuffer->pybuffer, (PyObject*)__pyx_v_neighbors, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_neighbors.diminfo[0].strides = __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_neighbors.diminfo[0].shape = __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_neighbors.diminfo[1].strides = __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_neighbors.diminfo[1].shape = __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.shape[1];

  /* "epitopsy/cython/dx_cython.pyx":394
 * 
 * 
 * def determine_actual_surface_nodes(np.ndarray[np.float64_t, ndim=3] box,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         score, np.ndarray[np.int64_t, ndim = 2] neighbors):
 *     surface_candidates = np.nonzero(box != score)
 */
  __pyx_k_tuple_121 = <span class='py_c_api'>PyTuple_Pack</span>(18, ((PyObject *)__pyx_n_s__box), ((PyObject *)__pyx_n_s__score), ((PyObject *)__pyx_n_s__neighbors), ((PyObject *)__pyx_n_s__surface_candidates), ((PyObject *)__pyx_n_s__surface_nodes), ((PyObject *)__pyx_n_s__solventScore), ((PyObject *)__pyx_n_s__neighbor_elements), ((PyObject *)__pyx_n_s__i), ((PyObject *)__pyx_n_s__j), ((PyObject *)__pyx_n_s__nx), ((PyObject *)__pyx_n_s__ny), ((PyObject *)__pyx_n_s__nz), ((PyObject *)__pyx_n_s__posx), ((PyObject *)__pyx_n_s__posy), ((PyObject *)__pyx_n_s__posz), ((PyObject *)__pyx_n_s__xdim), ((PyObject *)__pyx_n_s__ydim), ((PyObject *)__pyx_n_s__zdim));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_121)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_121);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_121));

  /* "epitopsy/cython/dx_cython.pyx":394
 * 
 * 
 * def determine_actual_surface_nodes(np.ndarray[np.float64_t, ndim=3] box,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         score, np.ndarray[np.int64_t, ndim = 2] neighbors):
 *     surface_candidates = np.nonzero(box != score)
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_8epitopsy_6cython_9dx_cython_13determine_actual_surface_nodes, NULL, __pyx_n_s_110);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_58, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_122 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(3, 0, 18, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_121, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_109, __pyx_n_s_58, 394, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_122)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line395")'> 395:         score, np.ndarray[np.int64_t, ndim = 2] neighbors):</pre>
<pre id='line395' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line396")'> 396:     surface_candidates = np.nonzero(box != score)</pre>
<pre id='line396' class='code' style='background-color: #FFFF46'>
  /* "epitopsy/cython/dx_cython.pyx":396
 * def determine_actual_surface_nodes(np.ndarray[np.float64_t, ndim=3] box,
 *         score, np.ndarray[np.int64_t, ndim = 2] neighbors):
 *     surface_candidates = np.nonzero(box != score)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     surface_nodes = []
 *     cdef float solventScore = score
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s__nonzero);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(((PyObject *)__pyx_v_box), __pyx_v_score, Py_NE); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_v_surface_candidates = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line397")'> 397:     surface_nodes = []</pre>
<pre id='line397' class='code' style='background-color: #FFFFaa'>
  /* "epitopsy/cython/dx_cython.pyx":397
 *         score, np.ndarray[np.int64_t, ndim = 2] neighbors):
 *     surface_candidates = np.nonzero(box != score)
 *     surface_nodes = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef float solventScore = score
 *     cdef int neighbor_elements = len(neighbors)
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_surface_nodes = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line398")'> 398:     cdef float solventScore = score</pre>
<pre id='line398' class='code' style='background-color: #FFFF7f'>
  /* "epitopsy/cython/dx_cython.pyx":398
 *     surface_candidates = np.nonzero(box != score)
 *     surface_nodes = []
 *     cdef float solventScore = score             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int neighbor_elements = len(neighbors)
 *     cdef int i
 */
  __pyx_t_4 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_score);<span class='error_goto'> if (unlikely((__pyx_t_4 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_solventScore = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line399")'> 399:     cdef int neighbor_elements = len(neighbors)</pre>
<pre id='line399' class='code' style='background-color: #FFFFaa'>
  /* "epitopsy/cython/dx_cython.pyx":399
 *     surface_nodes = []
 *     cdef float solventScore = score
 *     cdef int neighbor_elements = len(neighbors)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int i
 *     cdef int j
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(((PyObject *)__pyx_v_neighbors));<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_neighbor_elements = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line400")'> 400:     cdef int i</pre>
<pre id='line400' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line401")'> 401:     cdef int j</pre>
<pre id='line401' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line402")'> 402:     cdef int nx, ny, nz</pre>
<pre id='line402' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line403")'> 403:     cdef int posx, posy, posz</pre>
<pre id='line403' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line404")'> 404:     cdef int xdim = box.shape[0]</pre>
<pre id='line404' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":404
 *     cdef int nx, ny, nz
 *     cdef int posx, posy, posz
 *     cdef int xdim = box.shape[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int ydim = box.shape[1]
 *     cdef int zdim = box.shape[2]
 */
  __pyx_v_xdim = (__pyx_v_box->dimensions[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line405")'> 405:     cdef int ydim = box.shape[1]</pre>
<pre id='line405' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":405
 *     cdef int posx, posy, posz
 *     cdef int xdim = box.shape[0]
 *     cdef int ydim = box.shape[1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int zdim = box.shape[2]
 *     for i from 0 <code><</code>= i <code><</code> len(surface_candidates[:][0]) :
 */
  __pyx_v_ydim = (__pyx_v_box->dimensions[1]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line406")'> 406:     cdef int zdim = box.shape[2]</pre>
<pre id='line406' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":406
 *     cdef int xdim = box.shape[0]
 *     cdef int ydim = box.shape[1]
 *     cdef int zdim = box.shape[2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     for i from 0 <code><</code>= i <code><</code> len(surface_candidates[:][0]) :
 *         for j from 0 <code><</code>= j <code><</code> neighbor_elements:
 */
  __pyx_v_zdim = (__pyx_v_box->dimensions[2]);
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line407")'> 407:     for i from 0 &lt;= i &lt; len(surface_candidates[:][0]) :</pre>
<pre id='line407' class='code' style='background-color: #FFFF57'>
  /* "epitopsy/cython/dx_cython.pyx":407
 *     cdef int ydim = box.shape[1]
 *     cdef int zdim = box.shape[2]
 *     for i from 0 <code><</code>= i <code><</code> len(surface_candidates[:][0]) :             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for j from 0 <code><</code>= j <code><</code> neighbor_elements:
 *             nx = neighbors[j,0]
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_GetSlice</span>(__pyx_v_surface_candidates, 0, 0, NULL, NULL, &__pyx_k_slice_57, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, sizeof(long), PyInt_FromLong, 0, 0, 1);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  for (__pyx_v_i = 0; __pyx_v_i <code><</code> __pyx_t_5; __pyx_v_i++) {

  /* "epitopsy/cython/dx_cython.pyx":407
 *     cdef int ydim = box.shape[1]
 *     cdef int zdim = box.shape[2]
 *     for i from 0 <code><</code>= i <code><</code> len(surface_candidates[:][0]) :             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for j from 0 <code><</code>= j <code><</code> neighbor_elements:
 *             nx = neighbors[j,0]
 */
  __pyx_k_slice_57 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_k_slice_57)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_slice_57);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_k_slice_57);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line408")'> 408:         for j from 0 &lt;= j &lt; neighbor_elements:</pre>
<pre id='line408' class='code' style='background-color: #FFFFff'>
    /* "epitopsy/cython/dx_cython.pyx":408
 *     cdef int zdim = box.shape[2]
 *     for i from 0 <code><</code>= i <code><</code> len(surface_candidates[:][0]) :
 *         for j from 0 <code><</code>= j <code><</code> neighbor_elements:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             nx = neighbors[j,0]
 *             ny = neighbors[j,1]
 */
    __pyx_t_6 = __pyx_v_neighbor_elements;
    for (__pyx_v_j = 0; __pyx_v_j <code><</code> __pyx_t_6; __pyx_v_j++) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line409")'> 409:             nx = neighbors[j,0]</pre>
<pre id='line409' class='code' style='background-color: #FFFFd4'>
      /* "epitopsy/cython/dx_cython.pyx":409
 *     for i from 0 <code><</code>= i <code><</code> len(surface_candidates[:][0]) :
 *         for j from 0 <code><</code>= j <code><</code> neighbor_elements:
 *             nx = neighbors[j,0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             ny = neighbors[j,1]
 *             nz = neighbors[j,2]
 */
      __pyx_t_7 = __pyx_v_j;
      __pyx_t_8 = 0;
      __pyx_t_9 = -1;
      if (__pyx_t_7 <code><</code> 0) {
        __pyx_t_7 += __pyx_pybuffernd_neighbors.diminfo[0].shape;
        if (unlikely(__pyx_t_7 <code><</code> 0)) __pyx_t_9 = 0;
      } else if (unlikely(__pyx_t_7 >= __pyx_pybuffernd_neighbors.diminfo[0].shape)) __pyx_t_9 = 0;
      if (__pyx_t_8 <code><</code> 0) {
        __pyx_t_8 += __pyx_pybuffernd_neighbors.diminfo[1].shape;
        if (unlikely(__pyx_t_8 <code><</code> 0)) __pyx_t_9 = 1;
      } else if (unlikely(__pyx_t_8 >= __pyx_pybuffernd_neighbors.diminfo[1].shape)) __pyx_t_9 = 1;
      if (unlikely(__pyx_t_9 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_9);
       <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 409; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_v_nx = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.buf, __pyx_t_7, __pyx_pybuffernd_neighbors.diminfo[0].strides, __pyx_t_8, __pyx_pybuffernd_neighbors.diminfo[1].strides));
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line410")'> 410:             ny = neighbors[j,1]</pre>
<pre id='line410' class='code' style='background-color: #FFFFd4'>
      /* "epitopsy/cython/dx_cython.pyx":410
 *         for j from 0 <code><</code>= j <code><</code> neighbor_elements:
 *             nx = neighbors[j,0]
 *             ny = neighbors[j,1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             nz = neighbors[j,2]
 *             posx = surface_candidates[0][i]+nx
 */
      __pyx_t_9 = __pyx_v_j;
      __pyx_t_10 = 1;
      __pyx_t_11 = -1;
      if (__pyx_t_9 <code><</code> 0) {
        __pyx_t_9 += __pyx_pybuffernd_neighbors.diminfo[0].shape;
        if (unlikely(__pyx_t_9 <code><</code> 0)) __pyx_t_11 = 0;
      } else if (unlikely(__pyx_t_9 >= __pyx_pybuffernd_neighbors.diminfo[0].shape)) __pyx_t_11 = 0;
      if (__pyx_t_10 <code><</code> 0) {
        __pyx_t_10 += __pyx_pybuffernd_neighbors.diminfo[1].shape;
        if (unlikely(__pyx_t_10 <code><</code> 0)) __pyx_t_11 = 1;
      } else if (unlikely(__pyx_t_10 >= __pyx_pybuffernd_neighbors.diminfo[1].shape)) __pyx_t_11 = 1;
      if (unlikely(__pyx_t_11 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
       <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_v_ny = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.buf, __pyx_t_9, __pyx_pybuffernd_neighbors.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_neighbors.diminfo[1].strides));
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line411")'> 411:             nz = neighbors[j,2]</pre>
<pre id='line411' class='code' style='background-color: #FFFFd4'>
      /* "epitopsy/cython/dx_cython.pyx":411
 *             nx = neighbors[j,0]
 *             ny = neighbors[j,1]
 *             nz = neighbors[j,2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             posx = surface_candidates[0][i]+nx
 *             posy = surface_candidates[1][i]+ny
 */
      __pyx_t_11 = __pyx_v_j;
      __pyx_t_12 = 2;
      __pyx_t_13 = -1;
      if (__pyx_t_11 <code><</code> 0) {
        __pyx_t_11 += __pyx_pybuffernd_neighbors.diminfo[0].shape;
        if (unlikely(__pyx_t_11 <code><</code> 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_11 >= __pyx_pybuffernd_neighbors.diminfo[0].shape)) __pyx_t_13 = 0;
      if (__pyx_t_12 <code><</code> 0) {
        __pyx_t_12 += __pyx_pybuffernd_neighbors.diminfo[1].shape;
        if (unlikely(__pyx_t_12 <code><</code> 0)) __pyx_t_13 = 1;
      } else if (unlikely(__pyx_t_12 >= __pyx_pybuffernd_neighbors.diminfo[1].shape)) __pyx_t_13 = 1;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
       <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 411; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_v_nz = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_neighbors.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_neighbors.diminfo[1].strides));
</pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line412")'> 412:             posx = surface_candidates[0][i]+nx</pre>
<pre id='line412' class='code' style='background-color: #FFFF43'>
      /* "epitopsy/cython/dx_cython.pyx":412
 *             ny = neighbors[j,1]
 *             nz = neighbors[j,2]
 *             posx = surface_candidates[0][i]+nx             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             posy = surface_candidates[1][i]+ny
 *             posz = surface_candidates[2][i]+nz
 */
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_surface_candidates, 0, sizeof(long), PyInt_FromLong, 0, 0, 1);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 412; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, __pyx_v_i, sizeof(int), PyInt_FromLong, 0, 1, 1);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 412; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_nx);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 412; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 412; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_13 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_13 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 412; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_v_posx = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line413")'> 413:             posy = surface_candidates[1][i]+ny</pre>
<pre id='line413' class='code' style='background-color: #FFFF43'>
      /* "epitopsy/cython/dx_cython.pyx":413
 *             nz = neighbors[j,2]
 *             posx = surface_candidates[0][i]+nx
 *             posy = surface_candidates[1][i]+ny             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             posz = surface_candidates[2][i]+nz
 *             if (posx >= 0 and posx <code><</code> xdim
 */
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_surface_candidates, 1, sizeof(long), PyInt_FromLong, 0, 0, 1);<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 413; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, __pyx_v_i, sizeof(int), PyInt_FromLong, 0, 1, 1);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 413; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_ny);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 413; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 413; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_13 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_13 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 413; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_v_posy = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line414")'> 414:             posz = surface_candidates[2][i]+nz</pre>
<pre id='line414' class='code' style='background-color: #FFFF43'>
      /* "epitopsy/cython/dx_cython.pyx":414
 *             posx = surface_candidates[0][i]+nx
 *             posy = surface_candidates[1][i]+ny
 *             posz = surface_candidates[2][i]+nz             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if (posx >= 0 and posx <code><</code> xdim
 *                 and posy >= 0 and posy <code><</code> ydim
 */
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_surface_candidates, 2, sizeof(long), PyInt_FromLong, 0, 0, 1);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, __pyx_v_i, sizeof(int), PyInt_FromLong, 0, 1, 1);<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_nz);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_13 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_13 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_v_posz = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line415")'> 415:             if (posx &gt;= 0 and posx &lt; xdim</pre>
<pre id='line415' class='code' style='background-color: #FFFFff'>
      /* "epitopsy/cython/dx_cython.pyx":415
 *             posy = surface_candidates[1][i]+ny
 *             posz = surface_candidates[2][i]+nz
 *             if (posx >= 0 and posx <code><</code> xdim             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 and posy >= 0 and posy <code><</code> ydim
 *                 and posz >= 0 and posz <code><</code> zdim):
 */
      __pyx_t_14 = ((__pyx_v_posx >= 0) != 0);
      if (__pyx_t_14) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line416")'> 416:                 and posy &gt;= 0 and posy &lt; ydim</pre>
<pre id='line416' class='code' style='background-color: #FFFFff'>
        /* "epitopsy/cython/dx_cython.pyx":416
 *             posz = surface_candidates[2][i]+nz
 *             if (posx >= 0 and posx <code><</code> xdim
 *                 and posy >= 0 and posy <code><</code> ydim             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 and posz >= 0 and posz <code><</code> zdim):
 *                 if box[posx, posy, posz] == solventScore:
 */
        __pyx_t_15 = ((__pyx_v_posx <code><</code> __pyx_v_xdim) != 0);
        if (__pyx_t_15) {
          __pyx_t_16 = ((__pyx_v_posy >= 0) != 0);
          if (__pyx_t_16) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line417")'> 417:                 and posz &gt;= 0 and posz &lt; zdim):</pre>
<pre id='line417' class='code' style='background-color: #FFFFff'>
            /* "epitopsy/cython/dx_cython.pyx":417
 *             if (posx >= 0 and posx <code><</code> xdim
 *                 and posy >= 0 and posy <code><</code> ydim
 *                 and posz >= 0 and posz <code><</code> zdim):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 if box[posx, posy, posz] == solventScore:
 *                     surface_nodes.append([surface_candidates[0][i],
 */
            __pyx_t_17 = ((__pyx_v_posy <code><</code> __pyx_v_ydim) != 0);
            if (__pyx_t_17) {
              __pyx_t_18 = ((__pyx_v_posz >= 0) != 0);
              if (__pyx_t_18) {
                __pyx_t_19 = ((__pyx_v_posz <code><</code> __pyx_v_zdim) != 0);
                __pyx_t_20 = __pyx_t_19;
              } else {
                __pyx_t_20 = __pyx_t_18;
              }
              __pyx_t_18 = __pyx_t_20;
            } else {
              __pyx_t_18 = __pyx_t_17;
            }
            __pyx_t_17 = __pyx_t_18;
          } else {
            __pyx_t_17 = __pyx_t_16;
          }
          __pyx_t_16 = __pyx_t_17;
        } else {
          __pyx_t_16 = __pyx_t_15;
        }
        __pyx_t_15 = __pyx_t_16;
      } else {
        __pyx_t_15 = __pyx_t_14;
      }
      if (__pyx_t_15) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line418")'> 418:                 if box[posx, posy, posz] == solventScore:</pre>
<pre id='line418' class='code' style='background-color: #FFFFd4'>
        /* "epitopsy/cython/dx_cython.pyx":418
 *                 and posy >= 0 and posy <code><</code> ydim
 *                 and posz >= 0 and posz <code><</code> zdim):
 *                 if box[posx, posy, posz] == solventScore:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     surface_nodes.append([surface_candidates[0][i],
 *                                         surface_candidates[1][i],
 */
        __pyx_t_13 = __pyx_v_posx;
        __pyx_t_21 = __pyx_v_posy;
        __pyx_t_22 = __pyx_v_posz;
        __pyx_t_23 = -1;
        if (__pyx_t_13 <code><</code> 0) {
          __pyx_t_13 += __pyx_pybuffernd_box.diminfo[0].shape;
          if (unlikely(__pyx_t_13 <code><</code> 0)) __pyx_t_23 = 0;
        } else if (unlikely(__pyx_t_13 >= __pyx_pybuffernd_box.diminfo[0].shape)) __pyx_t_23 = 0;
        if (__pyx_t_21 <code><</code> 0) {
          __pyx_t_21 += __pyx_pybuffernd_box.diminfo[1].shape;
          if (unlikely(__pyx_t_21 <code><</code> 0)) __pyx_t_23 = 1;
        } else if (unlikely(__pyx_t_21 >= __pyx_pybuffernd_box.diminfo[1].shape)) __pyx_t_23 = 1;
        if (__pyx_t_22 <code><</code> 0) {
          __pyx_t_22 += __pyx_pybuffernd_box.diminfo[2].shape;
          if (unlikely(__pyx_t_22 <code><</code> 0)) __pyx_t_23 = 2;
        } else if (unlikely(__pyx_t_22 >= __pyx_pybuffernd_box.diminfo[2].shape)) __pyx_t_23 = 2;
        if (unlikely(__pyx_t_23 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_23);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 418; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_15 = (((*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_21, __pyx_pybuffernd_box.diminfo[1].strides, __pyx_t_22, __pyx_pybuffernd_box.diminfo[2].strides)) == __pyx_v_solventScore) != 0);
        if (__pyx_t_15) {
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line419")'> 419:                     surface_nodes.append([surface_candidates[0][i],</pre>
<pre id='line419' class='code' style='background-color: #FFFFaa'>
          /* "epitopsy/cython/dx_cython.pyx":419
 *                 and posz >= 0 and posz <code><</code> zdim):
 *                 if box[posx, posy, posz] == solventScore:
 *                     surface_nodes.append([surface_candidates[0][i],             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         surface_candidates[1][i],
 *                                         surface_candidates[2][i]])
 */
          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_surface_candidates, 0, sizeof(long), PyInt_FromLong, 0, 0, 1);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, __pyx_v_i, sizeof(int), PyInt_FromLong, 0, 1, 1);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line420")'> 420:                                         surface_candidates[1][i],</pre>
<pre id='line420' class='code' style='background-color: #FFFFaa'>
          /* "epitopsy/cython/dx_cython.pyx":420
 *                 if box[posx, posy, posz] == solventScore:
 *                     surface_nodes.append([surface_candidates[0][i],
 *                                         surface_candidates[1][i],             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                         surface_candidates[2][i]])
 *                     break
 */
          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_surface_candidates, 1, sizeof(long), PyInt_FromLong, 0, 0, 1);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, __pyx_v_i, sizeof(int), PyInt_FromLong, 0, 1, 1);<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line421")'> 421:                                         surface_candidates[2][i]])</pre>
<pre id='line421' class='code' style='background-color: #FFFF57'>
          /* "epitopsy/cython/dx_cython.pyx":421
 *                     surface_nodes.append([surface_candidates[0][i],
 *                                         surface_candidates[1][i],
 *                                         surface_candidates[2][i]])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     break
 *     return surface_nodes
 */
          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_surface_candidates, 2, sizeof(long), PyInt_FromLong, 0, 0, 1);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 421; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
          __pyx_t_24 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, __pyx_v_i, sizeof(int), PyInt_FromLong, 0, 1, 1);<span class='error_goto'> if (!__pyx_t_24) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 421; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_24);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
          <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
          <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
          <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 2, __pyx_t_24);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_24);
          __pyx_t_1 = 0;
          __pyx_t_2 = 0;
          __pyx_t_24 = 0;
          __pyx_t_25 = __Pyx_<span class='py_c_api'>PyList_Append</span>(__pyx_v_surface_nodes, ((PyObject *)__pyx_t_3));<span class='error_goto'> if (unlikely(__pyx_t_25 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line422")'> 422:                     break</pre>
<pre id='line422' class='code' style='background-color: #FFFFff'>
          /* "epitopsy/cython/dx_cython.pyx":422
 *                                         surface_candidates[1][i],
 *                                         surface_candidates[2][i]])
 *                     break             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return surface_nodes
 * 
 */
          goto __pyx_L6_break;
          goto __pyx_L8;
        }
        __pyx_L8:;
        goto __pyx_L7;
      }
      __pyx_L7:;
    }
    __pyx_L6_break:;
  }
</pre><pre class='line' style='background-color: #FFFF1c' onclick='toggleDiv("line423")'> 423:     return surface_nodes</pre>
<pre id='line423' class='code' style='background-color: #FFFF1c'>
  /* "epitopsy/cython/dx_cython.pyx":423
 *                                         surface_candidates[2][i]])
 *                     break
 *     return surface_nodes             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_surface_nodes));
  __pyx_r = ((PyObject *)__pyx_v_surface_nodes);
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_24);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&__pyx_type, &__pyx_value, &__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_neighbors.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython.determine_actual_surface_nodes", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_neighbors.rcbuffer->pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_surface_candidates);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_surface_nodes);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_8epitopsy_6cython_9dx_cython_15determineActualInnerPeptideNodes(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_8epitopsy_6cython_9dx_cython_15determineActualInnerPeptideNodes = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("determineActualInnerPeptideNodes"), (PyCFunction)__pyx_pw_8epitopsy_6cython_9dx_cython_15determineActualInnerPeptideNodes, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_8epitopsy_6cython_9dx_cython_15determineActualInnerPeptideNodes(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_box = 0;
  PyObject *__pyx_v_solventScore_ext = 0;
  PyObject *__pyx_v_peptideScore_ext = 0;
  PyArrayObject *__pyx_v_neighbors = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("determineActualInnerPeptideNodes (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__box,&__pyx_n_s__solventScore_ext,&__pyx_n_s__peptideScore_ext,&__pyx_n_s__neighbors,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__box)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__solventScore_ext)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("determineActualInnerPeptideNodes", 1, 4, 4, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__peptideScore_ext)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("determineActualInnerPeptideNodes", 1, 4, 4, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__neighbors)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("determineActualInnerPeptideNodes", 1, 4, 4, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "determineActualInnerPeptideNodes") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_box = ((PyArrayObject *)values[0]);
    __pyx_v_solventScore_ext = values[1];
    __pyx_v_peptideScore_ext = values[2];
    __pyx_v_neighbors = ((PyArrayObject *)values[3]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("determineActualInnerPeptideNodes", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython.determineActualInnerPeptideNodes", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_box), __pyx_ptype_5numpy_ndarray, 1, "box", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_neighbors), __pyx_ptype_5numpy_ndarray, 1, "neighbors", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 428; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_8epitopsy_6cython_9dx_cython_14determineActualInnerPeptideNodes(__pyx_self, __pyx_v_box, __pyx_v_solventScore_ext, __pyx_v_peptideScore_ext, __pyx_v_neighbors);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line424")'> 424: </pre>
<pre id='line424' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line425")'> 425: </pre>
<pre id='line425' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line426")'> 426: def determineActualInnerPeptideNodes(np.ndarray[np.float64_t, ndim=3] box,</pre>
<pre id='line426' class='code' style='background-color: #FFFF55'>
/* "epitopsy/cython/dx_cython.pyx":426
 * 
 * 
 * def determineActualInnerPeptideNodes(np.ndarray[np.float64_t, ndim=3] box,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         solventScore_ext, peptideScore_ext,
 *         np.ndarray[np.int64_t, ndim = 2] neighbors):
 */

static PyObject *__pyx_pf_8epitopsy_6cython_9dx_cython_14determineActualInnerPeptideNodes(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_box, PyObject *__pyx_v_solventScore_ext, PyObject *__pyx_v_peptideScore_ext, PyArrayObject *__pyx_v_neighbors) {
  PyObject *__pyx_v_innerNodes = NULL;
  int __pyx_v_peptideScore;
  int __pyx_v_solventScore;
  int __pyx_v_neighbor_elements;
  int __pyx_v_xdim;
  int __pyx_v_ydim;
  int __pyx_v_zdim;
  int __pyx_v_x;
  int __pyx_v_y;
  int __pyx_v_z;
  int __pyx_v_i;
  int __pyx_v_nx;
  int __pyx_v_ny;
  int __pyx_v_nz;
  int __pyx_v_innerNode;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_box;
  __Pyx_Buffer __pyx_pybuffer_box;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_neighbors;
  __Pyx_Buffer __pyx_pybuffer_neighbors;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("determineActualInnerPeptideNodes", 0);
  __pyx_pybuffer_box.pybuffer.buf = NULL;
  __pyx_pybuffer_box.refcount = 0;
  __pyx_pybuffernd_box.data = NULL;
  __pyx_pybuffernd_box.rcbuffer = &__pyx_pybuffer_box;
  __pyx_pybuffer_neighbors.pybuffer.buf = NULL;
  __pyx_pybuffer_neighbors.refcount = 0;
  __pyx_pybuffernd_neighbors.data = NULL;
  __pyx_pybuffernd_neighbors.rcbuffer = &__pyx_pybuffer_neighbors;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer, (PyObject*)__pyx_v_box, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_box.diminfo[0].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_box.diminfo[0].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_box.diminfo[1].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_box.diminfo[1].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_box.diminfo[2].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_box.diminfo[2].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[2];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_neighbors.rcbuffer->pybuffer, (PyObject*)__pyx_v_neighbors, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_neighbors.diminfo[0].strides = __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_neighbors.diminfo[0].shape = __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_neighbors.diminfo[1].strides = __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_neighbors.diminfo[1].shape = __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.shape[1];

  /* "epitopsy/cython/dx_cython.pyx":426
 * 
 * 
 * def determineActualInnerPeptideNodes(np.ndarray[np.float64_t, ndim=3] box,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         solventScore_ext, peptideScore_ext,
 *         np.ndarray[np.int64_t, ndim = 2] neighbors):
 */
  __pyx_k_tuple_123 = <span class='py_c_api'>PyTuple_Pack</span>(19, ((PyObject *)__pyx_n_s__box), ((PyObject *)__pyx_n_s__solventScore_ext), ((PyObject *)__pyx_n_s__peptideScore_ext), ((PyObject *)__pyx_n_s__neighbors), ((PyObject *)__pyx_n_s__innerNodes), ((PyObject *)__pyx_n_s__peptideScore), ((PyObject *)__pyx_n_s__solventScore), ((PyObject *)__pyx_n_s__neighbor_elements), ((PyObject *)__pyx_n_s__xdim), ((PyObject *)__pyx_n_s__ydim), ((PyObject *)__pyx_n_s__zdim), ((PyObject *)__pyx_n_s__x), ((PyObject *)__pyx_n_s__y), ((PyObject *)__pyx_n_s__z), ((PyObject *)__pyx_n_s__i), ((PyObject *)__pyx_n_s__nx), ((PyObject *)__pyx_n_s__ny), ((PyObject *)__pyx_n_s__nz), ((PyObject *)__pyx_n_s__innerNode));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_123)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_123);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_123));

  /* "epitopsy/cython/dx_cython.pyx":426
 * 
 * 
 * def determineActualInnerPeptideNodes(np.ndarray[np.float64_t, ndim=3] box,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         solventScore_ext, peptideScore_ext,
 *         np.ndarray[np.int64_t, ndim = 2] neighbors):
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_8epitopsy_6cython_9dx_cython_15determineActualInnerPeptideNodes, NULL, __pyx_n_s_110);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_125, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_124 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(4, 0, 19, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_123, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_109, __pyx_n_s_125, 426, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_124)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line427")'> 427:         solventScore_ext, peptideScore_ext,</pre>
<pre id='line427' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line428")'> 428:         np.ndarray[np.int64_t, ndim = 2] neighbors):</pre>
<pre id='line428' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line429")'> 429:     innerNodes = []</pre>
<pre id='line429' class='code' style='background-color: #FFFFaa'>
  /* "epitopsy/cython/dx_cython.pyx":429
 *         solventScore_ext, peptideScore_ext,
 *         np.ndarray[np.int64_t, ndim = 2] neighbors):
 *     innerNodes = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int peptideScore = <code><</code>int> peptideScore_ext
 *     cdef int solventScore = <code><</code>int> solventScore_ext
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_innerNodes = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line430")'> 430:     cdef int peptideScore = &lt;int&gt; peptideScore_ext</pre>
<pre id='line430' class='code' style='background-color: #FFFF7f'>
  /* "epitopsy/cython/dx_cython.pyx":430
 *         np.ndarray[np.int64_t, ndim = 2] neighbors):
 *     innerNodes = []
 *     cdef int peptideScore = <code><</code>int> peptideScore_ext             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int solventScore = <code><</code>int> solventScore_ext
 *     cdef int neighbor_elements = len(neighbors)
 */
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_peptideScore_ext);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 430; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_peptideScore = ((int)__pyx_t_2);
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line431")'> 431:     cdef int solventScore = &lt;int&gt; solventScore_ext</pre>
<pre id='line431' class='code' style='background-color: #FFFF7f'>
  /* "epitopsy/cython/dx_cython.pyx":431
 *     innerNodes = []
 *     cdef int peptideScore = <code><</code>int> peptideScore_ext
 *     cdef int solventScore = <code><</code>int> solventScore_ext             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int neighbor_elements = len(neighbors)
 *     cdef int xdim = box.shape[0]
 */
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_solventScore_ext);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 431; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_solventScore = ((int)__pyx_t_2);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line432")'> 432:     cdef int neighbor_elements = len(neighbors)</pre>
<pre id='line432' class='code' style='background-color: #FFFFaa'>
  /* "epitopsy/cython/dx_cython.pyx":432
 *     cdef int peptideScore = <code><</code>int> peptideScore_ext
 *     cdef int solventScore = <code><</code>int> solventScore_ext
 *     cdef int neighbor_elements = len(neighbors)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int xdim = box.shape[0]
 *     cdef int ydim = box.shape[1]
 */
  __pyx_t_3 = <span class='py_c_api'>PyObject_Length</span>(((PyObject *)__pyx_v_neighbors));<span class='error_goto'> if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_neighbor_elements = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line433")'> 433:     cdef int xdim = box.shape[0]</pre>
<pre id='line433' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":433
 *     cdef int solventScore = <code><</code>int> solventScore_ext
 *     cdef int neighbor_elements = len(neighbors)
 *     cdef int xdim = box.shape[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int ydim = box.shape[1]
 *     cdef int zdim = box.shape[2]
 */
  __pyx_v_xdim = (__pyx_v_box->dimensions[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line434")'> 434:     cdef int ydim = box.shape[1]</pre>
<pre id='line434' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":434
 *     cdef int neighbor_elements = len(neighbors)
 *     cdef int xdim = box.shape[0]
 *     cdef int ydim = box.shape[1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int zdim = box.shape[2]
 *     cdef int x,y,z
 */
  __pyx_v_ydim = (__pyx_v_box->dimensions[1]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line435")'> 435:     cdef int zdim = box.shape[2]</pre>
<pre id='line435' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":435
 *     cdef int xdim = box.shape[0]
 *     cdef int ydim = box.shape[1]
 *     cdef int zdim = box.shape[2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int x,y,z
 *     cdef int i
 */
  __pyx_v_zdim = (__pyx_v_box->dimensions[2]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line436")'> 436:     cdef int x,y,z</pre>
<pre id='line436' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line437")'> 437:     cdef int i</pre>
<pre id='line437' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line438")'> 438:     cdef int nx, ny, nz</pre>
<pre id='line438' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line439")'> 439:     for x from 0 &lt;= x &lt; xdim:</pre>
<pre id='line439' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":439
 *     cdef int i
 *     cdef int nx, ny, nz
 *     for x from 0 <code><</code>= x <code><</code> xdim:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for y from 0 <code><</code>= y <code><</code> ydim:
 *             for z from 0 <code><</code>= z <code><</code> zdim:
 */
  __pyx_t_2 = __pyx_v_xdim;
  for (__pyx_v_x = 0; __pyx_v_x <code><</code> __pyx_t_2; __pyx_v_x++) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line440")'> 440:         for y from 0 &lt;= y &lt; ydim:</pre>
<pre id='line440' class='code' style='background-color: #FFFFff'>
    /* "epitopsy/cython/dx_cython.pyx":440
 *     cdef int nx, ny, nz
 *     for x from 0 <code><</code>= x <code><</code> xdim:
 *         for y from 0 <code><</code>= y <code><</code> ydim:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for z from 0 <code><</code>= z <code><</code> zdim:
 *                 if box[x, y, z] == peptideScore:
 */
    __pyx_t_4 = __pyx_v_ydim;
    for (__pyx_v_y = 0; __pyx_v_y <code><</code> __pyx_t_4; __pyx_v_y++) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line441")'> 441:             for z from 0 &lt;= z &lt; zdim:</pre>
<pre id='line441' class='code' style='background-color: #FFFFff'>
      /* "epitopsy/cython/dx_cython.pyx":441
 *     for x from 0 <code><</code>= x <code><</code> xdim:
 *         for y from 0 <code><</code>= y <code><</code> ydim:
 *             for z from 0 <code><</code>= z <code><</code> zdim:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 if box[x, y, z] == peptideScore:
 *                     innerNode = True
 */
      __pyx_t_5 = __pyx_v_zdim;
      for (__pyx_v_z = 0; __pyx_v_z <code><</code> __pyx_t_5; __pyx_v_z++) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line442")'> 442:                 if box[x, y, z] == peptideScore:</pre>
<pre id='line442' class='code' style='background-color: #FFFFd4'>
        /* "epitopsy/cython/dx_cython.pyx":442
 *         for y from 0 <code><</code>= y <code><</code> ydim:
 *             for z from 0 <code><</code>= z <code><</code> zdim:
 *                 if box[x, y, z] == peptideScore:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     innerNode = True
 *                     # there should be no boundary error, otherwise there
 */
        __pyx_t_6 = __pyx_v_x;
        __pyx_t_7 = __pyx_v_y;
        __pyx_t_8 = __pyx_v_z;
        __pyx_t_9 = -1;
        if (__pyx_t_6 <code><</code> 0) {
          __pyx_t_6 += __pyx_pybuffernd_box.diminfo[0].shape;
          if (unlikely(__pyx_t_6 <code><</code> 0)) __pyx_t_9 = 0;
        } else if (unlikely(__pyx_t_6 >= __pyx_pybuffernd_box.diminfo[0].shape)) __pyx_t_9 = 0;
        if (__pyx_t_7 <code><</code> 0) {
          __pyx_t_7 += __pyx_pybuffernd_box.diminfo[1].shape;
          if (unlikely(__pyx_t_7 <code><</code> 0)) __pyx_t_9 = 1;
        } else if (unlikely(__pyx_t_7 >= __pyx_pybuffernd_box.diminfo[1].shape)) __pyx_t_9 = 1;
        if (__pyx_t_8 <code><</code> 0) {
          __pyx_t_8 += __pyx_pybuffernd_box.diminfo[2].shape;
          if (unlikely(__pyx_t_8 <code><</code> 0)) __pyx_t_9 = 2;
        } else if (unlikely(__pyx_t_8 >= __pyx_pybuffernd_box.diminfo[2].shape)) __pyx_t_9 = 2;
        if (unlikely(__pyx_t_9 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_9);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 442; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_10 = (((*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_6, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_7, __pyx_pybuffernd_box.diminfo[1].strides, __pyx_t_8, __pyx_pybuffernd_box.diminfo[2].strides)) == __pyx_v_peptideScore) != 0);
        if (__pyx_t_10) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line443")'> 443:                     innerNode = True</pre>
<pre id='line443' class='code' style='background-color: #FFFFff'>
          /* "epitopsy/cython/dx_cython.pyx":443
 *             for z from 0 <code><</code>= z <code><</code> zdim:
 *                 if box[x, y, z] == peptideScore:
 *                     innerNode = True             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     # there should be no boundary error, otherwise there
 *                     # is something wrong!
 */
          __pyx_v_innerNode = 1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line444")'> 444:                     # there should be no boundary error, otherwise there</pre>
<pre id='line444' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line445")'> 445:                     # is something wrong!</pre>
<pre id='line445' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line446")'> 446:                     for i from 0 &lt;= i &lt; neighbor_elements:</pre>
<pre id='line446' class='code' style='background-color: #FFFFff'>
          /* "epitopsy/cython/dx_cython.pyx":446
 *                     # there should be no boundary error, otherwise there
 *                     # is something wrong!
 *                     for i from 0 <code><</code>= i <code><</code> neighbor_elements:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         nx = neighbors[i, 0]
 *                         ny = neighbors[i, 1]
 */
          __pyx_t_9 = __pyx_v_neighbor_elements;
          for (__pyx_v_i = 0; __pyx_v_i <code><</code> __pyx_t_9; __pyx_v_i++) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line447")'> 447:                         nx = neighbors[i, 0]</pre>
<pre id='line447' class='code' style='background-color: #FFFFd4'>
            /* "epitopsy/cython/dx_cython.pyx":447
 *                     # is something wrong!
 *                     for i from 0 <code><</code>= i <code><</code> neighbor_elements:
 *                         nx = neighbors[i, 0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         ny = neighbors[i, 1]
 *                         nz = neighbors[i, 2]
 */
            __pyx_t_11 = __pyx_v_i;
            __pyx_t_12 = 0;
            __pyx_t_13 = -1;
            if (__pyx_t_11 <code><</code> 0) {
              __pyx_t_11 += __pyx_pybuffernd_neighbors.diminfo[0].shape;
              if (unlikely(__pyx_t_11 <code><</code> 0)) __pyx_t_13 = 0;
            } else if (unlikely(__pyx_t_11 >= __pyx_pybuffernd_neighbors.diminfo[0].shape)) __pyx_t_13 = 0;
            if (__pyx_t_12 <code><</code> 0) {
              __pyx_t_12 += __pyx_pybuffernd_neighbors.diminfo[1].shape;
              if (unlikely(__pyx_t_12 <code><</code> 0)) __pyx_t_13 = 1;
            } else if (unlikely(__pyx_t_12 >= __pyx_pybuffernd_neighbors.diminfo[1].shape)) __pyx_t_13 = 1;
            if (unlikely(__pyx_t_13 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
             <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 447; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            __pyx_v_nx = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_neighbors.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_neighbors.diminfo[1].strides));
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line448")'> 448:                         ny = neighbors[i, 1]</pre>
<pre id='line448' class='code' style='background-color: #FFFFd4'>
            /* "epitopsy/cython/dx_cython.pyx":448
 *                     for i from 0 <code><</code>= i <code><</code> neighbor_elements:
 *                         nx = neighbors[i, 0]
 *                         ny = neighbors[i, 1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         nz = neighbors[i, 2]
 *                         if box[nx + x, ny + y, nz + z] == solventScore:
 */
            __pyx_t_13 = __pyx_v_i;
            __pyx_t_14 = 1;
            __pyx_t_15 = -1;
            if (__pyx_t_13 <code><</code> 0) {
              __pyx_t_13 += __pyx_pybuffernd_neighbors.diminfo[0].shape;
              if (unlikely(__pyx_t_13 <code><</code> 0)) __pyx_t_15 = 0;
            } else if (unlikely(__pyx_t_13 >= __pyx_pybuffernd_neighbors.diminfo[0].shape)) __pyx_t_15 = 0;
            if (__pyx_t_14 <code><</code> 0) {
              __pyx_t_14 += __pyx_pybuffernd_neighbors.diminfo[1].shape;
              if (unlikely(__pyx_t_14 <code><</code> 0)) __pyx_t_15 = 1;
            } else if (unlikely(__pyx_t_14 >= __pyx_pybuffernd_neighbors.diminfo[1].shape)) __pyx_t_15 = 1;
            if (unlikely(__pyx_t_15 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_15);
             <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 448; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            __pyx_v_ny = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_neighbors.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_neighbors.diminfo[1].strides));
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line449")'> 449:                         nz = neighbors[i, 2]</pre>
<pre id='line449' class='code' style='background-color: #FFFFd4'>
            /* "epitopsy/cython/dx_cython.pyx":449
 *                         nx = neighbors[i, 0]
 *                         ny = neighbors[i, 1]
 *                         nz = neighbors[i, 2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         if box[nx + x, ny + y, nz + z] == solventScore:
 *                             innerNode = False
 */
            __pyx_t_15 = __pyx_v_i;
            __pyx_t_16 = 2;
            __pyx_t_17 = -1;
            if (__pyx_t_15 <code><</code> 0) {
              __pyx_t_15 += __pyx_pybuffernd_neighbors.diminfo[0].shape;
              if (unlikely(__pyx_t_15 <code><</code> 0)) __pyx_t_17 = 0;
            } else if (unlikely(__pyx_t_15 >= __pyx_pybuffernd_neighbors.diminfo[0].shape)) __pyx_t_17 = 0;
            if (__pyx_t_16 <code><</code> 0) {
              __pyx_t_16 += __pyx_pybuffernd_neighbors.diminfo[1].shape;
              if (unlikely(__pyx_t_16 <code><</code> 0)) __pyx_t_17 = 1;
            } else if (unlikely(__pyx_t_16 >= __pyx_pybuffernd_neighbors.diminfo[1].shape)) __pyx_t_17 = 1;
            if (unlikely(__pyx_t_17 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_17);
             <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 449; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            __pyx_v_nz = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_neighbors.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_neighbors.diminfo[1].strides));
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line450")'> 450:                         if box[nx + x, ny + y, nz + z] == solventScore:</pre>
<pre id='line450' class='code' style='background-color: #FFFFd4'>
            /* "epitopsy/cython/dx_cython.pyx":450
 *                         ny = neighbors[i, 1]
 *                         nz = neighbors[i, 2]
 *                         if box[nx + x, ny + y, nz + z] == solventScore:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             innerNode = False
 *                             break
 */
            __pyx_t_17 = (__pyx_v_nx + __pyx_v_x);
            __pyx_t_18 = (__pyx_v_ny + __pyx_v_y);
            __pyx_t_19 = (__pyx_v_nz + __pyx_v_z);
            __pyx_t_20 = -1;
            if (__pyx_t_17 <code><</code> 0) {
              __pyx_t_17 += __pyx_pybuffernd_box.diminfo[0].shape;
              if (unlikely(__pyx_t_17 <code><</code> 0)) __pyx_t_20 = 0;
            } else if (unlikely(__pyx_t_17 >= __pyx_pybuffernd_box.diminfo[0].shape)) __pyx_t_20 = 0;
            if (__pyx_t_18 <code><</code> 0) {
              __pyx_t_18 += __pyx_pybuffernd_box.diminfo[1].shape;
              if (unlikely(__pyx_t_18 <code><</code> 0)) __pyx_t_20 = 1;
            } else if (unlikely(__pyx_t_18 >= __pyx_pybuffernd_box.diminfo[1].shape)) __pyx_t_20 = 1;
            if (__pyx_t_19 <code><</code> 0) {
              __pyx_t_19 += __pyx_pybuffernd_box.diminfo[2].shape;
              if (unlikely(__pyx_t_19 <code><</code> 0)) __pyx_t_20 = 2;
            } else if (unlikely(__pyx_t_19 >= __pyx_pybuffernd_box.diminfo[2].shape)) __pyx_t_20 = 2;
            if (unlikely(__pyx_t_20 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
             <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 450; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            __pyx_t_10 = (((*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_box.diminfo[1].strides, __pyx_t_19, __pyx_pybuffernd_box.diminfo[2].strides)) == __pyx_v_solventScore) != 0);
            if (__pyx_t_10) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line451")'> 451:                             innerNode = False</pre>
<pre id='line451' class='code' style='background-color: #FFFFff'>
              /* "epitopsy/cython/dx_cython.pyx":451
 *                         nz = neighbors[i, 2]
 *                         if box[nx + x, ny + y, nz + z] == solventScore:
 *                             innerNode = False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             break
 *                     if innerNode:
 */
              __pyx_v_innerNode = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line452")'> 452:                             break</pre>
<pre id='line452' class='code' style='background-color: #FFFFff'>
              /* "epitopsy/cython/dx_cython.pyx":452
 *                         if box[nx + x, ny + y, nz + z] == solventScore:
 *                             innerNode = False
 *                             break             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     if innerNode:
 *                         innerNodes.append([x, y, z])
 */
              goto __pyx_L11_break;
              goto __pyx_L12;
            }
            __pyx_L12:;
          }
          __pyx_L11_break:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line453")'> 453:                     if innerNode:</pre>
<pre id='line453' class='code' style='background-color: #FFFFff'>
          /* "epitopsy/cython/dx_cython.pyx":453
 *                             innerNode = False
 *                             break
 *                     if innerNode:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         innerNodes.append([x, y, z])
 *     return innerNodes
 */
          __pyx_t_10 = (__pyx_v_innerNode != 0);
          if (__pyx_t_10) {
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line454")'> 454:                         innerNodes.append([x, y, z])</pre>
<pre id='line454' class='code' style='background-color: #FFFF41'>
            /* "epitopsy/cython/dx_cython.pyx":454
 *                             break
 *                     if innerNode:
 *                         innerNodes.append([x, y, z])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return innerNodes
 * 
 */
            __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_x);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 454; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
            __pyx_t_21 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_y);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 454; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_21);
            __pyx_t_22 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_z);<span class='error_goto'> if (unlikely(!__pyx_t_22)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 454; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_22);
            __pyx_t_23 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 454; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_23);
            <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_23, 0, __pyx_t_1);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
            <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_23, 1, __pyx_t_21);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_21);
            <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_23, 2, __pyx_t_22);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_22);
            __pyx_t_1 = 0;
            __pyx_t_21 = 0;
            __pyx_t_22 = 0;
            __pyx_t_24 = __Pyx_<span class='py_c_api'>PyList_Append</span>(__pyx_v_innerNodes, ((PyObject *)__pyx_t_23));<span class='error_goto'> if (unlikely(__pyx_t_24 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 454; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_23)); __pyx_t_23 = 0;
            goto __pyx_L13;
          }
          __pyx_L13:;
          goto __pyx_L9;
        }
        __pyx_L9:;
      }
    }
  }
</pre><pre class='line' style='background-color: #FFFF17' onclick='toggleDiv("line455")'> 455:     return innerNodes</pre>
<pre id='line455' class='code' style='background-color: #FFFF17'>
  /* "epitopsy/cython/dx_cython.pyx":455
 *                     if innerNode:
 *                         innerNodes.append([x, y, z])
 *     return innerNodes             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * def extendSurface(int iterations, np.ndarray[np.float64_t, ndim=3] box,
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_innerNodes));
  __pyx_r = ((PyObject *)__pyx_v_innerNodes);
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_23);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&__pyx_type, &__pyx_value, &__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_neighbors.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython.determineActualInnerPeptideNodes", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_neighbors.rcbuffer->pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_innerNodes);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_8epitopsy_6cython_9dx_cython_17extendSurface(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_8epitopsy_6cython_9dx_cython_17extendSurface = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("extendSurface"), (PyCFunction)__pyx_pw_8epitopsy_6cython_9dx_cython_17extendSurface, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_8epitopsy_6cython_9dx_cython_17extendSurface(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_iterations;
  PyArrayObject *__pyx_v_box = 0;
  PyObject *__pyx_v_solventScore_ext = 0;
  PyObject *__pyx_v_peptideScore_ext = 0;
  PyArrayObject *__pyx_v_neighbors = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("extendSurface (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__iterations,&__pyx_n_s__box,&__pyx_n_s__solventScore_ext,&__pyx_n_s__peptideScore_ext,&__pyx_n_s__neighbors,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__iterations)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__box)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("extendSurface", 1, 5, 5, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 457; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__solventScore_ext)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("extendSurface", 1, 5, 5, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 457; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__peptideScore_ext)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("extendSurface", 1, 5, 5, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 457; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__neighbors)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("extendSurface", 1, 5, 5, 4);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 457; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "extendSurface") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 457; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 5) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
    }
    __pyx_v_iterations = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_iterations == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 457; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_box = ((PyArrayObject *)values[1]);
    __pyx_v_solventScore_ext = values[2];
    __pyx_v_peptideScore_ext = values[3];
    __pyx_v_neighbors = ((PyArrayObject *)values[4]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("extendSurface", 1, 5, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 457; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython.extendSurface", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_box), __pyx_ptype_5numpy_ndarray, 1, "box", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 457; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_neighbors), __pyx_ptype_5numpy_ndarray, 1, "neighbors", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 459; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_8epitopsy_6cython_9dx_cython_16extendSurface(__pyx_self, __pyx_v_iterations, __pyx_v_box, __pyx_v_solventScore_ext, __pyx_v_peptideScore_ext, __pyx_v_neighbors);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line456")'> 456: </pre>
<pre id='line456' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line457")'> 457: def extendSurface(int iterations, np.ndarray[np.float64_t, ndim=3] box,</pre>
<pre id='line457' class='code' style='background-color: #FFFF55'>
/* "epitopsy/cython/dx_cython.pyx":457
 *     return innerNodes
 * 
 * def extendSurface(int iterations, np.ndarray[np.float64_t, ndim=3] box,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         solventScore_ext, peptideScore_ext,
 *         np.ndarray[np.int64_t, ndim = 2] neighbors):
 */

static PyObject *__pyx_pf_8epitopsy_6cython_9dx_cython_16extendSurface(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_iterations, PyArrayObject *__pyx_v_box, PyObject *__pyx_v_solventScore_ext, PyObject *__pyx_v_peptideScore_ext, PyArrayObject *__pyx_v_neighbors) {
  CYTHON_UNUSED int __pyx_v_i;
  int __pyx_v_s;
  int __pyx_v_n;
  CYTHON_UNUSED int __pyx_v_neighbor_elements;
  int __pyx_v_nx;
  int __pyx_v_ny;
  int __pyx_v_nz;
  int __pyx_v_xdim;
  int __pyx_v_ydim;
  int __pyx_v_zdim;
  float __pyx_v_solventScore;
  float __pyx_v_peptideScore;
  PyArrayObject *__pyx_v_surface_nodes = 0;
  PyArrayObject *__pyx_v_next_neighbors = 0;
  PyObject *__pyx_v_newSurfaceNodes = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_box;
  __Pyx_Buffer __pyx_pybuffer_box;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_neighbors;
  __Pyx_Buffer __pyx_pybuffer_neighbors;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_next_neighbors;
  __Pyx_Buffer __pyx_pybuffer_next_neighbors;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_surface_nodes;
  __Pyx_Buffer __pyx_pybuffer_surface_nodes;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("extendSurface", 0);
  __pyx_pybuffer_surface_nodes.pybuffer.buf = NULL;
  __pyx_pybuffer_surface_nodes.refcount = 0;
  __pyx_pybuffernd_surface_nodes.data = NULL;
  __pyx_pybuffernd_surface_nodes.rcbuffer = &__pyx_pybuffer_surface_nodes;
  __pyx_pybuffer_next_neighbors.pybuffer.buf = NULL;
  __pyx_pybuffer_next_neighbors.refcount = 0;
  __pyx_pybuffernd_next_neighbors.data = NULL;
  __pyx_pybuffernd_next_neighbors.rcbuffer = &__pyx_pybuffer_next_neighbors;
  __pyx_pybuffer_box.pybuffer.buf = NULL;
  __pyx_pybuffer_box.refcount = 0;
  __pyx_pybuffernd_box.data = NULL;
  __pyx_pybuffernd_box.rcbuffer = &__pyx_pybuffer_box;
  __pyx_pybuffer_neighbors.pybuffer.buf = NULL;
  __pyx_pybuffer_neighbors.refcount = 0;
  __pyx_pybuffernd_neighbors.data = NULL;
  __pyx_pybuffernd_neighbors.rcbuffer = &__pyx_pybuffer_neighbors;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer, (PyObject*)__pyx_v_box, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 3, 0, __pyx_stack) == -1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 457; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_box.diminfo[0].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_box.diminfo[0].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_box.diminfo[1].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_box.diminfo[1].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_box.diminfo[2].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_box.diminfo[2].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[2];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_neighbors.rcbuffer->pybuffer, (PyObject*)__pyx_v_neighbors, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 457; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_neighbors.diminfo[0].strides = __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_neighbors.diminfo[0].shape = __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_neighbors.diminfo[1].strides = __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_neighbors.diminfo[1].shape = __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.shape[1];

  /* "epitopsy/cython/dx_cython.pyx":457
 *     return innerNodes
 * 
 * def extendSurface(int iterations, np.ndarray[np.float64_t, ndim=3] box,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         solventScore_ext, peptideScore_ext,
 *         np.ndarray[np.int64_t, ndim = 2] neighbors):
 */
  __pyx_k_tuple_126 = <span class='py_c_api'>PyTuple_Pack</span>(20, ((PyObject *)__pyx_n_s__iterations), ((PyObject *)__pyx_n_s__box), ((PyObject *)__pyx_n_s__solventScore_ext), ((PyObject *)__pyx_n_s__peptideScore_ext), ((PyObject *)__pyx_n_s__neighbors), ((PyObject *)__pyx_n_s__i), ((PyObject *)__pyx_n_s__s), ((PyObject *)__pyx_n_s__n), ((PyObject *)__pyx_n_s__neighbor_elements), ((PyObject *)__pyx_n_s__nx), ((PyObject *)__pyx_n_s__ny), ((PyObject *)__pyx_n_s__nz), ((PyObject *)__pyx_n_s__xdim), ((PyObject *)__pyx_n_s__ydim), ((PyObject *)__pyx_n_s__zdim), ((PyObject *)__pyx_n_s__solventScore), ((PyObject *)__pyx_n_s__peptideScore), ((PyObject *)__pyx_n_s__surface_nodes), ((PyObject *)__pyx_n_s__next_neighbors), ((PyObject *)__pyx_n_s__newSurfaceNodes));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_126)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 457; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_126);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_126));

  /* "epitopsy/cython/dx_cython.pyx":457
 *     return innerNodes
 * 
 * def extendSurface(int iterations, np.ndarray[np.float64_t, ndim=3] box,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         solventScore_ext, peptideScore_ext,
 *         np.ndarray[np.int64_t, ndim = 2] neighbors):
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_8epitopsy_6cython_9dx_cython_17extendSurface, NULL, __pyx_n_s_110);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 457; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__extendSurface, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 457; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_127 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(5, 0, 20, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_126, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_109, __pyx_n_s__extendSurface, 457, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_127)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 457; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line458")'> 458:         solventScore_ext, peptideScore_ext,</pre>
<pre id='line458' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line459")'> 459:         np.ndarray[np.int64_t, ndim = 2] neighbors):</pre>
<pre id='line459' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line460")'> 460:     cdef int i, s, n</pre>
<pre id='line460' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line461")'> 461:     cdef int neighbor_elements = len(neighbors)</pre>
<pre id='line461' class='code' style='background-color: #FFFFaa'>
  /* "epitopsy/cython/dx_cython.pyx":461
 *         np.ndarray[np.int64_t, ndim = 2] neighbors):
 *     cdef int i, s, n
 *     cdef int neighbor_elements = len(neighbors)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int nx, ny, nz
 *     cdef int xdim = box.shape[0]
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_Length</span>(((PyObject *)__pyx_v_neighbors));<span class='error_goto'> if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 461; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_neighbor_elements = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line462")'> 462:     cdef int nx, ny, nz</pre>
<pre id='line462' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line463")'> 463:     cdef int xdim = box.shape[0]</pre>
<pre id='line463' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":463
 *     cdef int neighbor_elements = len(neighbors)
 *     cdef int nx, ny, nz
 *     cdef int xdim = box.shape[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int ydim = box.shape[1]
 *     cdef int zdim = box.shape[2]
 */
  __pyx_v_xdim = (__pyx_v_box->dimensions[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line464")'> 464:     cdef int ydim = box.shape[1]</pre>
<pre id='line464' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":464
 *     cdef int nx, ny, nz
 *     cdef int xdim = box.shape[0]
 *     cdef int ydim = box.shape[1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int zdim = box.shape[2]
 *     cdef float solventScore = <code><</code>float> solventScore_ext
 */
  __pyx_v_ydim = (__pyx_v_box->dimensions[1]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line465")'> 465:     cdef int zdim = box.shape[2]</pre>
<pre id='line465' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":465
 *     cdef int xdim = box.shape[0]
 *     cdef int ydim = box.shape[1]
 *     cdef int zdim = box.shape[2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef float solventScore = <code><</code>float> solventScore_ext
 *     cdef float peptideScore = <code><</code>float> peptideScore_ext
 */
  __pyx_v_zdim = (__pyx_v_box->dimensions[2]);
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line466")'> 466:     cdef float solventScore = &lt;float&gt; solventScore_ext</pre>
<pre id='line466' class='code' style='background-color: #FFFF7f'>
  /* "epitopsy/cython/dx_cython.pyx":466
 *     cdef int ydim = box.shape[1]
 *     cdef int zdim = box.shape[2]
 *     cdef float solventScore = <code><</code>float> solventScore_ext             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef float peptideScore = <code><</code>float> peptideScore_ext
 *     cdef np.ndarray[np.int64_t, ndim = 2] surface_nodes
 */
  __pyx_t_2 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_solventScore_ext);<span class='error_goto'> if (unlikely((__pyx_t_2 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 466; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_solventScore = ((float)__pyx_t_2);
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line467")'> 467:     cdef float peptideScore = &lt;float&gt; peptideScore_ext</pre>
<pre id='line467' class='code' style='background-color: #FFFF7f'>
  /* "epitopsy/cython/dx_cython.pyx":467
 *     cdef int zdim = box.shape[2]
 *     cdef float solventScore = <code><</code>float> solventScore_ext
 *     cdef float peptideScore = <code><</code>float> peptideScore_ext             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.ndarray[np.int64_t, ndim = 2] surface_nodes
 *     cdef np.ndarray[np.int64_t, ndim = 2] next_neighbors = np.zeros([6, 3], dtype = np.int64)
 */
  __pyx_t_2 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_peptideScore_ext);<span class='error_goto'> if (unlikely((__pyx_t_2 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 467; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_peptideScore = ((float)__pyx_t_2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line468")'> 468:     cdef np.ndarray[np.int64_t, ndim = 2] surface_nodes</pre>
<pre id='line468' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF27' onclick='toggleDiv("line469")'> 469:     cdef np.ndarray[np.int64_t, ndim = 2] next_neighbors = np.zeros([6, 3], dtype = np.int64)</pre>
<pre id='line469' class='code' style='background-color: #FFFF27'>
  /* "epitopsy/cython/dx_cython.pyx":469
 *     cdef float peptideScore = <code><</code>float> peptideScore_ext
 *     cdef np.ndarray[np.int64_t, ndim = 2] surface_nodes
 *     cdef np.ndarray[np.int64_t, ndim = 2] next_neighbors = np.zeros([6, 3], dtype = np.int64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     # [-1, 0, 0]
 *     next_neighbors[0, 0] = -1
 */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 469; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s__zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 469; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 469; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_6);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_int_6);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_3);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 469; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, ((PyObject *)__pyx_t_3));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_3));
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 469; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 469; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  __pyx_t_7 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s__int64);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 469; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, ((PyObject *)__pyx_n_s__dtype), __pyx_t_7) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 469; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_4, ((PyObject *)__pyx_t_5), ((PyObject *)__pyx_t_3));<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 469; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_7) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_7, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 469; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_7);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer, (PyObject*)__pyx_t_8, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_next_neighbors = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer.buf = NULL;
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 469; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_next_neighbors.diminfo[0].strides = __pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_next_neighbors.diminfo[0].shape = __pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_next_neighbors.diminfo[1].strides = __pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_next_neighbors.diminfo[1].shape = __pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_8 = 0;
  __pyx_v_next_neighbors = ((PyArrayObject *)__pyx_t_7);
  __pyx_t_7 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line470")'> 470:     # [-1, 0, 0]</pre>
<pre id='line470' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line471")'> 471:     next_neighbors[0, 0] = -1</pre>
<pre id='line471' class='code' style='background-color: #FFFFd4'>
  /* "epitopsy/cython/dx_cython.pyx":471
 *     cdef np.ndarray[np.int64_t, ndim = 2] next_neighbors = np.zeros([6, 3], dtype = np.int64)
 *     # [-1, 0, 0]
 *     next_neighbors[0, 0] = -1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     # [0, -1, 0]
 *     next_neighbors[1, 1] = -1
 */
  __pyx_t_9 = 0;
  __pyx_t_10 = 0;
  __pyx_t_11 = -1;
  if (__pyx_t_9 <code><</code> 0) {
    __pyx_t_9 += __pyx_pybuffernd_next_neighbors.diminfo[0].shape;
    if (unlikely(__pyx_t_9 <code><</code> 0)) __pyx_t_11 = 0;
  } else if (unlikely(__pyx_t_9 >= __pyx_pybuffernd_next_neighbors.diminfo[0].shape)) __pyx_t_11 = 0;
  if (__pyx_t_10 <code><</code> 0) {
    __pyx_t_10 += __pyx_pybuffernd_next_neighbors.diminfo[1].shape;
    if (unlikely(__pyx_t_10 <code><</code> 0)) __pyx_t_11 = 1;
  } else if (unlikely(__pyx_t_10 >= __pyx_pybuffernd_next_neighbors.diminfo[1].shape)) __pyx_t_11 = 1;
  if (unlikely(__pyx_t_11 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer.buf, __pyx_t_9, __pyx_pybuffernd_next_neighbors.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_next_neighbors.diminfo[1].strides) = -1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line472")'> 472:     # [0, -1, 0]</pre>
<pre id='line472' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line473")'> 473:     next_neighbors[1, 1] = -1</pre>
<pre id='line473' class='code' style='background-color: #FFFFd4'>
  /* "epitopsy/cython/dx_cython.pyx":473
 *     next_neighbors[0, 0] = -1
 *     # [0, -1, 0]
 *     next_neighbors[1, 1] = -1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     # [0, 0, -1]
 *     next_neighbors[2, 2] = -1
 */
  __pyx_t_12 = 1;
  __pyx_t_13 = 1;
  __pyx_t_11 = -1;
  if (__pyx_t_12 <code><</code> 0) {
    __pyx_t_12 += __pyx_pybuffernd_next_neighbors.diminfo[0].shape;
    if (unlikely(__pyx_t_12 <code><</code> 0)) __pyx_t_11 = 0;
  } else if (unlikely(__pyx_t_12 >= __pyx_pybuffernd_next_neighbors.diminfo[0].shape)) __pyx_t_11 = 0;
  if (__pyx_t_13 <code><</code> 0) {
    __pyx_t_13 += __pyx_pybuffernd_next_neighbors.diminfo[1].shape;
    if (unlikely(__pyx_t_13 <code><</code> 0)) __pyx_t_11 = 1;
  } else if (unlikely(__pyx_t_13 >= __pyx_pybuffernd_next_neighbors.diminfo[1].shape)) __pyx_t_11 = 1;
  if (unlikely(__pyx_t_11 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 473; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_next_neighbors.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_next_neighbors.diminfo[1].strides) = -1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line474")'> 474:     # [0, 0, -1]</pre>
<pre id='line474' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line475")'> 475:     next_neighbors[2, 2] = -1</pre>
<pre id='line475' class='code' style='background-color: #FFFFd4'>
  /* "epitopsy/cython/dx_cython.pyx":475
 *     next_neighbors[1, 1] = -1
 *     # [0, 0, -1]
 *     next_neighbors[2, 2] = -1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     # [1, 0, 0]
 *     next_neighbors[3, 0] = 1
 */
  __pyx_t_14 = 2;
  __pyx_t_15 = 2;
  __pyx_t_11 = -1;
  if (__pyx_t_14 <code><</code> 0) {
    __pyx_t_14 += __pyx_pybuffernd_next_neighbors.diminfo[0].shape;
    if (unlikely(__pyx_t_14 <code><</code> 0)) __pyx_t_11 = 0;
  } else if (unlikely(__pyx_t_14 >= __pyx_pybuffernd_next_neighbors.diminfo[0].shape)) __pyx_t_11 = 0;
  if (__pyx_t_15 <code><</code> 0) {
    __pyx_t_15 += __pyx_pybuffernd_next_neighbors.diminfo[1].shape;
    if (unlikely(__pyx_t_15 <code><</code> 0)) __pyx_t_11 = 1;
  } else if (unlikely(__pyx_t_15 >= __pyx_pybuffernd_next_neighbors.diminfo[1].shape)) __pyx_t_11 = 1;
  if (unlikely(__pyx_t_11 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 475; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_next_neighbors.diminfo[0].strides, __pyx_t_15, __pyx_pybuffernd_next_neighbors.diminfo[1].strides) = -1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line476")'> 476:     # [1, 0, 0]</pre>
<pre id='line476' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line477")'> 477:     next_neighbors[3, 0] = 1</pre>
<pre id='line477' class='code' style='background-color: #FFFFd4'>
  /* "epitopsy/cython/dx_cython.pyx":477
 *     next_neighbors[2, 2] = -1
 *     # [1, 0, 0]
 *     next_neighbors[3, 0] = 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     # [0, 1, 0]
 *     next_neighbors[4, 1] = 1
 */
  __pyx_t_16 = 3;
  __pyx_t_17 = 0;
  __pyx_t_11 = -1;
  if (__pyx_t_16 <code><</code> 0) {
    __pyx_t_16 += __pyx_pybuffernd_next_neighbors.diminfo[0].shape;
    if (unlikely(__pyx_t_16 <code><</code> 0)) __pyx_t_11 = 0;
  } else if (unlikely(__pyx_t_16 >= __pyx_pybuffernd_next_neighbors.diminfo[0].shape)) __pyx_t_11 = 0;
  if (__pyx_t_17 <code><</code> 0) {
    __pyx_t_17 += __pyx_pybuffernd_next_neighbors.diminfo[1].shape;
    if (unlikely(__pyx_t_17 <code><</code> 0)) __pyx_t_11 = 1;
  } else if (unlikely(__pyx_t_17 >= __pyx_pybuffernd_next_neighbors.diminfo[1].shape)) __pyx_t_11 = 1;
  if (unlikely(__pyx_t_11 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 477; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_next_neighbors.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_next_neighbors.diminfo[1].strides) = 1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line478")'> 478:     # [0, 1, 0]</pre>
<pre id='line478' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line479")'> 479:     next_neighbors[4, 1] = 1</pre>
<pre id='line479' class='code' style='background-color: #FFFFd4'>
  /* "epitopsy/cython/dx_cython.pyx":479
 *     next_neighbors[3, 0] = 1
 *     # [0, 1, 0]
 *     next_neighbors[4, 1] = 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     # [0, 0, 1]
 *     next_neighbors[5, 2] = 1
 */
  __pyx_t_18 = 4;
  __pyx_t_19 = 1;
  __pyx_t_11 = -1;
  if (__pyx_t_18 <code><</code> 0) {
    __pyx_t_18 += __pyx_pybuffernd_next_neighbors.diminfo[0].shape;
    if (unlikely(__pyx_t_18 <code><</code> 0)) __pyx_t_11 = 0;
  } else if (unlikely(__pyx_t_18 >= __pyx_pybuffernd_next_neighbors.diminfo[0].shape)) __pyx_t_11 = 0;
  if (__pyx_t_19 <code><</code> 0) {
    __pyx_t_19 += __pyx_pybuffernd_next_neighbors.diminfo[1].shape;
    if (unlikely(__pyx_t_19 <code><</code> 0)) __pyx_t_11 = 1;
  } else if (unlikely(__pyx_t_19 >= __pyx_pybuffernd_next_neighbors.diminfo[1].shape)) __pyx_t_11 = 1;
  if (unlikely(__pyx_t_11 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_next_neighbors.diminfo[0].strides, __pyx_t_19, __pyx_pybuffernd_next_neighbors.diminfo[1].strides) = 1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line480")'> 480:     # [0, 0, 1]</pre>
<pre id='line480' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line481")'> 481:     next_neighbors[5, 2] = 1</pre>
<pre id='line481' class='code' style='background-color: #FFFFd4'>
  /* "epitopsy/cython/dx_cython.pyx":481
 *     next_neighbors[4, 1] = 1
 *     # [0, 0, 1]
 *     next_neighbors[5, 2] = 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     if iterations>0:
 *         surface_nodes = np.array(determine_actual_surface_nodes(box, solventScore_ext, neighbors),dtype=np.int64)
 */
  __pyx_t_20 = 5;
  __pyx_t_21 = 2;
  __pyx_t_11 = -1;
  if (__pyx_t_20 <code><</code> 0) {
    __pyx_t_20 += __pyx_pybuffernd_next_neighbors.diminfo[0].shape;
    if (unlikely(__pyx_t_20 <code><</code> 0)) __pyx_t_11 = 0;
  } else if (unlikely(__pyx_t_20 >= __pyx_pybuffernd_next_neighbors.diminfo[0].shape)) __pyx_t_11 = 0;
  if (__pyx_t_21 <code><</code> 0) {
    __pyx_t_21 += __pyx_pybuffernd_next_neighbors.diminfo[1].shape;
    if (unlikely(__pyx_t_21 <code><</code> 0)) __pyx_t_11 = 1;
  } else if (unlikely(__pyx_t_21 >= __pyx_pybuffernd_next_neighbors.diminfo[1].shape)) __pyx_t_11 = 1;
  if (unlikely(__pyx_t_11 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 481; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_next_neighbors.diminfo[0].strides, __pyx_t_21, __pyx_pybuffernd_next_neighbors.diminfo[1].strides) = 1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line482")'> 482:     if iterations&gt;0:</pre>
<pre id='line482' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":482
 *     # [0, 0, 1]
 *     next_neighbors[5, 2] = 1
 *     if iterations>0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         surface_nodes = np.array(determine_actual_surface_nodes(box, solventScore_ext, neighbors),dtype=np.int64)
 *         for i from 0<code><</code>= i <code><</code> iterations:
 */
  __pyx_t_22 = ((__pyx_v_iterations > 0) != 0);
  if (__pyx_t_22) {
</pre><pre class='line' style='background-color: #FFFF1c' onclick='toggleDiv("line483")'> 483:         surface_nodes = np.array(determine_actual_surface_nodes(box, solventScore_ext, neighbors),dtype=np.int64)</pre>
<pre id='line483' class='code' style='background-color: #FFFF1c'>
    /* "epitopsy/cython/dx_cython.pyx":483
 *     next_neighbors[5, 2] = 1
 *     if iterations>0:
 *         surface_nodes = np.array(determine_actual_surface_nodes(box, solventScore_ext, neighbors),dtype=np.int64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for i from 0<code><</code>= i <code><</code> iterations:
 *             newSurfaceNodes = []
 */
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 483; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
    __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s__array);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 483; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_58);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 483; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 483; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_box));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, ((PyObject *)__pyx_v_box));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_box));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_solventScore_ext);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_v_solventScore_ext);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_solventScore_ext);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_neighbors));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, ((PyObject *)__pyx_v_neighbors));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_neighbors));
    __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_7, ((PyObject *)__pyx_t_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 483; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 483; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 483; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_4));
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 483; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
    __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s__int64);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 483; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, ((PyObject *)__pyx_n_s__dtype), __pyx_t_6) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 483; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_5), ((PyObject *)__pyx_t_4));<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 483; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 483; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_23 = ((PyArrayObject *)__pyx_t_6);
    {
      __Pyx_BufFmt_StackElem __pyx_stack[1];
      <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_surface_nodes.rcbuffer->pybuffer);
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_surface_nodes.rcbuffer->pybuffer, (PyObject*)__pyx_t_23, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
      if (unlikely(__pyx_t_11 <code><</code> 0)) {
        <span class='py_c_api'>PyErr_Fetch</span>(&__pyx_t_24, &__pyx_t_25, &__pyx_t_26);
        if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_surface_nodes.rcbuffer->pybuffer, (PyObject*)__pyx_v_surface_nodes, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
          Py_XDECREF(__pyx_t_24); Py_XDECREF(__pyx_t_25); Py_XDECREF(__pyx_t_26);
          <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
        } else {
          <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_24, __pyx_t_25, __pyx_t_26);
        }
      }
      __pyx_pybuffernd_surface_nodes.diminfo[0].strides = __pyx_pybuffernd_surface_nodes.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_surface_nodes.diminfo[0].shape = __pyx_pybuffernd_surface_nodes.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_surface_nodes.diminfo[1].strides = __pyx_pybuffernd_surface_nodes.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_surface_nodes.diminfo[1].shape = __pyx_pybuffernd_surface_nodes.rcbuffer->pybuffer.shape[1];
      if (unlikely(__pyx_t_11 <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 483; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_23 = 0;
    __pyx_v_surface_nodes = ((PyArrayObject *)__pyx_t_6);
    __pyx_t_6 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line484")'> 484:         for i from 0&lt;= i &lt; iterations:</pre>
<pre id='line484' class='code' style='background-color: #FFFFff'>
    /* "epitopsy/cython/dx_cython.pyx":484
 *     if iterations>0:
 *         surface_nodes = np.array(determine_actual_surface_nodes(box, solventScore_ext, neighbors),dtype=np.int64)
 *         for i from 0<code><</code>= i <code><</code> iterations:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             newSurfaceNodes = []
 *             for s from 0<code><</code>= s <code><</code> len(surface_nodes):
 */
    __pyx_t_11 = __pyx_v_iterations;
    for (__pyx_v_i = 0; __pyx_v_i <code><</code> __pyx_t_11; __pyx_v_i++) {
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line485")'> 485:             newSurfaceNodes = []</pre>
<pre id='line485' class='code' style='background-color: #FFFF9f'>
      /* "epitopsy/cython/dx_cython.pyx":485
 *         surface_nodes = np.array(determine_actual_surface_nodes(box, solventScore_ext, neighbors),dtype=np.int64)
 *         for i from 0<code><</code>= i <code><</code> iterations:
 *             newSurfaceNodes = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for s from 0<code><</code>= s <code><</code> len(surface_nodes):
 *                 # check only next neighbors
 */
      __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 485; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_v_newSurfaceNodes));
      __pyx_v_newSurfaceNodes = ((PyObject*)__pyx_t_6);
      __pyx_t_6 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line486")'> 486:             for s from 0&lt;= s &lt; len(surface_nodes):</pre>
<pre id='line486' class='code' style='background-color: #FFFFaa'>
      /* "epitopsy/cython/dx_cython.pyx":486
 *         for i from 0<code><</code>= i <code><</code> iterations:
 *             newSurfaceNodes = []
 *             for s from 0<code><</code>= s <code><</code> len(surface_nodes):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 # check only next neighbors
 *                 for n from 0 <code><</code>= n <code><</code> 6:
 */
      __pyx_t_1 = <span class='py_c_api'>PyObject_Length</span>(((PyObject *)__pyx_v_surface_nodes));<span class='error_goto'> if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      for (__pyx_v_s = 0; __pyx_v_s <code><</code> __pyx_t_1; __pyx_v_s++) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line487")'> 487:                 # check only next neighbors</pre>
<pre id='line487' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line488")'> 488:                 for n from 0 &lt;= n &lt; 6:</pre>
<pre id='line488' class='code' style='background-color: #FFFFff'>
        /* "epitopsy/cython/dx_cython.pyx":488
 *             for s from 0<code><</code>= s <code><</code> len(surface_nodes):
 *                 # check only next neighbors
 *                 for n from 0 <code><</code>= n <code><</code> 6:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     nx = surface_nodes[s,0] + next_neighbors[n,0]
 *                     ny = surface_nodes[s,1] + next_neighbors[n,1]
 */
        for (__pyx_v_n = 0; __pyx_v_n <code><</code> 6; __pyx_v_n++) {
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line489")'> 489:                     nx = surface_nodes[s,0] + next_neighbors[n,0]</pre>
<pre id='line489' class='code' style='background-color: #FFFFb6'>
          /* "epitopsy/cython/dx_cython.pyx":489
 *                 # check only next neighbors
 *                 for n from 0 <code><</code>= n <code><</code> 6:
 *                     nx = surface_nodes[s,0] + next_neighbors[n,0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     ny = surface_nodes[s,1] + next_neighbors[n,1]
 *                     nz = surface_nodes[s,2] + next_neighbors[n,2]
 */
          __pyx_t_27 = __pyx_v_s;
          __pyx_t_28 = 0;
          __pyx_t_29 = -1;
          if (__pyx_t_27 <code><</code> 0) {
            __pyx_t_27 += __pyx_pybuffernd_surface_nodes.diminfo[0].shape;
            if (unlikely(__pyx_t_27 <code><</code> 0)) __pyx_t_29 = 0;
          } else if (unlikely(__pyx_t_27 >= __pyx_pybuffernd_surface_nodes.diminfo[0].shape)) __pyx_t_29 = 0;
          if (__pyx_t_28 <code><</code> 0) {
            __pyx_t_28 += __pyx_pybuffernd_surface_nodes.diminfo[1].shape;
            if (unlikely(__pyx_t_28 <code><</code> 0)) __pyx_t_29 = 1;
          } else if (unlikely(__pyx_t_28 >= __pyx_pybuffernd_surface_nodes.diminfo[1].shape)) __pyx_t_29 = 1;
          if (unlikely(__pyx_t_29 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_29);
           <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_t_29 = __pyx_v_n;
          __pyx_t_30 = 0;
          __pyx_t_31 = -1;
          if (__pyx_t_29 <code><</code> 0) {
            __pyx_t_29 += __pyx_pybuffernd_next_neighbors.diminfo[0].shape;
            if (unlikely(__pyx_t_29 <code><</code> 0)) __pyx_t_31 = 0;
          } else if (unlikely(__pyx_t_29 >= __pyx_pybuffernd_next_neighbors.diminfo[0].shape)) __pyx_t_31 = 0;
          if (__pyx_t_30 <code><</code> 0) {
            __pyx_t_30 += __pyx_pybuffernd_next_neighbors.diminfo[1].shape;
            if (unlikely(__pyx_t_30 <code><</code> 0)) __pyx_t_31 = 1;
          } else if (unlikely(__pyx_t_30 >= __pyx_pybuffernd_next_neighbors.diminfo[1].shape)) __pyx_t_31 = 1;
          if (unlikely(__pyx_t_31 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_31);
           <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_v_nx = ((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_surface_nodes.rcbuffer->pybuffer.buf, __pyx_t_27, __pyx_pybuffernd_surface_nodes.diminfo[0].strides, __pyx_t_28, __pyx_pybuffernd_surface_nodes.diminfo[1].strides)) + (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer.buf, __pyx_t_29, __pyx_pybuffernd_next_neighbors.diminfo[0].strides, __pyx_t_30, __pyx_pybuffernd_next_neighbors.diminfo[1].strides)));
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line490")'> 490:                     ny = surface_nodes[s,1] + next_neighbors[n,1]</pre>
<pre id='line490' class='code' style='background-color: #FFFFb6'>
          /* "epitopsy/cython/dx_cython.pyx":490
 *                 for n from 0 <code><</code>= n <code><</code> 6:
 *                     nx = surface_nodes[s,0] + next_neighbors[n,0]
 *                     ny = surface_nodes[s,1] + next_neighbors[n,1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     nz = surface_nodes[s,2] + next_neighbors[n,2]
 *                     if (nx >= 0 and nx <code><</code> xdim and ny >= 0 and ny <code><</code> ydim and
 */
          __pyx_t_31 = __pyx_v_s;
          __pyx_t_32 = 1;
          __pyx_t_33 = -1;
          if (__pyx_t_31 <code><</code> 0) {
            __pyx_t_31 += __pyx_pybuffernd_surface_nodes.diminfo[0].shape;
            if (unlikely(__pyx_t_31 <code><</code> 0)) __pyx_t_33 = 0;
          } else if (unlikely(__pyx_t_31 >= __pyx_pybuffernd_surface_nodes.diminfo[0].shape)) __pyx_t_33 = 0;
          if (__pyx_t_32 <code><</code> 0) {
            __pyx_t_32 += __pyx_pybuffernd_surface_nodes.diminfo[1].shape;
            if (unlikely(__pyx_t_32 <code><</code> 0)) __pyx_t_33 = 1;
          } else if (unlikely(__pyx_t_32 >= __pyx_pybuffernd_surface_nodes.diminfo[1].shape)) __pyx_t_33 = 1;
          if (unlikely(__pyx_t_33 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_33);
           <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 490; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_t_33 = __pyx_v_n;
          __pyx_t_34 = 1;
          __pyx_t_35 = -1;
          if (__pyx_t_33 <code><</code> 0) {
            __pyx_t_33 += __pyx_pybuffernd_next_neighbors.diminfo[0].shape;
            if (unlikely(__pyx_t_33 <code><</code> 0)) __pyx_t_35 = 0;
          } else if (unlikely(__pyx_t_33 >= __pyx_pybuffernd_next_neighbors.diminfo[0].shape)) __pyx_t_35 = 0;
          if (__pyx_t_34 <code><</code> 0) {
            __pyx_t_34 += __pyx_pybuffernd_next_neighbors.diminfo[1].shape;
            if (unlikely(__pyx_t_34 <code><</code> 0)) __pyx_t_35 = 1;
          } else if (unlikely(__pyx_t_34 >= __pyx_pybuffernd_next_neighbors.diminfo[1].shape)) __pyx_t_35 = 1;
          if (unlikely(__pyx_t_35 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_35);
           <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 490; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_v_ny = ((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_surface_nodes.rcbuffer->pybuffer.buf, __pyx_t_31, __pyx_pybuffernd_surface_nodes.diminfo[0].strides, __pyx_t_32, __pyx_pybuffernd_surface_nodes.diminfo[1].strides)) + (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer.buf, __pyx_t_33, __pyx_pybuffernd_next_neighbors.diminfo[0].strides, __pyx_t_34, __pyx_pybuffernd_next_neighbors.diminfo[1].strides)));
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line491")'> 491:                     nz = surface_nodes[s,2] + next_neighbors[n,2]</pre>
<pre id='line491' class='code' style='background-color: #FFFFb6'>
          /* "epitopsy/cython/dx_cython.pyx":491
 *                     nx = surface_nodes[s,0] + next_neighbors[n,0]
 *                     ny = surface_nodes[s,1] + next_neighbors[n,1]
 *                     nz = surface_nodes[s,2] + next_neighbors[n,2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     if (nx >= 0 and nx <code><</code> xdim and ny >= 0 and ny <code><</code> ydim and
 *                         nz >= 0 and nz <code><</code> zdim):
 */
          __pyx_t_35 = __pyx_v_s;
          __pyx_t_36 = 2;
          __pyx_t_37 = -1;
          if (__pyx_t_35 <code><</code> 0) {
            __pyx_t_35 += __pyx_pybuffernd_surface_nodes.diminfo[0].shape;
            if (unlikely(__pyx_t_35 <code><</code> 0)) __pyx_t_37 = 0;
          } else if (unlikely(__pyx_t_35 >= __pyx_pybuffernd_surface_nodes.diminfo[0].shape)) __pyx_t_37 = 0;
          if (__pyx_t_36 <code><</code> 0) {
            __pyx_t_36 += __pyx_pybuffernd_surface_nodes.diminfo[1].shape;
            if (unlikely(__pyx_t_36 <code><</code> 0)) __pyx_t_37 = 1;
          } else if (unlikely(__pyx_t_36 >= __pyx_pybuffernd_surface_nodes.diminfo[1].shape)) __pyx_t_37 = 1;
          if (unlikely(__pyx_t_37 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_37);
           <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_t_37 = __pyx_v_n;
          __pyx_t_38 = 2;
          __pyx_t_39 = -1;
          if (__pyx_t_37 <code><</code> 0) {
            __pyx_t_37 += __pyx_pybuffernd_next_neighbors.diminfo[0].shape;
            if (unlikely(__pyx_t_37 <code><</code> 0)) __pyx_t_39 = 0;
          } else if (unlikely(__pyx_t_37 >= __pyx_pybuffernd_next_neighbors.diminfo[0].shape)) __pyx_t_39 = 0;
          if (__pyx_t_38 <code><</code> 0) {
            __pyx_t_38 += __pyx_pybuffernd_next_neighbors.diminfo[1].shape;
            if (unlikely(__pyx_t_38 <code><</code> 0)) __pyx_t_39 = 1;
          } else if (unlikely(__pyx_t_38 >= __pyx_pybuffernd_next_neighbors.diminfo[1].shape)) __pyx_t_39 = 1;
          if (unlikely(__pyx_t_39 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_39);
           <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_v_nz = ((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_surface_nodes.rcbuffer->pybuffer.buf, __pyx_t_35, __pyx_pybuffernd_surface_nodes.diminfo[0].strides, __pyx_t_36, __pyx_pybuffernd_surface_nodes.diminfo[1].strides)) + (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer.buf, __pyx_t_37, __pyx_pybuffernd_next_neighbors.diminfo[0].strides, __pyx_t_38, __pyx_pybuffernd_next_neighbors.diminfo[1].strides)));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line492")'> 492:                     if (nx &gt;= 0 and nx &lt; xdim and ny &gt;= 0 and ny &lt; ydim and</pre>
<pre id='line492' class='code' style='background-color: #FFFFff'>
          /* "epitopsy/cython/dx_cython.pyx":492
 *                     ny = surface_nodes[s,1] + next_neighbors[n,1]
 *                     nz = surface_nodes[s,2] + next_neighbors[n,2]
 *                     if (nx >= 0 and nx <code><</code> xdim and ny >= 0 and ny <code><</code> ydim and             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         nz >= 0 and nz <code><</code> zdim):
 *                         if box[nx, ny, nz] == solventScore:
 */
          __pyx_t_22 = ((__pyx_v_nx >= 0) != 0);
          if (__pyx_t_22) {
            __pyx_t_40 = ((__pyx_v_nx <code><</code> __pyx_v_xdim) != 0);
            if (__pyx_t_40) {
              __pyx_t_41 = ((__pyx_v_ny >= 0) != 0);
              if (__pyx_t_41) {
                __pyx_t_42 = ((__pyx_v_ny <code><</code> __pyx_v_ydim) != 0);
                if (__pyx_t_42) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line493")'> 493:                         nz &gt;= 0 and nz &lt; zdim):</pre>
<pre id='line493' class='code' style='background-color: #FFFFff'>
                  /* "epitopsy/cython/dx_cython.pyx":493
 *                     nz = surface_nodes[s,2] + next_neighbors[n,2]
 *                     if (nx >= 0 and nx <code><</code> xdim and ny >= 0 and ny <code><</code> ydim and
 *                         nz >= 0 and nz <code><</code> zdim):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         if box[nx, ny, nz] == solventScore:
 *                                 box[nx, ny, nz] = peptideScore
 */
                  __pyx_t_43 = ((__pyx_v_nz >= 0) != 0);
                  if (__pyx_t_43) {
                    __pyx_t_44 = ((__pyx_v_nz <code><</code> __pyx_v_zdim) != 0);
                    __pyx_t_45 = __pyx_t_44;
                  } else {
                    __pyx_t_45 = __pyx_t_43;
                  }
                  __pyx_t_43 = __pyx_t_45;
                } else {
                  __pyx_t_43 = __pyx_t_42;
                }
                __pyx_t_42 = __pyx_t_43;
              } else {
                __pyx_t_42 = __pyx_t_41;
              }
              __pyx_t_41 = __pyx_t_42;
            } else {
              __pyx_t_41 = __pyx_t_40;
            }
            __pyx_t_40 = __pyx_t_41;
          } else {
            __pyx_t_40 = __pyx_t_22;
          }
          if (__pyx_t_40) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line494")'> 494:                         if box[nx, ny, nz] == solventScore:</pre>
<pre id='line494' class='code' style='background-color: #FFFFd4'>
            /* "epitopsy/cython/dx_cython.pyx":494
 *                     if (nx >= 0 and nx <code><</code> xdim and ny >= 0 and ny <code><</code> ydim and
 *                         nz >= 0 and nz <code><</code> zdim):
 *                         if box[nx, ny, nz] == solventScore:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 box[nx, ny, nz] = peptideScore
 *                                 newSurfaceNodes.append([nx, ny, nz])
 */
            __pyx_t_39 = __pyx_v_nx;
            __pyx_t_46 = __pyx_v_ny;
            __pyx_t_47 = __pyx_v_nz;
            __pyx_t_48 = -1;
            if (__pyx_t_39 <code><</code> 0) {
              __pyx_t_39 += __pyx_pybuffernd_box.diminfo[0].shape;
              if (unlikely(__pyx_t_39 <code><</code> 0)) __pyx_t_48 = 0;
            } else if (unlikely(__pyx_t_39 >= __pyx_pybuffernd_box.diminfo[0].shape)) __pyx_t_48 = 0;
            if (__pyx_t_46 <code><</code> 0) {
              __pyx_t_46 += __pyx_pybuffernd_box.diminfo[1].shape;
              if (unlikely(__pyx_t_46 <code><</code> 0)) __pyx_t_48 = 1;
            } else if (unlikely(__pyx_t_46 >= __pyx_pybuffernd_box.diminfo[1].shape)) __pyx_t_48 = 1;
            if (__pyx_t_47 <code><</code> 0) {
              __pyx_t_47 += __pyx_pybuffernd_box.diminfo[2].shape;
              if (unlikely(__pyx_t_47 <code><</code> 0)) __pyx_t_48 = 2;
            } else if (unlikely(__pyx_t_47 >= __pyx_pybuffernd_box.diminfo[2].shape)) __pyx_t_48 = 2;
            if (unlikely(__pyx_t_48 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_48);
             <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 494; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            __pyx_t_40 = (((*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_39, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_46, __pyx_pybuffernd_box.diminfo[1].strides, __pyx_t_47, __pyx_pybuffernd_box.diminfo[2].strides)) == __pyx_v_solventScore) != 0);
            if (__pyx_t_40) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line495")'> 495:                                 box[nx, ny, nz] = peptideScore</pre>
<pre id='line495' class='code' style='background-color: #FFFFd4'>
              /* "epitopsy/cython/dx_cython.pyx":495
 *                         nz >= 0 and nz <code><</code> zdim):
 *                         if box[nx, ny, nz] == solventScore:
 *                                 box[nx, ny, nz] = peptideScore             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 newSurfaceNodes.append([nx, ny, nz])
 *             if newSurfaceNodes == []:
 */
              __pyx_t_48 = __pyx_v_nx;
              __pyx_t_49 = __pyx_v_ny;
              __pyx_t_50 = __pyx_v_nz;
              __pyx_t_51 = -1;
              if (__pyx_t_48 <code><</code> 0) {
                __pyx_t_48 += __pyx_pybuffernd_box.diminfo[0].shape;
                if (unlikely(__pyx_t_48 <code><</code> 0)) __pyx_t_51 = 0;
              } else if (unlikely(__pyx_t_48 >= __pyx_pybuffernd_box.diminfo[0].shape)) __pyx_t_51 = 0;
              if (__pyx_t_49 <code><</code> 0) {
                __pyx_t_49 += __pyx_pybuffernd_box.diminfo[1].shape;
                if (unlikely(__pyx_t_49 <code><</code> 0)) __pyx_t_51 = 1;
              } else if (unlikely(__pyx_t_49 >= __pyx_pybuffernd_box.diminfo[1].shape)) __pyx_t_51 = 1;
              if (__pyx_t_50 <code><</code> 0) {
                __pyx_t_50 += __pyx_pybuffernd_box.diminfo[2].shape;
                if (unlikely(__pyx_t_50 <code><</code> 0)) __pyx_t_51 = 2;
              } else if (unlikely(__pyx_t_50 >= __pyx_pybuffernd_box.diminfo[2].shape)) __pyx_t_51 = 2;
              if (unlikely(__pyx_t_51 != -1)) {
                <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_51);
               <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 495; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              }
              *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_48, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_49, __pyx_pybuffernd_box.diminfo[1].strides, __pyx_t_50, __pyx_pybuffernd_box.diminfo[2].strides) = __pyx_v_peptideScore;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line496")'> 496:                                 newSurfaceNodes.append([nx, ny, nz])</pre>
<pre id='line496' class='code' style='background-color: #FFFF41'>
              /* "epitopsy/cython/dx_cython.pyx":496
 *                         if box[nx, ny, nz] == solventScore:
 *                                 box[nx, ny, nz] = peptideScore
 *                                 newSurfaceNodes.append([nx, ny, nz])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if newSurfaceNodes == []:
 *                 newSurfaceNodes.append([])
 */
              __pyx_t_6 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_nx);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 496; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
              __pyx_t_4 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_ny);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 496; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
              __pyx_t_5 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_nz);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 496; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
              __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 496; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
              <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_6);
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_6);
              <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4);
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
              <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 2, __pyx_t_5);
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_5);
              __pyx_t_6 = 0;
              __pyx_t_4 = 0;
              __pyx_t_5 = 0;
              __pyx_t_52 = __Pyx_<span class='py_c_api'>PyList_Append</span>(__pyx_v_newSurfaceNodes, ((PyObject *)__pyx_t_3));<span class='error_goto'> if (unlikely(__pyx_t_52 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 496; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
              goto __pyx_L11;
            }
            __pyx_L11:;
            goto __pyx_L10;
          }
          __pyx_L10:;
        }
      }
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line497")'> 497:             if newSurfaceNodes == []:</pre>
<pre id='line497' class='code' style='background-color: #FFFF5e'>
      /* "epitopsy/cython/dx_cython.pyx":497
 *                                 box[nx, ny, nz] = peptideScore
 *                                 newSurfaceNodes.append([nx, ny, nz])
 *             if newSurfaceNodes == []:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 newSurfaceNodes.append([])
 *             surface_nodes = np.array(newSurfaceNodes,dtype=np.int64)
 */
      __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 497; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(((PyObject *)__pyx_v_newSurfaceNodes), ((PyObject *)__pyx_t_3), Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 497; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      __pyx_t_40 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_40 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 497; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (__pyx_t_40) {
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line498")'> 498:                 newSurfaceNodes.append([])</pre>
<pre id='line498' class='code' style='background-color: #FFFF79'>
        /* "epitopsy/cython/dx_cython.pyx":498
 *                                 newSurfaceNodes.append([nx, ny, nz])
 *             if newSurfaceNodes == []:
 *                 newSurfaceNodes.append([])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             surface_nodes = np.array(newSurfaceNodes,dtype=np.int64)
 *     return box
 */
        __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
        __pyx_t_52 = __Pyx_<span class='py_c_api'>PyList_Append</span>(__pyx_v_newSurfaceNodes, ((PyObject *)__pyx_t_5));<span class='error_goto'> if (unlikely(__pyx_t_52 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
        goto __pyx_L12;
      }
      __pyx_L12:;
</pre><pre class='line' style='background-color: #FFFF22' onclick='toggleDiv("line499")'> 499:             surface_nodes = np.array(newSurfaceNodes,dtype=np.int64)</pre>
<pre id='line499' class='code' style='background-color: #FFFF22'>
      /* "epitopsy/cython/dx_cython.pyx":499
 *             if newSurfaceNodes == []:
 *                 newSurfaceNodes.append([])
 *             surface_nodes = np.array(newSurfaceNodes,dtype=np.int64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return box
 * 
 */
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
      __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s__array);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_newSurfaceNodes));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, ((PyObject *)__pyx_v_newSurfaceNodes));
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_newSurfaceNodes));
      __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_4));
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
      __pyx_t_7 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s__int64);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, ((PyObject *)__pyx_n_s__dtype), __pyx_t_7) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_5), ((PyObject *)__pyx_t_4));<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      if (!(likely(((__pyx_t_7) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_7, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_23 = ((PyArrayObject *)__pyx_t_7);
      {
        __Pyx_BufFmt_StackElem __pyx_stack[1];
        <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_surface_nodes.rcbuffer->pybuffer);
        __pyx_t_51 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_surface_nodes.rcbuffer->pybuffer, (PyObject*)__pyx_t_23, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
        if (unlikely(__pyx_t_51 <code><</code> 0)) {
          <span class='py_c_api'>PyErr_Fetch</span>(&__pyx_t_26, &__pyx_t_25, &__pyx_t_24);
          if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_surface_nodes.rcbuffer->pybuffer, (PyObject*)__pyx_v_surface_nodes, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
            Py_XDECREF(__pyx_t_26); Py_XDECREF(__pyx_t_25); Py_XDECREF(__pyx_t_24);
            <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
          } else {
            <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_26, __pyx_t_25, __pyx_t_24);
          }
        }
        __pyx_pybuffernd_surface_nodes.diminfo[0].strides = __pyx_pybuffernd_surface_nodes.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_surface_nodes.diminfo[0].shape = __pyx_pybuffernd_surface_nodes.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_surface_nodes.diminfo[1].strides = __pyx_pybuffernd_surface_nodes.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_surface_nodes.diminfo[1].shape = __pyx_pybuffernd_surface_nodes.rcbuffer->pybuffer.shape[1];
        if (unlikely(__pyx_t_51 <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_23 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_surface_nodes));
      __pyx_v_surface_nodes = ((PyArrayObject *)__pyx_t_7);
      __pyx_t_7 = 0;
    }
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFF39' onclick='toggleDiv("line500")'> 500:     return box</pre>
<pre id='line500' class='code' style='background-color: #FFFF39'>
  /* "epitopsy/cython/dx_cython.pyx":500
 *                 newSurfaceNodes.append([])
 *             surface_nodes = np.array(newSurfaceNodes,dtype=np.int64)
 *     return box             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef np.ndarray switch_value(np.ndarray[np.float64_t, ndim =3] box,
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_box));
  __pyx_r = ((PyObject *)__pyx_v_box);
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&__pyx_type, &__pyx_value, &__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_neighbors.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_surface_nodes.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython.extendSurface", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_neighbors.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_surface_nodes.rcbuffer->pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_surface_nodes);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_next_neighbors);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_newSurfaceNodes);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line501")'> 501: </pre>
<pre id='line501' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line502")'> 502: cdef np.ndarray switch_value(np.ndarray[np.float64_t, ndim =3] box,</pre>
<pre id='line502' class='code' style='background-color: #FFFFd4'>
/* "epitopsy/cython/dx_cython.pyx":502
 *     return box
 * 
 * cdef np.ndarray switch_value(np.ndarray[np.float64_t, ndim =3] box,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                           int xdim, int ydim, int zdim,
 *                                           np.float64_t value_to_switch,
 */

static PyArrayObject *__pyx_f_8epitopsy_6cython_9dx_cython_switch_value(PyArrayObject *__pyx_v_box, int __pyx_v_xdim, int __pyx_v_ydim, int __pyx_v_zdim, __pyx_t_5numpy_float64_t __pyx_v_value_to_switch, __pyx_t_5numpy_float64_t __pyx_v_new_value) {
  long __pyx_v_x;
  long __pyx_v_y;
  long __pyx_v_z;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_box;
  __Pyx_Buffer __pyx_pybuffer_box;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("switch_value", 0);
  __pyx_pybuffer_box.pybuffer.buf = NULL;
  __pyx_pybuffer_box.refcount = 0;
  __pyx_pybuffernd_box.data = NULL;
  __pyx_pybuffernd_box.rcbuffer = &__pyx_pybuffer_box;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer, (PyObject*)__pyx_v_box, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 3, 0, __pyx_stack) == -1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 502; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_box.diminfo[0].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_box.diminfo[0].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_box.diminfo[1].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_box.diminfo[1].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_box.diminfo[2].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_box.diminfo[2].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[2];
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line503")'> 503:                                           int xdim, int ydim, int zdim,</pre>
<pre id='line503' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line504")'> 504:                                           np.float64_t value_to_switch,</pre>
<pre id='line504' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line505")'> 505:                                           np.float64_t new_value):</pre>
<pre id='line505' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line506")'> 506:     for x from 0 &lt;= x &lt; xdim:</pre>
<pre id='line506' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":506
 *                                           np.float64_t value_to_switch,
 *                                           np.float64_t new_value):
 *     for x from 0 <code><</code>= x <code><</code> xdim:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for y from 0 <code><</code>= y <code><</code> ydim:
 *             for z from 0 <code><</code>= z <code><</code> zdim:
 */
  __pyx_t_1 = __pyx_v_xdim;
  for (__pyx_v_x = 0; __pyx_v_x <code><</code> __pyx_t_1; __pyx_v_x++) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line507")'> 507:         for y from 0 &lt;= y &lt; ydim:</pre>
<pre id='line507' class='code' style='background-color: #FFFFff'>
    /* "epitopsy/cython/dx_cython.pyx":507
 *                                           np.float64_t new_value):
 *     for x from 0 <code><</code>= x <code><</code> xdim:
 *         for y from 0 <code><</code>= y <code><</code> ydim:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for z from 0 <code><</code>= z <code><</code> zdim:
 *                 if box[x,y,z] == value_to_switch:
 */
    __pyx_t_2 = __pyx_v_ydim;
    for (__pyx_v_y = 0; __pyx_v_y <code><</code> __pyx_t_2; __pyx_v_y++) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line508")'> 508:             for z from 0 &lt;= z &lt; zdim:</pre>
<pre id='line508' class='code' style='background-color: #FFFFff'>
      /* "epitopsy/cython/dx_cython.pyx":508
 *     for x from 0 <code><</code>= x <code><</code> xdim:
 *         for y from 0 <code><</code>= y <code><</code> ydim:
 *             for z from 0 <code><</code>= z <code><</code> zdim:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 if box[x,y,z] == value_to_switch:
 *                     box[x,y,z] = new_value
 */
      __pyx_t_3 = __pyx_v_zdim;
      for (__pyx_v_z = 0; __pyx_v_z <code><</code> __pyx_t_3; __pyx_v_z++) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line509")'> 509:                 if box[x,y,z] == value_to_switch:</pre>
<pre id='line509' class='code' style='background-color: #FFFFd4'>
        /* "epitopsy/cython/dx_cython.pyx":509
 *         for y from 0 <code><</code>= y <code><</code> ydim:
 *             for z from 0 <code><</code>= z <code><</code> zdim:
 *                 if box[x,y,z] == value_to_switch:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     box[x,y,z] = new_value
 * 
 */
        __pyx_t_4 = __pyx_v_x;
        __pyx_t_5 = __pyx_v_y;
        __pyx_t_6 = __pyx_v_z;
        __pyx_t_7 = -1;
        if (__pyx_t_4 <code><</code> 0) {
          __pyx_t_4 += __pyx_pybuffernd_box.diminfo[0].shape;
          if (unlikely(__pyx_t_4 <code><</code> 0)) __pyx_t_7 = 0;
        } else if (unlikely(__pyx_t_4 >= __pyx_pybuffernd_box.diminfo[0].shape)) __pyx_t_7 = 0;
        if (__pyx_t_5 <code><</code> 0) {
          __pyx_t_5 += __pyx_pybuffernd_box.diminfo[1].shape;
          if (unlikely(__pyx_t_5 <code><</code> 0)) __pyx_t_7 = 1;
        } else if (unlikely(__pyx_t_5 >= __pyx_pybuffernd_box.diminfo[1].shape)) __pyx_t_7 = 1;
        if (__pyx_t_6 <code><</code> 0) {
          __pyx_t_6 += __pyx_pybuffernd_box.diminfo[2].shape;
          if (unlikely(__pyx_t_6 <code><</code> 0)) __pyx_t_7 = 2;
        } else if (unlikely(__pyx_t_6 >= __pyx_pybuffernd_box.diminfo[2].shape)) __pyx_t_7 = 2;
        if (unlikely(__pyx_t_7 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_8 = (((*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_4, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_5, __pyx_pybuffernd_box.diminfo[1].strides, __pyx_t_6, __pyx_pybuffernd_box.diminfo[2].strides)) == __pyx_v_value_to_switch) != 0);
        if (__pyx_t_8) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line510")'> 510:                     box[x,y,z] = new_value</pre>
<pre id='line510' class='code' style='background-color: #FFFFd4'>
          /* "epitopsy/cython/dx_cython.pyx":510
 *             for z from 0 <code><</code>= z <code><</code> zdim:
 *                 if box[x,y,z] == value_to_switch:
 *                     box[x,y,z] = new_value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     return box
 */
          __pyx_t_9 = __pyx_v_x;
          __pyx_t_10 = __pyx_v_y;
          __pyx_t_11 = __pyx_v_z;
          __pyx_t_7 = -1;
          if (__pyx_t_9 <code><</code> 0) {
            __pyx_t_9 += __pyx_pybuffernd_box.diminfo[0].shape;
            if (unlikely(__pyx_t_9 <code><</code> 0)) __pyx_t_7 = 0;
          } else if (unlikely(__pyx_t_9 >= __pyx_pybuffernd_box.diminfo[0].shape)) __pyx_t_7 = 0;
          if (__pyx_t_10 <code><</code> 0) {
            __pyx_t_10 += __pyx_pybuffernd_box.diminfo[1].shape;
            if (unlikely(__pyx_t_10 <code><</code> 0)) __pyx_t_7 = 1;
          } else if (unlikely(__pyx_t_10 >= __pyx_pybuffernd_box.diminfo[1].shape)) __pyx_t_7 = 1;
          if (__pyx_t_11 <code><</code> 0) {
            __pyx_t_11 += __pyx_pybuffernd_box.diminfo[2].shape;
            if (unlikely(__pyx_t_11 <code><</code> 0)) __pyx_t_7 = 2;
          } else if (unlikely(__pyx_t_11 >= __pyx_pybuffernd_box.diminfo[2].shape)) __pyx_t_7 = 2;
          if (unlikely(__pyx_t_7 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
           <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 510; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_9, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_box.diminfo[1].strides, __pyx_t_11, __pyx_pybuffernd_box.diminfo[2].strides) = __pyx_v_new_value;
          goto __pyx_L9;
        }
        __pyx_L9:;
      }
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line511")'> 511: </pre>
<pre id='line511' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF17' onclick='toggleDiv("line512")'> 512:     return box</pre>
<pre id='line512' class='code' style='background-color: #FFFF17'>
  /* "epitopsy/cython/dx_cython.pyx":512
 *                     box[x,y,z] = new_value
 * 
 *     return box             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * def extend_nice_surface(int iterations, np.ndarray[np.float64_t, ndim=3] box,
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_box));
  __pyx_r = ((PyArrayObject *)__pyx_v_box);
  goto __pyx_L0;

  __pyx_r = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&__pyx_type, &__pyx_value, &__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython.switch_value", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>((PyObject *)__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_8epitopsy_6cython_9dx_cython_19extend_nice_surface(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_8epitopsy_6cython_9dx_cython_19extend_nice_surface = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("extend_nice_surface"), (PyCFunction)__pyx_pw_8epitopsy_6cython_9dx_cython_19extend_nice_surface, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_8epitopsy_6cython_9dx_cython_19extend_nice_surface(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_iterations;
  PyArrayObject *__pyx_v_box = 0;
  PyObject *__pyx_v_solventScore_ext = 0;
  PyObject *__pyx_v_peptideScore_ext = 0;
  PyObject *__pyx_v_dummy_score_ext = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_neighbors = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("extend_nice_surface (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__iterations,&__pyx_n_s__box,&__pyx_n_s__solventScore_ext,&__pyx_n_s__peptideScore_ext,&__pyx_n_s__dummy_score_ext,&__pyx_n_s__neighbors,0};
    PyObject* values[6] = {0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__iterations)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__box)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("extend_nice_surface", 1, 6, 6, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__solventScore_ext)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("extend_nice_surface", 1, 6, 6, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__peptideScore_ext)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("extend_nice_surface", 1, 6, 6, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__dummy_score_ext)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("extend_nice_surface", 1, 6, 6, 4);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  5:
        if (likely((values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__neighbors)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("extend_nice_surface", 1, 6, 6, 5);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "extend_nice_surface") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 6) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
    }
    __pyx_v_iterations = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_iterations == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_box = ((PyArrayObject *)values[1]);
    __pyx_v_solventScore_ext = values[2];
    __pyx_v_peptideScore_ext = values[3];
    __pyx_v_dummy_score_ext = values[4];
    __pyx_v_neighbors = ((PyArrayObject *)values[5]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("extend_nice_surface", 1, 6, 6, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython.extend_nice_surface", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_box), __pyx_ptype_5numpy_ndarray, 1, "box", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_neighbors), __pyx_ptype_5numpy_ndarray, 1, "neighbors", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 516; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_8epitopsy_6cython_9dx_cython_18extend_nice_surface(__pyx_self, __pyx_v_iterations, __pyx_v_box, __pyx_v_solventScore_ext, __pyx_v_peptideScore_ext, __pyx_v_dummy_score_ext, __pyx_v_neighbors);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line513")'> 513: </pre>
<pre id='line513' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF52' onclick='toggleDiv("line514")'> 514: def extend_nice_surface(int iterations, np.ndarray[np.float64_t, ndim=3] box,</pre>
<pre id='line514' class='code' style='background-color: #FFFF52'>
/* "epitopsy/cython/dx_cython.pyx":514
 *     return box
 * 
 * def extend_nice_surface(int iterations, np.ndarray[np.float64_t, ndim=3] box,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         solventScore_ext, peptideScore_ext, dummy_score_ext,
 *         np.ndarray[np.int64_t, ndim = 2] neighbors):
 */

static PyObject *__pyx_pf_8epitopsy_6cython_9dx_cython_18extend_nice_surface(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_iterations, PyArrayObject *__pyx_v_box, PyObject *__pyx_v_solventScore_ext, PyObject *__pyx_v_peptideScore_ext, PyObject *__pyx_v_dummy_score_ext, CYTHON_UNUSED PyArrayObject *__pyx_v_neighbors) {
  CYTHON_UNUSED int __pyx_v_i;
  int __pyx_v_n;
  int __pyx_v_x;
  int __pyx_v_y;
  int __pyx_v_z;
  int __pyx_v_nx;
  int __pyx_v_ny;
  int __pyx_v_nz;
  int __pyx_v_xdim;
  int __pyx_v_ydim;
  int __pyx_v_zdim;
  float __pyx_v_solventScore;
  float __pyx_v_peptideScore;
  float __pyx_v_dummy_score;
  PyArrayObject *__pyx_v_next_neighbors = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_box;
  __Pyx_Buffer __pyx_pybuffer_box;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_neighbors;
  __Pyx_Buffer __pyx_pybuffer_neighbors;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_next_neighbors;
  __Pyx_Buffer __pyx_pybuffer_next_neighbors;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("extend_nice_surface", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_v_box);
  __pyx_pybuffer_next_neighbors.pybuffer.buf = NULL;
  __pyx_pybuffer_next_neighbors.refcount = 0;
  __pyx_pybuffernd_next_neighbors.data = NULL;
  __pyx_pybuffernd_next_neighbors.rcbuffer = &__pyx_pybuffer_next_neighbors;
  __pyx_pybuffer_box.pybuffer.buf = NULL;
  __pyx_pybuffer_box.refcount = 0;
  __pyx_pybuffernd_box.data = NULL;
  __pyx_pybuffernd_box.rcbuffer = &__pyx_pybuffer_box;
  __pyx_pybuffer_neighbors.pybuffer.buf = NULL;
  __pyx_pybuffer_neighbors.refcount = 0;
  __pyx_pybuffernd_neighbors.data = NULL;
  __pyx_pybuffernd_neighbors.rcbuffer = &__pyx_pybuffer_neighbors;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer, (PyObject*)__pyx_v_box, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 3, 0, __pyx_stack) == -1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_box.diminfo[0].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_box.diminfo[0].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_box.diminfo[1].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_box.diminfo[1].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_box.diminfo[2].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_box.diminfo[2].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[2];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_neighbors.rcbuffer->pybuffer, (PyObject*)__pyx_v_neighbors, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_neighbors.diminfo[0].strides = __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_neighbors.diminfo[0].shape = __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_neighbors.diminfo[1].strides = __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_neighbors.diminfo[1].shape = __pyx_pybuffernd_neighbors.rcbuffer->pybuffer.shape[1];

  /* "epitopsy/cython/dx_cython.pyx":514
 *     return box
 * 
 * def extend_nice_surface(int iterations, np.ndarray[np.float64_t, ndim=3] box,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         solventScore_ext, peptideScore_ext, dummy_score_ext,
 *         np.ndarray[np.int64_t, ndim = 2] neighbors):
 */
  __pyx_k_tuple_128 = <span class='py_c_api'>PyTuple_Pack</span>(21, ((PyObject *)__pyx_n_s__iterations), ((PyObject *)__pyx_n_s__box), ((PyObject *)__pyx_n_s__solventScore_ext), ((PyObject *)__pyx_n_s__peptideScore_ext), ((PyObject *)__pyx_n_s__dummy_score_ext), ((PyObject *)__pyx_n_s__neighbors), ((PyObject *)__pyx_n_s__i), ((PyObject *)__pyx_n_s__n), ((PyObject *)__pyx_n_s__x), ((PyObject *)__pyx_n_s__y), ((PyObject *)__pyx_n_s__z), ((PyObject *)__pyx_n_s__nx), ((PyObject *)__pyx_n_s__ny), ((PyObject *)__pyx_n_s__nz), ((PyObject *)__pyx_n_s__xdim), ((PyObject *)__pyx_n_s__ydim), ((PyObject *)__pyx_n_s__zdim), ((PyObject *)__pyx_n_s__solventScore), ((PyObject *)__pyx_n_s__peptideScore), ((PyObject *)__pyx_n_s__dummy_score), ((PyObject *)__pyx_n_s__next_neighbors));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_128)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_128);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_128));

  /* "epitopsy/cython/dx_cython.pyx":514
 *     return box
 * 
 * def extend_nice_surface(int iterations, np.ndarray[np.float64_t, ndim=3] box,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         solventScore_ext, peptideScore_ext, dummy_score_ext,
 *         np.ndarray[np.int64_t, ndim = 2] neighbors):
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_8epitopsy_6cython_9dx_cython_19extend_nice_surface, NULL, __pyx_n_s_110);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s__extend_nice_surface, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_129 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(6, 0, 21, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_128, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_109, __pyx_n_s__extend_nice_surface, 514, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_129)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line515")'> 515:         solventScore_ext, peptideScore_ext, dummy_score_ext,</pre>
<pre id='line515' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line516")'> 516:         np.ndarray[np.int64_t, ndim = 2] neighbors):</pre>
<pre id='line516' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line517")'> 517:     cdef int i,n,x,y,z</pre>
<pre id='line517' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line518")'> 518:     cdef int nx, ny, nz</pre>
<pre id='line518' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line519")'> 519:     cdef int xdim = box.shape[0]</pre>
<pre id='line519' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":519
 *     cdef int i,n,x,y,z
 *     cdef int nx, ny, nz
 *     cdef int xdim = box.shape[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int ydim = box.shape[1]
 *     cdef int zdim = box.shape[2]
 */
  __pyx_v_xdim = (__pyx_v_box->dimensions[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line520")'> 520:     cdef int ydim = box.shape[1]</pre>
<pre id='line520' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":520
 *     cdef int nx, ny, nz
 *     cdef int xdim = box.shape[0]
 *     cdef int ydim = box.shape[1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int zdim = box.shape[2]
 *     cdef float solventScore = <code><</code>float> solventScore_ext
 */
  __pyx_v_ydim = (__pyx_v_box->dimensions[1]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line521")'> 521:     cdef int zdim = box.shape[2]</pre>
<pre id='line521' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":521
 *     cdef int xdim = box.shape[0]
 *     cdef int ydim = box.shape[1]
 *     cdef int zdim = box.shape[2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef float solventScore = <code><</code>float> solventScore_ext
 *     cdef float peptideScore = <code><</code>float> peptideScore_ext
 */
  __pyx_v_zdim = (__pyx_v_box->dimensions[2]);
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line522")'> 522:     cdef float solventScore = &lt;float&gt; solventScore_ext</pre>
<pre id='line522' class='code' style='background-color: #FFFF7f'>
  /* "epitopsy/cython/dx_cython.pyx":522
 *     cdef int ydim = box.shape[1]
 *     cdef int zdim = box.shape[2]
 *     cdef float solventScore = <code><</code>float> solventScore_ext             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef float peptideScore = <code><</code>float> peptideScore_ext
 *     cdef float dummy_score = <code><</code>float> dummy_score_ext
 */
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_solventScore_ext);<span class='error_goto'> if (unlikely((__pyx_t_1 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_solventScore = ((float)__pyx_t_1);
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line523")'> 523:     cdef float peptideScore = &lt;float&gt; peptideScore_ext</pre>
<pre id='line523' class='code' style='background-color: #FFFF7f'>
  /* "epitopsy/cython/dx_cython.pyx":523
 *     cdef int zdim = box.shape[2]
 *     cdef float solventScore = <code><</code>float> solventScore_ext
 *     cdef float peptideScore = <code><</code>float> peptideScore_ext             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef float dummy_score = <code><</code>float> dummy_score_ext
 *     cdef np.ndarray[np.int64_t, ndim = 2] next_neighbors = np.zeros([6, 3], dtype = np.int64)
 */
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_peptideScore_ext);<span class='error_goto'> if (unlikely((__pyx_t_1 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 523; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_peptideScore = ((float)__pyx_t_1);
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line524")'> 524:     cdef float dummy_score = &lt;float&gt; dummy_score_ext</pre>
<pre id='line524' class='code' style='background-color: #FFFF7f'>
  /* "epitopsy/cython/dx_cython.pyx":524
 *     cdef float solventScore = <code><</code>float> solventScore_ext
 *     cdef float peptideScore = <code><</code>float> peptideScore_ext
 *     cdef float dummy_score = <code><</code>float> dummy_score_ext             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef np.ndarray[np.int64_t, ndim = 2] next_neighbors = np.zeros([6, 3], dtype = np.int64)
 *     # [-1, 0, 0]
 */
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_dummy_score_ext);<span class='error_goto'> if (unlikely((__pyx_t_1 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 524; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_dummy_score = ((float)__pyx_t_1);
</pre><pre class='line' style='background-color: #FFFF27' onclick='toggleDiv("line525")'> 525:     cdef np.ndarray[np.int64_t, ndim = 2] next_neighbors = np.zeros([6, 3], dtype = np.int64)</pre>
<pre id='line525' class='code' style='background-color: #FFFF27'>
  /* "epitopsy/cython/dx_cython.pyx":525
 *     cdef float peptideScore = <code><</code>float> peptideScore_ext
 *     cdef float dummy_score = <code><</code>float> dummy_score_ext
 *     cdef np.ndarray[np.int64_t, ndim = 2] next_neighbors = np.zeros([6, 3], dtype = np.int64)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     # [-1, 0, 0]
 *     next_neighbors[0, 0] = -1
 */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s__zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_6);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_int_6);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_3);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, ((PyObject *)__pyx_t_2));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_2));
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s__int64);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, ((PyObject *)__pyx_n_s__dtype), __pyx_t_6) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_4), ((PyObject *)__pyx_t_2));<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_ptype_5numpy_ndarray)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_next_neighbors = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer.buf = NULL;
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    } else {__pyx_pybuffernd_next_neighbors.diminfo[0].strides = __pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_next_neighbors.diminfo[0].shape = __pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_next_neighbors.diminfo[1].strides = __pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_next_neighbors.diminfo[1].shape = __pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_next_neighbors = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line526")'> 526:     # [-1, 0, 0]</pre>
<pre id='line526' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line527")'> 527:     next_neighbors[0, 0] = -1</pre>
<pre id='line527' class='code' style='background-color: #FFFFd4'>
  /* "epitopsy/cython/dx_cython.pyx":527
 *     cdef np.ndarray[np.int64_t, ndim = 2] next_neighbors = np.zeros([6, 3], dtype = np.int64)
 *     # [-1, 0, 0]
 *     next_neighbors[0, 0] = -1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     # [0, -1, 0]
 *     next_neighbors[1, 1] = -1
 */
  __pyx_t_8 = 0;
  __pyx_t_9 = 0;
  __pyx_t_10 = -1;
  if (__pyx_t_8 <code><</code> 0) {
    __pyx_t_8 += __pyx_pybuffernd_next_neighbors.diminfo[0].shape;
    if (unlikely(__pyx_t_8 <code><</code> 0)) __pyx_t_10 = 0;
  } else if (unlikely(__pyx_t_8 >= __pyx_pybuffernd_next_neighbors.diminfo[0].shape)) __pyx_t_10 = 0;
  if (__pyx_t_9 <code><</code> 0) {
    __pyx_t_9 += __pyx_pybuffernd_next_neighbors.diminfo[1].shape;
    if (unlikely(__pyx_t_9 <code><</code> 0)) __pyx_t_10 = 1;
  } else if (unlikely(__pyx_t_9 >= __pyx_pybuffernd_next_neighbors.diminfo[1].shape)) __pyx_t_10 = 1;
  if (unlikely(__pyx_t_10 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_next_neighbors.diminfo[0].strides, __pyx_t_9, __pyx_pybuffernd_next_neighbors.diminfo[1].strides) = -1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line528")'> 528:     # [0, -1, 0]</pre>
<pre id='line528' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line529")'> 529:     next_neighbors[1, 1] = -1</pre>
<pre id='line529' class='code' style='background-color: #FFFFd4'>
  /* "epitopsy/cython/dx_cython.pyx":529
 *     next_neighbors[0, 0] = -1
 *     # [0, -1, 0]
 *     next_neighbors[1, 1] = -1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     # [0, 0, -1]
 *     next_neighbors[2, 2] = -1
 */
  __pyx_t_11 = 1;
  __pyx_t_12 = 1;
  __pyx_t_10 = -1;
  if (__pyx_t_11 <code><</code> 0) {
    __pyx_t_11 += __pyx_pybuffernd_next_neighbors.diminfo[0].shape;
    if (unlikely(__pyx_t_11 <code><</code> 0)) __pyx_t_10 = 0;
  } else if (unlikely(__pyx_t_11 >= __pyx_pybuffernd_next_neighbors.diminfo[0].shape)) __pyx_t_10 = 0;
  if (__pyx_t_12 <code><</code> 0) {
    __pyx_t_12 += __pyx_pybuffernd_next_neighbors.diminfo[1].shape;
    if (unlikely(__pyx_t_12 <code><</code> 0)) __pyx_t_10 = 1;
  } else if (unlikely(__pyx_t_12 >= __pyx_pybuffernd_next_neighbors.diminfo[1].shape)) __pyx_t_10 = 1;
  if (unlikely(__pyx_t_10 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 529; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_next_neighbors.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_next_neighbors.diminfo[1].strides) = -1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line530")'> 530:     # [0, 0, -1]</pre>
<pre id='line530' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line531")'> 531:     next_neighbors[2, 2] = -1</pre>
<pre id='line531' class='code' style='background-color: #FFFFd4'>
  /* "epitopsy/cython/dx_cython.pyx":531
 *     next_neighbors[1, 1] = -1
 *     # [0, 0, -1]
 *     next_neighbors[2, 2] = -1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     # [1, 0, 0]
 *     next_neighbors[3, 0] = 1
 */
  __pyx_t_13 = 2;
  __pyx_t_14 = 2;
  __pyx_t_10 = -1;
  if (__pyx_t_13 <code><</code> 0) {
    __pyx_t_13 += __pyx_pybuffernd_next_neighbors.diminfo[0].shape;
    if (unlikely(__pyx_t_13 <code><</code> 0)) __pyx_t_10 = 0;
  } else if (unlikely(__pyx_t_13 >= __pyx_pybuffernd_next_neighbors.diminfo[0].shape)) __pyx_t_10 = 0;
  if (__pyx_t_14 <code><</code> 0) {
    __pyx_t_14 += __pyx_pybuffernd_next_neighbors.diminfo[1].shape;
    if (unlikely(__pyx_t_14 <code><</code> 0)) __pyx_t_10 = 1;
  } else if (unlikely(__pyx_t_14 >= __pyx_pybuffernd_next_neighbors.diminfo[1].shape)) __pyx_t_10 = 1;
  if (unlikely(__pyx_t_10 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 531; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_next_neighbors.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_next_neighbors.diminfo[1].strides) = -1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line532")'> 532:     # [1, 0, 0]</pre>
<pre id='line532' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line533")'> 533:     next_neighbors[3, 0] = 1</pre>
<pre id='line533' class='code' style='background-color: #FFFFd4'>
  /* "epitopsy/cython/dx_cython.pyx":533
 *     next_neighbors[2, 2] = -1
 *     # [1, 0, 0]
 *     next_neighbors[3, 0] = 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     # [0, 1, 0]
 *     next_neighbors[4, 1] = 1
 */
  __pyx_t_15 = 3;
  __pyx_t_16 = 0;
  __pyx_t_10 = -1;
  if (__pyx_t_15 <code><</code> 0) {
    __pyx_t_15 += __pyx_pybuffernd_next_neighbors.diminfo[0].shape;
    if (unlikely(__pyx_t_15 <code><</code> 0)) __pyx_t_10 = 0;
  } else if (unlikely(__pyx_t_15 >= __pyx_pybuffernd_next_neighbors.diminfo[0].shape)) __pyx_t_10 = 0;
  if (__pyx_t_16 <code><</code> 0) {
    __pyx_t_16 += __pyx_pybuffernd_next_neighbors.diminfo[1].shape;
    if (unlikely(__pyx_t_16 <code><</code> 0)) __pyx_t_10 = 1;
  } else if (unlikely(__pyx_t_16 >= __pyx_pybuffernd_next_neighbors.diminfo[1].shape)) __pyx_t_10 = 1;
  if (unlikely(__pyx_t_10 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 533; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_next_neighbors.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_next_neighbors.diminfo[1].strides) = 1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line534")'> 534:     # [0, 1, 0]</pre>
<pre id='line534' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line535")'> 535:     next_neighbors[4, 1] = 1</pre>
<pre id='line535' class='code' style='background-color: #FFFFd4'>
  /* "epitopsy/cython/dx_cython.pyx":535
 *     next_neighbors[3, 0] = 1
 *     # [0, 1, 0]
 *     next_neighbors[4, 1] = 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     # [0, 0, 1]
 *     next_neighbors[5, 2] = 1
 */
  __pyx_t_17 = 4;
  __pyx_t_18 = 1;
  __pyx_t_10 = -1;
  if (__pyx_t_17 <code><</code> 0) {
    __pyx_t_17 += __pyx_pybuffernd_next_neighbors.diminfo[0].shape;
    if (unlikely(__pyx_t_17 <code><</code> 0)) __pyx_t_10 = 0;
  } else if (unlikely(__pyx_t_17 >= __pyx_pybuffernd_next_neighbors.diminfo[0].shape)) __pyx_t_10 = 0;
  if (__pyx_t_18 <code><</code> 0) {
    __pyx_t_18 += __pyx_pybuffernd_next_neighbors.diminfo[1].shape;
    if (unlikely(__pyx_t_18 <code><</code> 0)) __pyx_t_10 = 1;
  } else if (unlikely(__pyx_t_18 >= __pyx_pybuffernd_next_neighbors.diminfo[1].shape)) __pyx_t_10 = 1;
  if (unlikely(__pyx_t_10 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 535; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_next_neighbors.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_next_neighbors.diminfo[1].strides) = 1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line536")'> 536:     # [0, 0, 1]</pre>
<pre id='line536' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line537")'> 537:     next_neighbors[5, 2] = 1</pre>
<pre id='line537' class='code' style='background-color: #FFFFd4'>
  /* "epitopsy/cython/dx_cython.pyx":537
 *     next_neighbors[4, 1] = 1
 *     # [0, 0, 1]
 *     next_neighbors[5, 2] = 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     for i from 0 <code><</code>= i <code><</code> iterations:
 */
  __pyx_t_19 = 5;
  __pyx_t_20 = 2;
  __pyx_t_10 = -1;
  if (__pyx_t_19 <code><</code> 0) {
    __pyx_t_19 += __pyx_pybuffernd_next_neighbors.diminfo[0].shape;
    if (unlikely(__pyx_t_19 <code><</code> 0)) __pyx_t_10 = 0;
  } else if (unlikely(__pyx_t_19 >= __pyx_pybuffernd_next_neighbors.diminfo[0].shape)) __pyx_t_10 = 0;
  if (__pyx_t_20 <code><</code> 0) {
    __pyx_t_20 += __pyx_pybuffernd_next_neighbors.diminfo[1].shape;
    if (unlikely(__pyx_t_20 <code><</code> 0)) __pyx_t_10 = 1;
  } else if (unlikely(__pyx_t_20 >= __pyx_pybuffernd_next_neighbors.diminfo[1].shape)) __pyx_t_10 = 1;
  if (unlikely(__pyx_t_10 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 537; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_next_neighbors.diminfo[0].strides, __pyx_t_20, __pyx_pybuffernd_next_neighbors.diminfo[1].strides) = 1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line538")'> 538: </pre>
<pre id='line538' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line539")'> 539:     for i from 0 &lt;= i &lt; iterations:</pre>
<pre id='line539' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":539
 *     next_neighbors[5, 2] = 1
 * 
 *     for i from 0 <code><</code>= i <code><</code> iterations:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for x from 0 <code><</code>= x <code><</code> xdim:
 *             for y from 0 <code><</code>= y <code><</code> ydim:
 */
  __pyx_t_10 = __pyx_v_iterations;
  for (__pyx_v_i = 0; __pyx_v_i <code><</code> __pyx_t_10; __pyx_v_i++) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line540")'> 540:         for x from 0 &lt;= x &lt; xdim:</pre>
<pre id='line540' class='code' style='background-color: #FFFFff'>
    /* "epitopsy/cython/dx_cython.pyx":540
 * 
 *     for i from 0 <code><</code>= i <code><</code> iterations:
 *         for x from 0 <code><</code>= x <code><</code> xdim:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for y from 0 <code><</code>= y <code><</code> ydim:
 *                 for z from 0 <code><</code>= z <code><</code> zdim:
 */
    __pyx_t_21 = __pyx_v_xdim;
    for (__pyx_v_x = 0; __pyx_v_x <code><</code> __pyx_t_21; __pyx_v_x++) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line541")'> 541:             for y from 0 &lt;= y &lt; ydim:</pre>
<pre id='line541' class='code' style='background-color: #FFFFff'>
      /* "epitopsy/cython/dx_cython.pyx":541
 *     for i from 0 <code><</code>= i <code><</code> iterations:
 *         for x from 0 <code><</code>= x <code><</code> xdim:
 *             for y from 0 <code><</code>= y <code><</code> ydim:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for z from 0 <code><</code>= z <code><</code> zdim:
 *                     if box[x,y,z] == solventScore:
 */
      __pyx_t_22 = __pyx_v_ydim;
      for (__pyx_v_y = 0; __pyx_v_y <code><</code> __pyx_t_22; __pyx_v_y++) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line542")'> 542:                 for z from 0 &lt;= z &lt; zdim:</pre>
<pre id='line542' class='code' style='background-color: #FFFFff'>
        /* "epitopsy/cython/dx_cython.pyx":542
 *         for x from 0 <code><</code>= x <code><</code> xdim:
 *             for y from 0 <code><</code>= y <code><</code> ydim:
 *                 for z from 0 <code><</code>= z <code><</code> zdim:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     if box[x,y,z] == solventScore:
 *                         for n from 0 <code><</code>= n <code><</code> 6:
 */
        __pyx_t_23 = __pyx_v_zdim;
        for (__pyx_v_z = 0; __pyx_v_z <code><</code> __pyx_t_23; __pyx_v_z++) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line543")'> 543:                     if box[x,y,z] == solventScore:</pre>
<pre id='line543' class='code' style='background-color: #FFFFd4'>
          /* "epitopsy/cython/dx_cython.pyx":543
 *             for y from 0 <code><</code>= y <code><</code> ydim:
 *                 for z from 0 <code><</code>= z <code><</code> zdim:
 *                     if box[x,y,z] == solventScore:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         for n from 0 <code><</code>= n <code><</code> 6:
 *                             nx = x + next_neighbors[n,0]
 */
          __pyx_t_24 = __pyx_v_x;
          __pyx_t_25 = __pyx_v_y;
          __pyx_t_26 = __pyx_v_z;
          __pyx_t_27 = -1;
          if (__pyx_t_24 <code><</code> 0) {
            __pyx_t_24 += __pyx_pybuffernd_box.diminfo[0].shape;
            if (unlikely(__pyx_t_24 <code><</code> 0)) __pyx_t_27 = 0;
          } else if (unlikely(__pyx_t_24 >= __pyx_pybuffernd_box.diminfo[0].shape)) __pyx_t_27 = 0;
          if (__pyx_t_25 <code><</code> 0) {
            __pyx_t_25 += __pyx_pybuffernd_box.diminfo[1].shape;
            if (unlikely(__pyx_t_25 <code><</code> 0)) __pyx_t_27 = 1;
          } else if (unlikely(__pyx_t_25 >= __pyx_pybuffernd_box.diminfo[1].shape)) __pyx_t_27 = 1;
          if (__pyx_t_26 <code><</code> 0) {
            __pyx_t_26 += __pyx_pybuffernd_box.diminfo[2].shape;
            if (unlikely(__pyx_t_26 <code><</code> 0)) __pyx_t_27 = 2;
          } else if (unlikely(__pyx_t_26 >= __pyx_pybuffernd_box.diminfo[2].shape)) __pyx_t_27 = 2;
          if (unlikely(__pyx_t_27 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_27);
           <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 543; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          __pyx_t_28 = (((*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_24, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_25, __pyx_pybuffernd_box.diminfo[1].strides, __pyx_t_26, __pyx_pybuffernd_box.diminfo[2].strides)) == __pyx_v_solventScore) != 0);
          if (__pyx_t_28) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line544")'> 544:                         for n from 0 &lt;= n &lt; 6:</pre>
<pre id='line544' class='code' style='background-color: #FFFFff'>
            /* "epitopsy/cython/dx_cython.pyx":544
 *                 for z from 0 <code><</code>= z <code><</code> zdim:
 *                     if box[x,y,z] == solventScore:
 *                         for n from 0 <code><</code>= n <code><</code> 6:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             nx = x + next_neighbors[n,0]
 *                             ny = y + next_neighbors[n,1]
 */
            for (__pyx_v_n = 0; __pyx_v_n <code><</code> 6; __pyx_v_n++) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line545")'> 545:                             nx = x + next_neighbors[n,0]</pre>
<pre id='line545' class='code' style='background-color: #FFFFd4'>
              /* "epitopsy/cython/dx_cython.pyx":545
 *                     if box[x,y,z] == solventScore:
 *                         for n from 0 <code><</code>= n <code><</code> 6:
 *                             nx = x + next_neighbors[n,0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             ny = y + next_neighbors[n,1]
 *                             nz = z + next_neighbors[n,2]
 */
              __pyx_t_27 = __pyx_v_n;
              __pyx_t_29 = 0;
              __pyx_t_30 = -1;
              if (__pyx_t_27 <code><</code> 0) {
                __pyx_t_27 += __pyx_pybuffernd_next_neighbors.diminfo[0].shape;
                if (unlikely(__pyx_t_27 <code><</code> 0)) __pyx_t_30 = 0;
              } else if (unlikely(__pyx_t_27 >= __pyx_pybuffernd_next_neighbors.diminfo[0].shape)) __pyx_t_30 = 0;
              if (__pyx_t_29 <code><</code> 0) {
                __pyx_t_29 += __pyx_pybuffernd_next_neighbors.diminfo[1].shape;
                if (unlikely(__pyx_t_29 <code><</code> 0)) __pyx_t_30 = 1;
              } else if (unlikely(__pyx_t_29 >= __pyx_pybuffernd_next_neighbors.diminfo[1].shape)) __pyx_t_30 = 1;
              if (unlikely(__pyx_t_30 != -1)) {
                <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_30);
               <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 545; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              }
              __pyx_v_nx = (__pyx_v_x + (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer.buf, __pyx_t_27, __pyx_pybuffernd_next_neighbors.diminfo[0].strides, __pyx_t_29, __pyx_pybuffernd_next_neighbors.diminfo[1].strides)));
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line546")'> 546:                             ny = y + next_neighbors[n,1]</pre>
<pre id='line546' class='code' style='background-color: #FFFFd4'>
              /* "epitopsy/cython/dx_cython.pyx":546
 *                         for n from 0 <code><</code>= n <code><</code> 6:
 *                             nx = x + next_neighbors[n,0]
 *                             ny = y + next_neighbors[n,1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             nz = z + next_neighbors[n,2]
 *                             if (nx >= 0 and nx <code><</code> xdim and ny >= 0 and ny <code><</code> ydim and
 */
              __pyx_t_30 = __pyx_v_n;
              __pyx_t_31 = 1;
              __pyx_t_32 = -1;
              if (__pyx_t_30 <code><</code> 0) {
                __pyx_t_30 += __pyx_pybuffernd_next_neighbors.diminfo[0].shape;
                if (unlikely(__pyx_t_30 <code><</code> 0)) __pyx_t_32 = 0;
              } else if (unlikely(__pyx_t_30 >= __pyx_pybuffernd_next_neighbors.diminfo[0].shape)) __pyx_t_32 = 0;
              if (__pyx_t_31 <code><</code> 0) {
                __pyx_t_31 += __pyx_pybuffernd_next_neighbors.diminfo[1].shape;
                if (unlikely(__pyx_t_31 <code><</code> 0)) __pyx_t_32 = 1;
              } else if (unlikely(__pyx_t_31 >= __pyx_pybuffernd_next_neighbors.diminfo[1].shape)) __pyx_t_32 = 1;
              if (unlikely(__pyx_t_32 != -1)) {
                <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_32);
               <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 546; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              }
              __pyx_v_ny = (__pyx_v_y + (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer.buf, __pyx_t_30, __pyx_pybuffernd_next_neighbors.diminfo[0].strides, __pyx_t_31, __pyx_pybuffernd_next_neighbors.diminfo[1].strides)));
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line547")'> 547:                             nz = z + next_neighbors[n,2]</pre>
<pre id='line547' class='code' style='background-color: #FFFFd4'>
              /* "epitopsy/cython/dx_cython.pyx":547
 *                             nx = x + next_neighbors[n,0]
 *                             ny = y + next_neighbors[n,1]
 *                             nz = z + next_neighbors[n,2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             if (nx >= 0 and nx <code><</code> xdim and ny >= 0 and ny <code><</code> ydim and
 *                                 nz >= 0 and nz <code><</code> zdim):
 */
              __pyx_t_32 = __pyx_v_n;
              __pyx_t_33 = 2;
              __pyx_t_34 = -1;
              if (__pyx_t_32 <code><</code> 0) {
                __pyx_t_32 += __pyx_pybuffernd_next_neighbors.diminfo[0].shape;
                if (unlikely(__pyx_t_32 <code><</code> 0)) __pyx_t_34 = 0;
              } else if (unlikely(__pyx_t_32 >= __pyx_pybuffernd_next_neighbors.diminfo[0].shape)) __pyx_t_34 = 0;
              if (__pyx_t_33 <code><</code> 0) {
                __pyx_t_33 += __pyx_pybuffernd_next_neighbors.diminfo[1].shape;
                if (unlikely(__pyx_t_33 <code><</code> 0)) __pyx_t_34 = 1;
              } else if (unlikely(__pyx_t_33 >= __pyx_pybuffernd_next_neighbors.diminfo[1].shape)) __pyx_t_34 = 1;
              if (unlikely(__pyx_t_34 != -1)) {
                <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_34);
               <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 547; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              }
              __pyx_v_nz = (__pyx_v_z + (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer.buf, __pyx_t_32, __pyx_pybuffernd_next_neighbors.diminfo[0].strides, __pyx_t_33, __pyx_pybuffernd_next_neighbors.diminfo[1].strides)));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line548")'> 548:                             if (nx &gt;= 0 and nx &lt; xdim and ny &gt;= 0 and ny &lt; ydim and</pre>
<pre id='line548' class='code' style='background-color: #FFFFff'>
              /* "epitopsy/cython/dx_cython.pyx":548
 *                             ny = y + next_neighbors[n,1]
 *                             nz = z + next_neighbors[n,2]
 *                             if (nx >= 0 and nx <code><</code> xdim and ny >= 0 and ny <code><</code> ydim and             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 nz >= 0 and nz <code><</code> zdim):
 *                                 if box[nx,ny,nz] == peptideScore:
 */
              __pyx_t_28 = ((__pyx_v_nx >= 0) != 0);
              if (__pyx_t_28) {
                __pyx_t_35 = ((__pyx_v_nx <code><</code> __pyx_v_xdim) != 0);
                if (__pyx_t_35) {
                  __pyx_t_36 = ((__pyx_v_ny >= 0) != 0);
                  if (__pyx_t_36) {
                    __pyx_t_37 = ((__pyx_v_ny <code><</code> __pyx_v_ydim) != 0);
                    if (__pyx_t_37) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line549")'> 549:                                 nz &gt;= 0 and nz &lt; zdim):</pre>
<pre id='line549' class='code' style='background-color: #FFFFff'>
                      /* "epitopsy/cython/dx_cython.pyx":549
 *                             nz = z + next_neighbors[n,2]
 *                             if (nx >= 0 and nx <code><</code> xdim and ny >= 0 and ny <code><</code> ydim and
 *                                 nz >= 0 and nz <code><</code> zdim):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 if box[nx,ny,nz] == peptideScore:
 *                                     box[x,y,z] = dummy_score
 */
                      __pyx_t_38 = ((__pyx_v_nz >= 0) != 0);
                      if (__pyx_t_38) {
                        __pyx_t_39 = ((__pyx_v_nz <code><</code> __pyx_v_zdim) != 0);
                        __pyx_t_40 = __pyx_t_39;
                      } else {
                        __pyx_t_40 = __pyx_t_38;
                      }
                      __pyx_t_38 = __pyx_t_40;
                    } else {
                      __pyx_t_38 = __pyx_t_37;
                    }
                    __pyx_t_37 = __pyx_t_38;
                  } else {
                    __pyx_t_37 = __pyx_t_36;
                  }
                  __pyx_t_36 = __pyx_t_37;
                } else {
                  __pyx_t_36 = __pyx_t_35;
                }
                __pyx_t_35 = __pyx_t_36;
              } else {
                __pyx_t_35 = __pyx_t_28;
              }
              if (__pyx_t_35) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line550")'> 550:                                 if box[nx,ny,nz] == peptideScore:</pre>
<pre id='line550' class='code' style='background-color: #FFFFd4'>
                /* "epitopsy/cython/dx_cython.pyx":550
 *                             if (nx >= 0 and nx <code><</code> xdim and ny >= 0 and ny <code><</code> ydim and
 *                                 nz >= 0 and nz <code><</code> zdim):
 *                                 if box[nx,ny,nz] == peptideScore:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                     box[x,y,z] = dummy_score
 *         box = switch_value(box, xdim, ydim, zdim, dummy_score, peptideScore)
 */
                __pyx_t_34 = __pyx_v_nx;
                __pyx_t_41 = __pyx_v_ny;
                __pyx_t_42 = __pyx_v_nz;
                __pyx_t_43 = -1;
                if (__pyx_t_34 <code><</code> 0) {
                  __pyx_t_34 += __pyx_pybuffernd_box.diminfo[0].shape;
                  if (unlikely(__pyx_t_34 <code><</code> 0)) __pyx_t_43 = 0;
                } else if (unlikely(__pyx_t_34 >= __pyx_pybuffernd_box.diminfo[0].shape)) __pyx_t_43 = 0;
                if (__pyx_t_41 <code><</code> 0) {
                  __pyx_t_41 += __pyx_pybuffernd_box.diminfo[1].shape;
                  if (unlikely(__pyx_t_41 <code><</code> 0)) __pyx_t_43 = 1;
                } else if (unlikely(__pyx_t_41 >= __pyx_pybuffernd_box.diminfo[1].shape)) __pyx_t_43 = 1;
                if (__pyx_t_42 <code><</code> 0) {
                  __pyx_t_42 += __pyx_pybuffernd_box.diminfo[2].shape;
                  if (unlikely(__pyx_t_42 <code><</code> 0)) __pyx_t_43 = 2;
                } else if (unlikely(__pyx_t_42 >= __pyx_pybuffernd_box.diminfo[2].shape)) __pyx_t_43 = 2;
                if (unlikely(__pyx_t_43 != -1)) {
                  <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_43);
                 <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 550; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                }
                __pyx_t_35 = (((*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_41, __pyx_pybuffernd_box.diminfo[1].strides, __pyx_t_42, __pyx_pybuffernd_box.diminfo[2].strides)) == __pyx_v_peptideScore) != 0);
                if (__pyx_t_35) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line551")'> 551:                                     box[x,y,z] = dummy_score</pre>
<pre id='line551' class='code' style='background-color: #FFFFd4'>
                  /* "epitopsy/cython/dx_cython.pyx":551
 *                                 nz >= 0 and nz <code><</code> zdim):
 *                                 if box[nx,ny,nz] == peptideScore:
 *                                     box[x,y,z] = dummy_score             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         box = switch_value(box, xdim, ydim, zdim, dummy_score, peptideScore)
 * 
 */
                  __pyx_t_43 = __pyx_v_x;
                  __pyx_t_44 = __pyx_v_y;
                  __pyx_t_45 = __pyx_v_z;
                  __pyx_t_46 = -1;
                  if (__pyx_t_43 <code><</code> 0) {
                    __pyx_t_43 += __pyx_pybuffernd_box.diminfo[0].shape;
                    if (unlikely(__pyx_t_43 <code><</code> 0)) __pyx_t_46 = 0;
                  } else if (unlikely(__pyx_t_43 >= __pyx_pybuffernd_box.diminfo[0].shape)) __pyx_t_46 = 0;
                  if (__pyx_t_44 <code><</code> 0) {
                    __pyx_t_44 += __pyx_pybuffernd_box.diminfo[1].shape;
                    if (unlikely(__pyx_t_44 <code><</code> 0)) __pyx_t_46 = 1;
                  } else if (unlikely(__pyx_t_44 >= __pyx_pybuffernd_box.diminfo[1].shape)) __pyx_t_46 = 1;
                  if (__pyx_t_45 <code><</code> 0) {
                    __pyx_t_45 += __pyx_pybuffernd_box.diminfo[2].shape;
                    if (unlikely(__pyx_t_45 <code><</code> 0)) __pyx_t_46 = 2;
                  } else if (unlikely(__pyx_t_45 >= __pyx_pybuffernd_box.diminfo[2].shape)) __pyx_t_46 = 2;
                  if (unlikely(__pyx_t_46 != -1)) {
                    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_46);
                   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 551; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                  }
                  *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_box.rcbuffer->pybuffer.buf, __pyx_t_43, __pyx_pybuffernd_box.diminfo[0].strides, __pyx_t_44, __pyx_pybuffernd_box.diminfo[1].strides, __pyx_t_45, __pyx_pybuffernd_box.diminfo[2].strides) = __pyx_v_dummy_score;
                  goto __pyx_L15;
                }
                __pyx_L15:;
                goto __pyx_L14;
              }
              __pyx_L14:;
            }
            goto __pyx_L11;
          }
          __pyx_L11:;
        }
      }
    }
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line552")'> 552:         box = switch_value(box, xdim, ydim, zdim, dummy_score, peptideScore)</pre>
<pre id='line552' class='code' style='background-color: #FFFF57'>
    /* "epitopsy/cython/dx_cython.pyx":552
 *                                 if box[nx,ny,nz] == peptideScore:
 *                                     box[x,y,z] = dummy_score
 *         box = switch_value(box, xdim, ydim, zdim, dummy_score, peptideScore)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     return box
 */
    __pyx_t_6 = ((PyObject *)__pyx_f_8epitopsy_6cython_9dx_cython_switch_value(((PyArrayObject *)__pyx_v_box), __pyx_v_xdim, __pyx_v_ydim, __pyx_v_zdim, __pyx_v_dummy_score, __pyx_v_peptideScore));<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    {
      __Pyx_BufFmt_StackElem __pyx_stack[1];
      <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer);
      __pyx_t_21 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_6), &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 3, 0, __pyx_stack);
      if (unlikely(__pyx_t_21 <code><</code> 0)) {
        <span class='py_c_api'>PyErr_Fetch</span>(&__pyx_t_47, &__pyx_t_48, &__pyx_t_49);
        if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer, (PyObject*)__pyx_v_box, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 3, 0, __pyx_stack) == -1)) {
          Py_XDECREF(__pyx_t_47); Py_XDECREF(__pyx_t_48); Py_XDECREF(__pyx_t_49);
          <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
        } else {
          <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_47, __pyx_t_48, __pyx_t_49);
        }
      }
      __pyx_pybuffernd_box.diminfo[0].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_box.diminfo[0].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_box.diminfo[1].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_box.diminfo[1].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_box.diminfo[2].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_box.diminfo[2].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[2];
      if (unlikely(__pyx_t_21 <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_box));
    __pyx_v_box = ((PyArrayObject *)__pyx_t_6);
    __pyx_t_6 = 0;
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line553")'> 553: </pre>
<pre id='line553' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF1b' onclick='toggleDiv("line554")'> 554:     return box</pre>
<pre id='line554' class='code' style='background-color: #FFFF1b'>
  /* "epitopsy/cython/dx_cython.pyx":554
 *         box = switch_value(box, xdim, ydim, zdim, dummy_score, peptideScore)
 * 
 *     return box             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_box));
  __pyx_r = ((PyObject *)__pyx_v_box);
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&__pyx_type, &__pyx_value, &__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_neighbors.rcbuffer->pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython.extend_nice_surface", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_neighbors.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_next_neighbors.rcbuffer->pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_next_neighbors);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_box);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_8epitopsy_6cython_9dx_cython_21find_protein_surface(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_8epitopsy_6cython_9dx_cython_21find_protein_surface = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("find_protein_surface"), (PyCFunction)__pyx_pw_8epitopsy_6cython_9dx_cython_21find_protein_surface, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_8epitopsy_6cython_9dx_cython_21find_protein_surface(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_protein_score = 0;
  PyObject *__pyx_v_solvent_score = 0;
  PyObject *__pyx_v_surface_score = 0;
  PyArrayObject *__pyx_v_box = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("find_protein_surface (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__protein_score,&__pyx_n_s__solvent_score,&__pyx_n_s__surface_score,&__pyx_n_s__box,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__protein_score)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__solvent_score)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find_protein_surface", 1, 4, 4, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__surface_score)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find_protein_surface", 1, 4, 4, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__box)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find_protein_surface", 1, 4, 4, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "find_protein_surface") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_protein_score = values[0];
    __pyx_v_solvent_score = values[1];
    __pyx_v_surface_score = values[2];
    __pyx_v_box = ((PyArrayObject *)values[3]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find_protein_surface", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython.find_protein_surface", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_box), __pyx_ptype_5numpy_ndarray, 1, "box", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 560; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_8epitopsy_6cython_9dx_cython_20find_protein_surface(__pyx_self, __pyx_v_protein_score, __pyx_v_solvent_score, __pyx_v_surface_score, __pyx_v_box);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line555")'> 555: </pre>
<pre id='line555' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line556")'> 556: </pre>
<pre id='line556' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line557")'> 557: def find_protein_surface(protein_score,</pre>
<pre id='line557' class='code' style='background-color: #FFFF5b'>
/* "epitopsy/cython/dx_cython.pyx":557
 * 
 * 
 * def find_protein_surface(protein_score,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                  solvent_score,
 *                  surface_score,
 */

static PyObject *__pyx_pf_8epitopsy_6cython_9dx_cython_20find_protein_surface(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_protein_score, PyObject *__pyx_v_solvent_score, PyObject *__pyx_v_surface_score, PyArrayObject *__pyx_v_box) {
  __Pyx_LocalBuf_ND __pyx_pybuffernd_box;
  __Pyx_Buffer __pyx_pybuffer_box;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("find_protein_surface", 0);
  __pyx_pybuffer_box.pybuffer.buf = NULL;
  __pyx_pybuffer_box.refcount = 0;
  __pyx_pybuffernd_box.data = NULL;
  __pyx_pybuffernd_box.rcbuffer = &__pyx_pybuffer_box;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer, (PyObject*)__pyx_v_box, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_box.diminfo[0].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_box.diminfo[0].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_box.diminfo[1].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_box.diminfo[1].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_box.diminfo[2].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_box.diminfo[2].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[2];

  /* "epitopsy/cython/dx_cython.pyx":557
 * 
 * 
 * def find_protein_surface(protein_score,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                  solvent_score,
 *                  surface_score,
 */
  __pyx_k_tuple_130 = <span class='py_c_api'>PyTuple_Pack</span>(4, ((PyObject *)__pyx_n_s__protein_score), ((PyObject *)__pyx_n_s__solvent_score), ((PyObject *)__pyx_n_s__surface_score), ((PyObject *)__pyx_n_s__box));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_130)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_130);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_130));

  /* "epitopsy/cython/dx_cython.pyx":557
 * 
 * 
 * def find_protein_surface(protein_score,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                  solvent_score,
 *                  surface_score,
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_8epitopsy_6cython_9dx_cython_21find_protein_surface, NULL, __pyx_n_s_110);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_132, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_131 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(4, 0, 4, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_130, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_109, __pyx_n_s_132, 557, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_131)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line558")'> 558:                  solvent_score,</pre>
<pre id='line558' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line559")'> 559:                  surface_score,</pre>
<pre id='line559' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line560")'> 560:                  np.ndarray[np.float64_t, ndim=3] box):</pre>
<pre id='line560' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF52' onclick='toggleDiv("line561")'> 561:     return _find_protein_surface(&lt;float&gt; protein_score, &lt;float&gt; solvent_score,</pre>
<pre id='line561' class='code' style='background-color: #FFFF52'>
  /* "epitopsy/cython/dx_cython.pyx":561
 *                  surface_score,
 *                  np.ndarray[np.float64_t, ndim=3] box):
 *     return _find_protein_surface(<code><</code>float> protein_score, <code><</code>float> solvent_score,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                          <code><</code>float> surface_score, box)
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_protein_score);<span class='error_goto'> if (unlikely((__pyx_t_1 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 561; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_solvent_score);<span class='error_goto'> if (unlikely((__pyx_t_2 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 561; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line562")'> 562:                          &lt;float&gt; surface_score, box)</pre>
<pre id='line562' class='code' style='background-color: #FFFF4d'>
  /* "epitopsy/cython/dx_cython.pyx":562
 *                  np.ndarray[np.float64_t, ndim=3] box):
 *     return _find_protein_surface(<code><</code>float> protein_score, <code><</code>float> solvent_score,
 *                          <code><</code>float> surface_score, box)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef double[:,:,:] check_protein_neighbor(double[:,:,:] box, int xdim, int ydim,
 */
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_surface_score);<span class='error_goto'> if (unlikely((__pyx_t_3 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = ((PyObject *)__pyx_f_8epitopsy_6cython_9dx_cython__find_protein_surface(((float)__pyx_t_1), ((float)__pyx_t_2), ((float)__pyx_t_3), ((PyArrayObject *)__pyx_v_box)));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 561; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&__pyx_type, &__pyx_value, &__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython.find_protein_surface", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line563")'> 563: </pre>
<pre id='line563' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line564")'> 564: cdef double[:,:,:] check_protein_neighbor(double[:,:,:] box, int xdim, int ydim,</pre>
<pre id='line564' class='code' style='background-color: #FFFFff'>
/* "epitopsy/cython/dx_cython.pyx":564
 *                          <code><</code>float> surface_score, box)
 * 
 * cdef double[:,:,:] check_protein_neighbor(double[:,:,:] box, int xdim, int ydim,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         int zdim, int x, int y, int z, float solvent_score,
 *         float surface_score):
 */

static __Pyx_memviewslice __pyx_f_8epitopsy_6cython_9dx_cython_check_protein_neighbor(__Pyx_memviewslice __pyx_v_box, int __pyx_v_xdim, int __pyx_v_ydim, int __pyx_v_zdim, int __pyx_v_x, int __pyx_v_y, int __pyx_v_z, float __pyx_v_solvent_score, float __pyx_v_surface_score) {
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_k;
  int __pyx_v_posx;
  int __pyx_v_posy;
  int __pyx_v_posz;
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("check_protein_neighbor", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line565")'> 565:         int zdim, int x, int y, int z, float solvent_score,</pre>
<pre id='line565' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line566")'> 566:         float surface_score):</pre>
<pre id='line566' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line567")'> 567:     cdef int i,j,k</pre>
<pre id='line567' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line568")'> 568:     cdef int posx,posy,posz</pre>
<pre id='line568' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line569")'> 569:     for i from -1 &lt;= i &lt;= 1:</pre>
<pre id='line569' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":569
 *     cdef int i,j,k
 *     cdef int posx,posy,posz
 *     for i from -1 <code><</code>= i <code><</code>= 1:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for j from -1 <code><</code>= j <code><</code>= 1:
 *             for k from -1 <code><</code>= k <code><</code>= 1:
 */
  for (__pyx_v_i = -1; __pyx_v_i <code><</code>= 1; __pyx_v_i++) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line570")'> 570:         for j from -1 &lt;= j &lt;= 1:</pre>
<pre id='line570' class='code' style='background-color: #FFFFff'>
    /* "epitopsy/cython/dx_cython.pyx":570
 *     cdef int posx,posy,posz
 *     for i from -1 <code><</code>= i <code><</code>= 1:
 *         for j from -1 <code><</code>= j <code><</code>= 1:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for k from -1 <code><</code>= k <code><</code>= 1:
 *                 if i == 0 and j == 0 and k == 0:
 */
    for (__pyx_v_j = -1; __pyx_v_j <code><</code>= 1; __pyx_v_j++) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line571")'> 571:             for k from -1 &lt;= k &lt;= 1:</pre>
<pre id='line571' class='code' style='background-color: #FFFFff'>
      /* "epitopsy/cython/dx_cython.pyx":571
 *     for i from -1 <code><</code>= i <code><</code>= 1:
 *         for j from -1 <code><</code>= j <code><</code>= 1:
 *             for k from -1 <code><</code>= k <code><</code>= 1:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 if i == 0 and j == 0 and k == 0:
 *                     continue
 */
      for (__pyx_v_k = -1; __pyx_v_k <code><</code>= 1; __pyx_v_k++) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line572")'> 572:                 if i == 0 and j == 0 and k == 0:</pre>
<pre id='line572' class='code' style='background-color: #FFFFff'>
        /* "epitopsy/cython/dx_cython.pyx":572
 *         for j from -1 <code><</code>= j <code><</code>= 1:
 *             for k from -1 <code><</code>= k <code><</code>= 1:
 *                 if i == 0 and j == 0 and k == 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     continue
 *                 else:
 */
        __pyx_t_1 = ((__pyx_v_i == 0) != 0);
        if (__pyx_t_1) {
          __pyx_t_2 = ((__pyx_v_j == 0) != 0);
          if (__pyx_t_2) {
            __pyx_t_3 = ((__pyx_v_k == 0) != 0);
            __pyx_t_4 = __pyx_t_3;
          } else {
            __pyx_t_4 = __pyx_t_2;
          }
          __pyx_t_2 = __pyx_t_4;
        } else {
          __pyx_t_2 = __pyx_t_1;
        }
        if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line573")'> 573:                     continue</pre>
<pre id='line573' class='code' style='background-color: #FFFFff'>
          /* "epitopsy/cython/dx_cython.pyx":573
 *             for k from -1 <code><</code>= k <code><</code>= 1:
 *                 if i == 0 and j == 0 and k == 0:
 *                     continue             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 else:
 *                     posx = x + i
 */
          goto __pyx_L7_continue;
          goto __pyx_L9;
        }
        /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line574")'> 574:                 else:</pre>
<pre id='line574' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line575")'> 575:                     posx = x + i</pre>
<pre id='line575' class='code' style='background-color: #FFFFff'>
          /* "epitopsy/cython/dx_cython.pyx":575
 *                     continue
 *                 else:
 *                     posx = x + i             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     posy = y + j
 *                     posz = z + k
 */
          __pyx_v_posx = (__pyx_v_x + __pyx_v_i);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line576")'> 576:                     posy = y + j</pre>
<pre id='line576' class='code' style='background-color: #FFFFff'>
          /* "epitopsy/cython/dx_cython.pyx":576
 *                 else:
 *                     posx = x + i
 *                     posy = y + j             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     posz = z + k
 * 
 */
          __pyx_v_posy = (__pyx_v_y + __pyx_v_j);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line577")'> 577:                     posz = z + k</pre>
<pre id='line577' class='code' style='background-color: #FFFFff'>
          /* "epitopsy/cython/dx_cython.pyx":577
 *                     posx = x + i
 *                     posy = y + j
 *                     posz = z + k             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                     if (posx >= 0 and posx <code><</code> xdim
 */
          __pyx_v_posz = (__pyx_v_z + __pyx_v_k);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line578")'> 578: </pre>
<pre id='line578' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line579")'> 579:                     if (posx &gt;= 0 and posx &lt; xdim</pre>
<pre id='line579' class='code' style='background-color: #FFFFff'>
          /* "epitopsy/cython/dx_cython.pyx":579
 *                     posz = z + k
 * 
 *                     if (posx >= 0 and posx <code><</code> xdim             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         and posy >= 0 and posy <code><</code> ydim
 *                         and posz >= 0 and posz <code><</code> zdim):
 */
          __pyx_t_2 = ((__pyx_v_posx >= 0) != 0);
          if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line580")'> 580:                         and posy &gt;= 0 and posy &lt; ydim</pre>
<pre id='line580' class='code' style='background-color: #FFFFff'>
            /* "epitopsy/cython/dx_cython.pyx":580
 * 
 *                     if (posx >= 0 and posx <code><</code> xdim
 *                         and posy >= 0 and posy <code><</code> ydim             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         and posz >= 0 and posz <code><</code> zdim):
 *                         if box[posx,posy,posz] == solvent_score:
 */
            __pyx_t_1 = ((__pyx_v_posx <code><</code> __pyx_v_xdim) != 0);
            if (__pyx_t_1) {
              __pyx_t_4 = ((__pyx_v_posy >= 0) != 0);
              if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line581")'> 581:                         and posz &gt;= 0 and posz &lt; zdim):</pre>
<pre id='line581' class='code' style='background-color: #FFFFff'>
                /* "epitopsy/cython/dx_cython.pyx":581
 *                     if (posx >= 0 and posx <code><</code> xdim
 *                         and posy >= 0 and posy <code><</code> ydim
 *                         and posz >= 0 and posz <code><</code> zdim):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         if box[posx,posy,posz] == solvent_score:
 *                             box[x,y,z] = surface_score
 */
                __pyx_t_3 = ((__pyx_v_posy <code><</code> __pyx_v_ydim) != 0);
                if (__pyx_t_3) {
                  __pyx_t_5 = ((__pyx_v_posz >= 0) != 0);
                  if (__pyx_t_5) {
                    __pyx_t_6 = ((__pyx_v_posz <code><</code> __pyx_v_zdim) != 0);
                    __pyx_t_7 = __pyx_t_6;
                  } else {
                    __pyx_t_7 = __pyx_t_5;
                  }
                  __pyx_t_5 = __pyx_t_7;
                } else {
                  __pyx_t_5 = __pyx_t_3;
                }
                __pyx_t_3 = __pyx_t_5;
              } else {
                __pyx_t_3 = __pyx_t_4;
              }
              __pyx_t_4 = __pyx_t_3;
            } else {
              __pyx_t_4 = __pyx_t_1;
            }
            __pyx_t_1 = __pyx_t_4;
          } else {
            __pyx_t_1 = __pyx_t_2;
          }
          if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line582")'> 582:                         if box[posx,posy,posz] == solvent_score:</pre>
<pre id='line582' class='code' style='background-color: #FFFFd4'>
            /* "epitopsy/cython/dx_cython.pyx":582
 *                         and posy >= 0 and posy <code><</code> ydim
 *                         and posz >= 0 and posz <code><</code> zdim):
 *                         if box[posx,posy,posz] == solvent_score:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             box[x,y,z] = surface_score
 *                             return box
 */
            __pyx_t_8 = __pyx_v_posx;
            __pyx_t_9 = __pyx_v_posy;
            __pyx_t_10 = __pyx_v_posz;
            __pyx_t_11 = -1;
            if (__pyx_t_8 <code><</code> 0) {
              __pyx_t_8 += __pyx_v_box.shape[0];
              if (unlikely(__pyx_t_8 <code><</code> 0)) __pyx_t_11 = 0;
            } else if (unlikely(__pyx_t_8 >= __pyx_v_box.shape[0])) __pyx_t_11 = 0;
            if (__pyx_t_9 <code><</code> 0) {
              __pyx_t_9 += __pyx_v_box.shape[1];
              if (unlikely(__pyx_t_9 <code><</code> 0)) __pyx_t_11 = 1;
            } else if (unlikely(__pyx_t_9 >= __pyx_v_box.shape[1])) __pyx_t_11 = 1;
            if (__pyx_t_10 <code><</code> 0) {
              __pyx_t_10 += __pyx_v_box.shape[2];
              if (unlikely(__pyx_t_10 <code><</code> 0)) __pyx_t_11 = 2;
            } else if (unlikely(__pyx_t_10 >= __pyx_v_box.shape[2])) __pyx_t_11 = 2;
            if (unlikely(__pyx_t_11 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
             <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 582; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            __pyx_t_1 = (((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_8 * __pyx_v_box.strides[0]) ) + __pyx_t_9 * __pyx_v_box.strides[1]) ) + __pyx_t_10 * __pyx_v_box.strides[2]) ))) == __pyx_v_solvent_score) != 0);
            if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line583")'> 583:                             box[x,y,z] = surface_score</pre>
<pre id='line583' class='code' style='background-color: #FFFFd4'>
              /* "epitopsy/cython/dx_cython.pyx":583
 *                         and posz >= 0 and posz <code><</code> zdim):
 *                         if box[posx,posy,posz] == solvent_score:
 *                             box[x,y,z] = surface_score             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             return box
 * 
 */
              __pyx_t_11 = __pyx_v_x;
              __pyx_t_12 = __pyx_v_y;
              __pyx_t_13 = __pyx_v_z;
              __pyx_t_14 = -1;
              if (__pyx_t_11 <code><</code> 0) {
                __pyx_t_11 += __pyx_v_box.shape[0];
                if (unlikely(__pyx_t_11 <code><</code> 0)) __pyx_t_14 = 0;
              } else if (unlikely(__pyx_t_11 >= __pyx_v_box.shape[0])) __pyx_t_14 = 0;
              if (__pyx_t_12 <code><</code> 0) {
                __pyx_t_12 += __pyx_v_box.shape[1];
                if (unlikely(__pyx_t_12 <code><</code> 0)) __pyx_t_14 = 1;
              } else if (unlikely(__pyx_t_12 >= __pyx_v_box.shape[1])) __pyx_t_14 = 1;
              if (__pyx_t_13 <code><</code> 0) {
                __pyx_t_13 += __pyx_v_box.shape[2];
                if (unlikely(__pyx_t_13 <code><</code> 0)) __pyx_t_14 = 2;
              } else if (unlikely(__pyx_t_13 >= __pyx_v_box.shape[2])) __pyx_t_14 = 2;
              if (unlikely(__pyx_t_14 != -1)) {
                <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
               <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 583; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              }
              *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_11 * __pyx_v_box.strides[0]) ) + __pyx_t_12 * __pyx_v_box.strides[1]) ) + __pyx_t_13 * __pyx_v_box.strides[2]) )) = __pyx_v_surface_score;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line584")'> 584:                             return box</pre>
<pre id='line584' class='code' style='background-color: #FFFFff'>
              /* "epitopsy/cython/dx_cython.pyx":584
 *                         if box[posx,posy,posz] == solvent_score:
 *                             box[x,y,z] = surface_score
 *                             return box             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     return box
 */
              __PYX_INC_MEMVIEW(&__pyx_v_box, 0);
              __pyx_r = __pyx_v_box;
              goto __pyx_L0;
              goto __pyx_L11;
            }
            __pyx_L11:;
            goto __pyx_L10;
          }
          __pyx_L10:;
        }
        __pyx_L9:;
        __pyx_L7_continue:;
      }
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line585")'> 585: </pre>
<pre id='line585' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line586")'> 586:     return box</pre>
<pre id='line586' class='code' style='background-color: #FFFF8d'>
  /* "epitopsy/cython/dx_cython.pyx":586
 *                             return box
 * 
 *     return box             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef np.ndarray _find_protein_surface(float protein_score, float solvent_score,
 */
  __PYX_INC_MEMVIEW(&__pyx_v_box, 0);
  __pyx_r = __pyx_v_box;
  goto __pyx_L0;

  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython.check_protein_neighbor", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = __pyx_r;
  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError,"Memoryview return value is not initialized");
  }
  __pyx_L2:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line587")'> 587: </pre>
<pre id='line587' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line588")'> 588: cdef np.ndarray _find_protein_surface(float protein_score, float solvent_score,</pre>
<pre id='line588' class='code' style='background-color: #FFFFd4'>
/* "epitopsy/cython/dx_cython.pyx":588
 *     return box
 * 
 * cdef np.ndarray _find_protein_surface(float protein_score, float solvent_score,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                   float surface_score,
 *                   np.ndarray[np.float64_t, ndim=3] box_np):
 */

static PyArrayObject *__pyx_f_8epitopsy_6cython_9dx_cython__find_protein_surface(float __pyx_v_protein_score, float __pyx_v_solvent_score, float __pyx_v_surface_score, PyArrayObject *__pyx_v_box_np) {
  int __pyx_v_x;
  int __pyx_v_y;
  int __pyx_v_z;
  __Pyx_memviewslice __pyx_v_box = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_xdim;
  int __pyx_v_ydim;
  int __pyx_v_zdim;
  CYTHON_UNUSED int __pyx_v_stop;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_box_np;
  __Pyx_Buffer __pyx_pybuffer_box_np;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_find_protein_surface", 0);
  __pyx_pybuffer_box_np.pybuffer.buf = NULL;
  __pyx_pybuffer_box_np.refcount = 0;
  __pyx_pybuffernd_box_np.data = NULL;
  __pyx_pybuffernd_box_np.rcbuffer = &__pyx_pybuffer_box_np;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_box_np.rcbuffer->pybuffer, (PyObject*)__pyx_v_box_np, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 588; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_box_np.diminfo[0].strides = __pyx_pybuffernd_box_np.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_box_np.diminfo[0].shape = __pyx_pybuffernd_box_np.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_box_np.diminfo[1].strides = __pyx_pybuffernd_box_np.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_box_np.diminfo[1].shape = __pyx_pybuffernd_box_np.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_box_np.diminfo[2].strides = __pyx_pybuffernd_box_np.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_box_np.diminfo[2].shape = __pyx_pybuffernd_box_np.rcbuffer->pybuffer.shape[2];
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line589")'> 589:                   float surface_score,</pre>
<pre id='line589' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line590")'> 590:                   np.ndarray[np.float64_t, ndim=3] box_np):</pre>
<pre id='line590' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line591")'> 591:     cdef int x,y,z,i,j,k</pre>
<pre id='line591' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line592")'> 592:     cdef double[:,:,:] box = box_np</pre>
<pre id='line592' class='code' style='background-color: #FFFFd4'>
  /* "epitopsy/cython/dx_cython.pyx":592
 *                   np.ndarray[np.float64_t, ndim=3] box_np):
 *     cdef int x,y,z,i,j,k
 *     cdef double[:,:,:] box = box_np             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int posx, poxy, posz
 *     cdef int xdim = box.shape[0]
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_double</span>(((PyObject *)__pyx_v_box_np));
  if (unlikely(!__pyx_t_1.memview))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 592; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_box = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line593")'> 593:     cdef int posx, poxy, posz</pre>
<pre id='line593' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line594")'> 594:     cdef int xdim = box.shape[0]</pre>
<pre id='line594' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":594
 *     cdef double[:,:,:] box = box_np
 *     cdef int posx, poxy, posz
 *     cdef int xdim = box.shape[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int ydim = box.shape[1]
 *     cdef int zdim = box.shape[2]
 */
  __pyx_v_xdim = (__pyx_v_box.shape[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line595")'> 595:     cdef int ydim = box.shape[1]</pre>
<pre id='line595' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":595
 *     cdef int posx, poxy, posz
 *     cdef int xdim = box.shape[0]
 *     cdef int ydim = box.shape[1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int zdim = box.shape[2]
 *     # use stop to interupt the loop over the neighbors
 */
  __pyx_v_ydim = (__pyx_v_box.shape[1]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line596")'> 596:     cdef int zdim = box.shape[2]</pre>
<pre id='line596' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":596
 *     cdef int xdim = box.shape[0]
 *     cdef int ydim = box.shape[1]
 *     cdef int zdim = box.shape[2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     # use stop to interupt the loop over the neighbors
 *     cdef int stop = 0
 */
  __pyx_v_zdim = (__pyx_v_box.shape[2]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line597")'> 597:     # use stop to interupt the loop over the neighbors</pre>
<pre id='line597' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line598")'> 598:     cdef int stop = 0</pre>
<pre id='line598' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":598
 *     cdef int zdim = box.shape[2]
 *     # use stop to interupt the loop over the neighbors
 *     cdef int stop = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef float score
 * 
 */
  __pyx_v_stop = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line599")'> 599:     cdef float score</pre>
<pre id='line599' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line600")'> 600: </pre>
<pre id='line600' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line601")'> 601:     for x in range(xdim):</pre>
<pre id='line601' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":601
 *     cdef float score
 * 
 *     for x in range(xdim):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for y in range(ydim):
 *             for z in range(zdim):
 */
  __pyx_t_2 = __pyx_v_xdim;
  for (__pyx_t_3 = 0; __pyx_t_3 <code><</code> __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_x = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line602")'> 602:         for y in range(ydim):</pre>
<pre id='line602' class='code' style='background-color: #FFFFff'>
    /* "epitopsy/cython/dx_cython.pyx":602
 * 
 *     for x in range(xdim):
 *         for y in range(ydim):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for z in range(zdim):
 *                 # only check points from the proteins interior
 */
    __pyx_t_4 = __pyx_v_ydim;
    for (__pyx_t_5 = 0; __pyx_t_5 <code><</code> __pyx_t_4; __pyx_t_5+=1) {
      __pyx_v_y = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line603")'> 603:             for z in range(zdim):</pre>
<pre id='line603' class='code' style='background-color: #FFFFff'>
      /* "epitopsy/cython/dx_cython.pyx":603
 *     for x in range(xdim):
 *         for y in range(ydim):
 *             for z in range(zdim):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 # only check points from the proteins interior
 *                 if box[x,y,z] == protein_score:
 */
      __pyx_t_6 = __pyx_v_zdim;
      for (__pyx_t_7 = 0; __pyx_t_7 <code><</code> __pyx_t_6; __pyx_t_7+=1) {
        __pyx_v_z = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line604")'> 604:                 # only check points from the proteins interior</pre>
<pre id='line604' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line605")'> 605:                 if box[x,y,z] == protein_score:</pre>
<pre id='line605' class='code' style='background-color: #FFFFd4'>
        /* "epitopsy/cython/dx_cython.pyx":605
 *             for z in range(zdim):
 *                 # only check points from the proteins interior
 *                 if box[x,y,z] == protein_score:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     box = check_protein_neighbor(box, xdim, ydim, zdim, x, y, z,
 *                             solvent_score, surface_score)
 */
        __pyx_t_8 = __pyx_v_x;
        __pyx_t_9 = __pyx_v_y;
        __pyx_t_10 = __pyx_v_z;
        __pyx_t_11 = -1;
        if (__pyx_t_8 <code><</code> 0) {
          __pyx_t_8 += __pyx_v_box.shape[0];
          if (unlikely(__pyx_t_8 <code><</code> 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_8 >= __pyx_v_box.shape[0])) __pyx_t_11 = 0;
        if (__pyx_t_9 <code><</code> 0) {
          __pyx_t_9 += __pyx_v_box.shape[1];
          if (unlikely(__pyx_t_9 <code><</code> 0)) __pyx_t_11 = 1;
        } else if (unlikely(__pyx_t_9 >= __pyx_v_box.shape[1])) __pyx_t_11 = 1;
        if (__pyx_t_10 <code><</code> 0) {
          __pyx_t_10 += __pyx_v_box.shape[2];
          if (unlikely(__pyx_t_10 <code><</code> 0)) __pyx_t_11 = 2;
        } else if (unlikely(__pyx_t_10 >= __pyx_v_box.shape[2])) __pyx_t_11 = 2;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 605; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_12 = (((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_8 * __pyx_v_box.strides[0]) ) + __pyx_t_9 * __pyx_v_box.strides[1]) ) + __pyx_t_10 * __pyx_v_box.strides[2]) ))) == __pyx_v_protein_score) != 0);
        if (__pyx_t_12) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line606")'> 606:                     box = check_protein_neighbor(box, xdim, ydim, zdim, x, y, z,</pre>
<pre id='line606' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line607")'> 607:                             solvent_score, surface_score)</pre>
<pre id='line607' class='code' style='background-color: #FFFFff'>
          /* "epitopsy/cython/dx_cython.pyx":607
 *                 if box[x,y,z] == protein_score:
 *                     box = check_protein_neighbor(box, xdim, ydim, zdim, x, y, z,
 *                             solvent_score, surface_score)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #                    stop = 0
 * #                    # check neighbor grid points
 */
          __pyx_t_13 = __pyx_f_8epitopsy_6cython_9dx_cython_check_protein_neighbor(__pyx_v_box, __pyx_v_xdim, __pyx_v_ydim, __pyx_v_zdim, __pyx_v_x, __pyx_v_y, __pyx_v_z, __pyx_v_solvent_score, __pyx_v_surface_score);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          __PYX_XDEC_MEMVIEW(&__pyx_v_box, 1);
          __pyx_v_box = __pyx_t_13;
          __pyx_t_13.memview = NULL;
          __pyx_t_13.data = NULL;
          goto __pyx_L9;
        }
        __pyx_L9:;
      }
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line608")'> 608: #                    stop = 0</pre>
<pre id='line608' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line609")'> 609: #                    # check neighbor grid points</pre>
<pre id='line609' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line610")'> 610: #                    for i from -1 &lt;= i &lt;= 1:</pre>
<pre id='line610' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line611")'> 611: #                        if stop == 1:</pre>
<pre id='line611' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line612")'> 612: #                            break</pre>
<pre id='line612' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line613")'> 613: #                        for j from -1 &lt;= j &lt;= 1:</pre>
<pre id='line613' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line614")'> 614: #                            if stop == 1:</pre>
<pre id='line614' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line615")'> 615: #                                break</pre>
<pre id='line615' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line616")'> 616: #                            for k from -1 &lt;= k &lt;= 1:</pre>
<pre id='line616' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line617")'> 617: #                                if i == 0 and j == 0 and k == 0:</pre>
<pre id='line617' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line618")'> 618: #                                    continue</pre>
<pre id='line618' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line619")'> 619: #                                else:</pre>
<pre id='line619' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line620")'> 620: #                                    posx = x + i</pre>
<pre id='line620' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line621")'> 621: #                                    posy = y + j</pre>
<pre id='line621' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line622")'> 622: #                                    posz = z + k</pre>
<pre id='line622' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line623")'> 623: #</pre>
<pre id='line623' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line624")'> 624: #                                    if (posx &gt;= 0 and posx &lt; xdim</pre>
<pre id='line624' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line625")'> 625: #                                        and posy &gt;= 0 and posy &lt; ydim</pre>
<pre id='line625' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line626")'> 626: #                                        and posz &gt;= 0 and posz &lt; zdim):</pre>
<pre id='line626' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line627")'> 627: #                                        if box[posx,posy,posz] == solvent_score:</pre>
<pre id='line627' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line628")'> 628: #                                            box[x,y,z] = surface_score</pre>
<pre id='line628' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line629")'> 629: #                                            stop = 1</pre>
<pre id='line629' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line630")'> 630: #                                            break</pre>
<pre id='line630' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line631")'> 631:     return box_np</pre>
<pre id='line631' class='code' style='background-color: #FFFF20'>
  /* "epitopsy/cython/dx_cython.pyx":631
 * #                                            stop = 1
 * #                                            break
 *     return box_np             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_box_np));
  __pyx_r = ((PyArrayObject *)__pyx_v_box_np);
  goto __pyx_L0;

  __pyx_r = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&__pyx_t_1, 1);
  __PYX_XDEC_MEMVIEW(&__pyx_t_13, 1);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&__pyx_type, &__pyx_value, &__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box_np.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython._find_protein_surface", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box_np.rcbuffer->pybuffer);
  __pyx_L2:;
  __PYX_XDEC_MEMVIEW(&__pyx_v_box, 1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>((PyObject *)__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_8epitopsy_6cython_9dx_cython_23find_solvent_surface(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_8epitopsy_6cython_9dx_cython_23find_solvent_surface = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("find_solvent_surface"), (PyCFunction)__pyx_pw_8epitopsy_6cython_9dx_cython_23find_solvent_surface, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_8epitopsy_6cython_9dx_cython_23find_solvent_surface(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_protein_score = 0;
  PyObject *__pyx_v_solvent_score = 0;
  PyObject *__pyx_v_surface_score = 0;
  PyArrayObject *__pyx_v_box = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("find_solvent_surface (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__protein_score,&__pyx_n_s__solvent_score,&__pyx_n_s__surface_score,&__pyx_n_s__box,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__protein_score)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__solvent_score)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find_solvent_surface", 1, 4, 4, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__surface_score)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find_solvent_surface", 1, 4, 4, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__box)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find_solvent_surface", 1, 4, 4, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "find_solvent_surface") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_protein_score = values[0];
    __pyx_v_solvent_score = values[1];
    __pyx_v_surface_score = values[2];
    __pyx_v_box = ((PyArrayObject *)values[3]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find_solvent_surface", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython.find_solvent_surface", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_box), __pyx_ptype_5numpy_ndarray, 1, "box", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 637; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_8epitopsy_6cython_9dx_cython_22find_solvent_surface(__pyx_self, __pyx_v_protein_score, __pyx_v_solvent_score, __pyx_v_surface_score, __pyx_v_box);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line632")'> 632: </pre>
<pre id='line632' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line633")'> 633: </pre>
<pre id='line633' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line634")'> 634: def find_solvent_surface(protein_score,</pre>
<pre id='line634' class='code' style='background-color: #FFFF5b'>
/* "epitopsy/cython/dx_cython.pyx":634
 * 
 * 
 * def find_solvent_surface(protein_score,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                  solvent_score,
 *                  surface_score,
 */

static PyObject *__pyx_pf_8epitopsy_6cython_9dx_cython_22find_solvent_surface(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_protein_score, PyObject *__pyx_v_solvent_score, PyObject *__pyx_v_surface_score, PyArrayObject *__pyx_v_box) {
  __Pyx_LocalBuf_ND __pyx_pybuffernd_box;
  __Pyx_Buffer __pyx_pybuffer_box;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("find_solvent_surface", 0);
  __pyx_pybuffer_box.pybuffer.buf = NULL;
  __pyx_pybuffer_box.refcount = 0;
  __pyx_pybuffernd_box.data = NULL;
  __pyx_pybuffernd_box.rcbuffer = &__pyx_pybuffer_box;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer, (PyObject*)__pyx_v_box, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_box.diminfo[0].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_box.diminfo[0].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_box.diminfo[1].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_box.diminfo[1].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_box.diminfo[2].strides = __pyx_pybuffernd_box.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_box.diminfo[2].shape = __pyx_pybuffernd_box.rcbuffer->pybuffer.shape[2];

  /* "epitopsy/cython/dx_cython.pyx":634
 * 
 * 
 * def find_solvent_surface(protein_score,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                  solvent_score,
 *                  surface_score,
 */
  __pyx_k_tuple_133 = <span class='py_c_api'>PyTuple_Pack</span>(4, ((PyObject *)__pyx_n_s__protein_score), ((PyObject *)__pyx_n_s__solvent_score), ((PyObject *)__pyx_n_s__surface_score), ((PyObject *)__pyx_n_s__box));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_133)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_133);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_133));

  /* "epitopsy/cython/dx_cython.pyx":634
 * 
 * 
 * def find_solvent_surface(protein_score,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                  solvent_score,
 *                  surface_score,
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_8epitopsy_6cython_9dx_cython_23find_solvent_surface, NULL, __pyx_n_s_110);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_135, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_134 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(4, 0, 4, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_133, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_109, __pyx_n_s_135, 634, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_134)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line635")'> 635:                  solvent_score,</pre>
<pre id='line635' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line636")'> 636:                  surface_score,</pre>
<pre id='line636' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line637")'> 637:                  np.ndarray[np.float64_t, ndim=3] box):</pre>
<pre id='line637' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF52' onclick='toggleDiv("line638")'> 638:     return _find_solvent_surface(&lt;float&gt; protein_score, &lt;float&gt; solvent_score,</pre>
<pre id='line638' class='code' style='background-color: #FFFF52'>
  /* "epitopsy/cython/dx_cython.pyx":638
 *                  surface_score,
 *                  np.ndarray[np.float64_t, ndim=3] box):
 *     return _find_solvent_surface(<code><</code>float> protein_score, <code><</code>float> solvent_score,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                          <code><</code>float> surface_score, box)
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_protein_score);<span class='error_goto'> if (unlikely((__pyx_t_1 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 638; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_solvent_score);<span class='error_goto'> if (unlikely((__pyx_t_2 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 638; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line639")'> 639:                          &lt;float&gt; surface_score, box)</pre>
<pre id='line639' class='code' style='background-color: #FFFF4d'>
  /* "epitopsy/cython/dx_cython.pyx":639
 *                  np.ndarray[np.float64_t, ndim=3] box):
 *     return _find_solvent_surface(<code><</code>float> protein_score, <code><</code>float> solvent_score,
 *                          <code><</code>float> surface_score, box)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef double[:,:,:] check_surface_neighbor(double[:,:,:] box, int xdim, int ydim,
 */
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_surface_score);<span class='error_goto'> if (unlikely((__pyx_t_3 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = ((PyObject *)__pyx_f_8epitopsy_6cython_9dx_cython__find_solvent_surface(((float)__pyx_t_1), ((float)__pyx_t_2), ((float)__pyx_t_3), ((PyArrayObject *)__pyx_v_box)));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 638; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&__pyx_type, &__pyx_value, &__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython.find_solvent_surface", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box.rcbuffer->pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line640")'> 640: </pre>
<pre id='line640' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line641")'> 641: cdef double[:,:,:] check_surface_neighbor(double[:,:,:] box, int xdim, int ydim,</pre>
<pre id='line641' class='code' style='background-color: #FFFFff'>
/* "epitopsy/cython/dx_cython.pyx":641
 *                          <code><</code>float> surface_score, box)
 * 
 * cdef double[:,:,:] check_surface_neighbor(double[:,:,:] box, int xdim, int ydim,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         int zdim, int x, int y, int z, float protein_score,
 *         float surface_score):
 */

static __Pyx_memviewslice __pyx_f_8epitopsy_6cython_9dx_cython_check_surface_neighbor(__Pyx_memviewslice __pyx_v_box, int __pyx_v_xdim, int __pyx_v_ydim, int __pyx_v_zdim, int __pyx_v_x, int __pyx_v_y, int __pyx_v_z, float __pyx_v_protein_score, float __pyx_v_surface_score) {
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_k;
  int __pyx_v_posx;
  int __pyx_v_posy;
  int __pyx_v_posz;
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("check_surface_neighbor", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line642")'> 642:         int zdim, int x, int y, int z, float protein_score,</pre>
<pre id='line642' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line643")'> 643:         float surface_score):</pre>
<pre id='line643' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line644")'> 644:     cdef int i,j,k</pre>
<pre id='line644' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line645")'> 645:     cdef int posx,posy,posz</pre>
<pre id='line645' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line646")'> 646:     for i from -1 &lt;= i &lt;= 1:</pre>
<pre id='line646' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":646
 *     cdef int i,j,k
 *     cdef int posx,posy,posz
 *     for i from -1 <code><</code>= i <code><</code>= 1:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for j from -1 <code><</code>= j <code><</code>= 1:
 *             for k from -1 <code><</code>= k <code><</code>= 1:
 */
  for (__pyx_v_i = -1; __pyx_v_i <code><</code>= 1; __pyx_v_i++) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line647")'> 647:         for j from -1 &lt;= j &lt;= 1:</pre>
<pre id='line647' class='code' style='background-color: #FFFFff'>
    /* "epitopsy/cython/dx_cython.pyx":647
 *     cdef int posx,posy,posz
 *     for i from -1 <code><</code>= i <code><</code>= 1:
 *         for j from -1 <code><</code>= j <code><</code>= 1:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for k from -1 <code><</code>= k <code><</code>= 1:
 *                 if i == 0 and j == 0 and k == 0:
 */
    for (__pyx_v_j = -1; __pyx_v_j <code><</code>= 1; __pyx_v_j++) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line648")'> 648:             for k from -1 &lt;= k &lt;= 1:</pre>
<pre id='line648' class='code' style='background-color: #FFFFff'>
      /* "epitopsy/cython/dx_cython.pyx":648
 *     for i from -1 <code><</code>= i <code><</code>= 1:
 *         for j from -1 <code><</code>= j <code><</code>= 1:
 *             for k from -1 <code><</code>= k <code><</code>= 1:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 if i == 0 and j == 0 and k == 0:
 *                     continue
 */
      for (__pyx_v_k = -1; __pyx_v_k <code><</code>= 1; __pyx_v_k++) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line649")'> 649:                 if i == 0 and j == 0 and k == 0:</pre>
<pre id='line649' class='code' style='background-color: #FFFFff'>
        /* "epitopsy/cython/dx_cython.pyx":649
 *         for j from -1 <code><</code>= j <code><</code>= 1:
 *             for k from -1 <code><</code>= k <code><</code>= 1:
 *                 if i == 0 and j == 0 and k == 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     continue
 *                 else:
 */
        __pyx_t_1 = ((__pyx_v_i == 0) != 0);
        if (__pyx_t_1) {
          __pyx_t_2 = ((__pyx_v_j == 0) != 0);
          if (__pyx_t_2) {
            __pyx_t_3 = ((__pyx_v_k == 0) != 0);
            __pyx_t_4 = __pyx_t_3;
          } else {
            __pyx_t_4 = __pyx_t_2;
          }
          __pyx_t_2 = __pyx_t_4;
        } else {
          __pyx_t_2 = __pyx_t_1;
        }
        if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line650")'> 650:                     continue</pre>
<pre id='line650' class='code' style='background-color: #FFFFff'>
          /* "epitopsy/cython/dx_cython.pyx":650
 *             for k from -1 <code><</code>= k <code><</code>= 1:
 *                 if i == 0 and j == 0 and k == 0:
 *                     continue             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 else:
 *                     posx = x + i
 */
          goto __pyx_L7_continue;
          goto __pyx_L9;
        }
        /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line651")'> 651:                 else:</pre>
<pre id='line651' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line652")'> 652:                     posx = x + i</pre>
<pre id='line652' class='code' style='background-color: #FFFFff'>
          /* "epitopsy/cython/dx_cython.pyx":652
 *                     continue
 *                 else:
 *                     posx = x + i             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     posy = y + j
 *                     posz = z + k
 */
          __pyx_v_posx = (__pyx_v_x + __pyx_v_i);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line653")'> 653:                     posy = y + j</pre>
<pre id='line653' class='code' style='background-color: #FFFFff'>
          /* "epitopsy/cython/dx_cython.pyx":653
 *                 else:
 *                     posx = x + i
 *                     posy = y + j             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     posz = z + k
 * 
 */
          __pyx_v_posy = (__pyx_v_y + __pyx_v_j);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line654")'> 654:                     posz = z + k</pre>
<pre id='line654' class='code' style='background-color: #FFFFff'>
          /* "epitopsy/cython/dx_cython.pyx":654
 *                     posx = x + i
 *                     posy = y + j
 *                     posz = z + k             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                     if (posx >= 0 and posx <code><</code> xdim
 */
          __pyx_v_posz = (__pyx_v_z + __pyx_v_k);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line655")'> 655: </pre>
<pre id='line655' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line656")'> 656:                     if (posx &gt;= 0 and posx &lt; xdim</pre>
<pre id='line656' class='code' style='background-color: #FFFFff'>
          /* "epitopsy/cython/dx_cython.pyx":656
 *                     posz = z + k
 * 
 *                     if (posx >= 0 and posx <code><</code> xdim             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         and posy >= 0 and posy <code><</code> ydim
 *                         and posz >= 0 and posz <code><</code> zdim):
 */
          __pyx_t_2 = ((__pyx_v_posx >= 0) != 0);
          if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line657")'> 657:                         and posy &gt;= 0 and posy &lt; ydim</pre>
<pre id='line657' class='code' style='background-color: #FFFFff'>
            /* "epitopsy/cython/dx_cython.pyx":657
 * 
 *                     if (posx >= 0 and posx <code><</code> xdim
 *                         and posy >= 0 and posy <code><</code> ydim             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         and posz >= 0 and posz <code><</code> zdim):
 *                         if box[posx,posy,posz] == protein_score:
 */
            __pyx_t_1 = ((__pyx_v_posx <code><</code> __pyx_v_xdim) != 0);
            if (__pyx_t_1) {
              __pyx_t_4 = ((__pyx_v_posy >= 0) != 0);
              if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line658")'> 658:                         and posz &gt;= 0 and posz &lt; zdim):</pre>
<pre id='line658' class='code' style='background-color: #FFFFff'>
                /* "epitopsy/cython/dx_cython.pyx":658
 *                     if (posx >= 0 and posx <code><</code> xdim
 *                         and posy >= 0 and posy <code><</code> ydim
 *                         and posz >= 0 and posz <code><</code> zdim):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         if box[posx,posy,posz] == protein_score:
 *                             box[x,y,z] = surface_score
 */
                __pyx_t_3 = ((__pyx_v_posy <code><</code> __pyx_v_ydim) != 0);
                if (__pyx_t_3) {
                  __pyx_t_5 = ((__pyx_v_posz >= 0) != 0);
                  if (__pyx_t_5) {
                    __pyx_t_6 = ((__pyx_v_posz <code><</code> __pyx_v_zdim) != 0);
                    __pyx_t_7 = __pyx_t_6;
                  } else {
                    __pyx_t_7 = __pyx_t_5;
                  }
                  __pyx_t_5 = __pyx_t_7;
                } else {
                  __pyx_t_5 = __pyx_t_3;
                }
                __pyx_t_3 = __pyx_t_5;
              } else {
                __pyx_t_3 = __pyx_t_4;
              }
              __pyx_t_4 = __pyx_t_3;
            } else {
              __pyx_t_4 = __pyx_t_1;
            }
            __pyx_t_1 = __pyx_t_4;
          } else {
            __pyx_t_1 = __pyx_t_2;
          }
          if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line659")'> 659:                         if box[posx,posy,posz] == protein_score:</pre>
<pre id='line659' class='code' style='background-color: #FFFFd4'>
            /* "epitopsy/cython/dx_cython.pyx":659
 *                         and posy >= 0 and posy <code><</code> ydim
 *                         and posz >= 0 and posz <code><</code> zdim):
 *                         if box[posx,posy,posz] == protein_score:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             box[x,y,z] = surface_score
 *                             return box
 */
            __pyx_t_8 = __pyx_v_posx;
            __pyx_t_9 = __pyx_v_posy;
            __pyx_t_10 = __pyx_v_posz;
            __pyx_t_11 = -1;
            if (__pyx_t_8 <code><</code> 0) {
              __pyx_t_8 += __pyx_v_box.shape[0];
              if (unlikely(__pyx_t_8 <code><</code> 0)) __pyx_t_11 = 0;
            } else if (unlikely(__pyx_t_8 >= __pyx_v_box.shape[0])) __pyx_t_11 = 0;
            if (__pyx_t_9 <code><</code> 0) {
              __pyx_t_9 += __pyx_v_box.shape[1];
              if (unlikely(__pyx_t_9 <code><</code> 0)) __pyx_t_11 = 1;
            } else if (unlikely(__pyx_t_9 >= __pyx_v_box.shape[1])) __pyx_t_11 = 1;
            if (__pyx_t_10 <code><</code> 0) {
              __pyx_t_10 += __pyx_v_box.shape[2];
              if (unlikely(__pyx_t_10 <code><</code> 0)) __pyx_t_11 = 2;
            } else if (unlikely(__pyx_t_10 >= __pyx_v_box.shape[2])) __pyx_t_11 = 2;
            if (unlikely(__pyx_t_11 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
             <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 659; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            }
            __pyx_t_1 = (((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_8 * __pyx_v_box.strides[0]) ) + __pyx_t_9 * __pyx_v_box.strides[1]) ) + __pyx_t_10 * __pyx_v_box.strides[2]) ))) == __pyx_v_protein_score) != 0);
            if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line660")'> 660:                             box[x,y,z] = surface_score</pre>
<pre id='line660' class='code' style='background-color: #FFFFd4'>
              /* "epitopsy/cython/dx_cython.pyx":660
 *                         and posz >= 0 and posz <code><</code> zdim):
 *                         if box[posx,posy,posz] == protein_score:
 *                             box[x,y,z] = surface_score             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             return box
 * 
 */
              __pyx_t_11 = __pyx_v_x;
              __pyx_t_12 = __pyx_v_y;
              __pyx_t_13 = __pyx_v_z;
              __pyx_t_14 = -1;
              if (__pyx_t_11 <code><</code> 0) {
                __pyx_t_11 += __pyx_v_box.shape[0];
                if (unlikely(__pyx_t_11 <code><</code> 0)) __pyx_t_14 = 0;
              } else if (unlikely(__pyx_t_11 >= __pyx_v_box.shape[0])) __pyx_t_14 = 0;
              if (__pyx_t_12 <code><</code> 0) {
                __pyx_t_12 += __pyx_v_box.shape[1];
                if (unlikely(__pyx_t_12 <code><</code> 0)) __pyx_t_14 = 1;
              } else if (unlikely(__pyx_t_12 >= __pyx_v_box.shape[1])) __pyx_t_14 = 1;
              if (__pyx_t_13 <code><</code> 0) {
                __pyx_t_13 += __pyx_v_box.shape[2];
                if (unlikely(__pyx_t_13 <code><</code> 0)) __pyx_t_14 = 2;
              } else if (unlikely(__pyx_t_13 >= __pyx_v_box.shape[2])) __pyx_t_14 = 2;
              if (unlikely(__pyx_t_14 != -1)) {
                <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
               <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              }
              *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_11 * __pyx_v_box.strides[0]) ) + __pyx_t_12 * __pyx_v_box.strides[1]) ) + __pyx_t_13 * __pyx_v_box.strides[2]) )) = __pyx_v_surface_score;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line661")'> 661:                             return box</pre>
<pre id='line661' class='code' style='background-color: #FFFFff'>
              /* "epitopsy/cython/dx_cython.pyx":661
 *                         if box[posx,posy,posz] == protein_score:
 *                             box[x,y,z] = surface_score
 *                             return box             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     return box
 */
              __PYX_INC_MEMVIEW(&__pyx_v_box, 0);
              __pyx_r = __pyx_v_box;
              goto __pyx_L0;
              goto __pyx_L11;
            }
            __pyx_L11:;
            goto __pyx_L10;
          }
          __pyx_L10:;
        }
        __pyx_L9:;
        __pyx_L7_continue:;
      }
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line662")'> 662: </pre>
<pre id='line662' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line663")'> 663:     return box</pre>
<pre id='line663' class='code' style='background-color: #FFFF8d'>
  /* "epitopsy/cython/dx_cython.pyx":663
 *                             return box
 * 
 *     return box             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef np.ndarray _find_solvent_surface(float protein_score, float solvent_score,
 */
  __PYX_INC_MEMVIEW(&__pyx_v_box, 0);
  __pyx_r = __pyx_v_box;
  goto __pyx_L0;

  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython.check_surface_neighbor", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = __pyx_r;
  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError,"Memoryview return value is not initialized");
  }
  __pyx_L2:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line664")'> 664: </pre>
<pre id='line664' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line665")'> 665: cdef np.ndarray _find_solvent_surface(float protein_score, float solvent_score,</pre>
<pre id='line665' class='code' style='background-color: #FFFFd4'>
/* "epitopsy/cython/dx_cython.pyx":665
 *     return box
 * 
 * cdef np.ndarray _find_solvent_surface(float protein_score, float solvent_score,             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                   float surface_score,
 *                   np.ndarray[np.float64_t, ndim=3] box_np):
 */

static PyArrayObject *__pyx_f_8epitopsy_6cython_9dx_cython__find_solvent_surface(float __pyx_v_protein_score, float __pyx_v_solvent_score, float __pyx_v_surface_score, PyArrayObject *__pyx_v_box_np) {
  int __pyx_v_x;
  int __pyx_v_y;
  int __pyx_v_z;
  __Pyx_memviewslice __pyx_v_box = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_xdim;
  int __pyx_v_ydim;
  int __pyx_v_zdim;
  CYTHON_UNUSED int __pyx_v_stop;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_box_np;
  __Pyx_Buffer __pyx_pybuffer_box_np;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_find_solvent_surface", 0);
  __pyx_pybuffer_box_np.pybuffer.buf = NULL;
  __pyx_pybuffer_box_np.refcount = 0;
  __pyx_pybuffernd_box_np.data = NULL;
  __pyx_pybuffernd_box_np.rcbuffer = &__pyx_pybuffer_box_np;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&__pyx_pybuffernd_box_np.rcbuffer->pybuffer, (PyObject*)__pyx_v_box_np, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 665; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_pybuffernd_box_np.diminfo[0].strides = __pyx_pybuffernd_box_np.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_box_np.diminfo[0].shape = __pyx_pybuffernd_box_np.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_box_np.diminfo[1].strides = __pyx_pybuffernd_box_np.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_box_np.diminfo[1].shape = __pyx_pybuffernd_box_np.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_box_np.diminfo[2].strides = __pyx_pybuffernd_box_np.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_box_np.diminfo[2].shape = __pyx_pybuffernd_box_np.rcbuffer->pybuffer.shape[2];
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line666")'> 666:                   float surface_score,</pre>
<pre id='line666' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line667")'> 667:                   np.ndarray[np.float64_t, ndim=3] box_np):</pre>
<pre id='line667' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line668")'> 668:     cdef int x,y,z,i,j,k</pre>
<pre id='line668' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line669")'> 669:     cdef double[:,:,:] box = box_np</pre>
<pre id='line669' class='code' style='background-color: #FFFFd4'>
  /* "epitopsy/cython/dx_cython.pyx":669
 *                   np.ndarray[np.float64_t, ndim=3] box_np):
 *     cdef int x,y,z,i,j,k
 *     cdef double[:,:,:] box = box_np             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int posx, poxy, posz
 *     cdef int xdim = box.shape[0]
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_double</span>(((PyObject *)__pyx_v_box_np));
  if (unlikely(!__pyx_t_1.memview))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 669; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_box = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line670")'> 670:     cdef int posx, poxy, posz</pre>
<pre id='line670' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line671")'> 671:     cdef int xdim = box.shape[0]</pre>
<pre id='line671' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":671
 *     cdef double[:,:,:] box = box_np
 *     cdef int posx, poxy, posz
 *     cdef int xdim = box.shape[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int ydim = box.shape[1]
 *     cdef int zdim = box.shape[2]
 */
  __pyx_v_xdim = (__pyx_v_box.shape[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line672")'> 672:     cdef int ydim = box.shape[1]</pre>
<pre id='line672' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":672
 *     cdef int posx, poxy, posz
 *     cdef int xdim = box.shape[0]
 *     cdef int ydim = box.shape[1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int zdim = box.shape[2]
 *     # use stop to interupt the loop over the neighbors
 */
  __pyx_v_ydim = (__pyx_v_box.shape[1]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line673")'> 673:     cdef int zdim = box.shape[2]</pre>
<pre id='line673' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":673
 *     cdef int xdim = box.shape[0]
 *     cdef int ydim = box.shape[1]
 *     cdef int zdim = box.shape[2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     # use stop to interupt the loop over the neighbors
 *     cdef int stop = 0
 */
  __pyx_v_zdim = (__pyx_v_box.shape[2]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line674")'> 674:     # use stop to interupt the loop over the neighbors</pre>
<pre id='line674' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line675")'> 675:     cdef int stop = 0</pre>
<pre id='line675' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":675
 *     cdef int zdim = box.shape[2]
 *     # use stop to interupt the loop over the neighbors
 *     cdef int stop = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef float score
 * 
 */
  __pyx_v_stop = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line676")'> 676:     cdef float score</pre>
<pre id='line676' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line677")'> 677: </pre>
<pre id='line677' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line678")'> 678:     for x in range(xdim):</pre>
<pre id='line678' class='code' style='background-color: #FFFFff'>
  /* "epitopsy/cython/dx_cython.pyx":678
 *     cdef float score
 * 
 *     for x in range(xdim):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for y in range(ydim):
 *             for z in range(zdim):
 */
  __pyx_t_2 = __pyx_v_xdim;
  for (__pyx_t_3 = 0; __pyx_t_3 <code><</code> __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_x = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line679")'> 679:         for y in range(ydim):</pre>
<pre id='line679' class='code' style='background-color: #FFFFff'>
    /* "epitopsy/cython/dx_cython.pyx":679
 * 
 *     for x in range(xdim):
 *         for y in range(ydim):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for z in range(zdim):
 *                 # only check points from the proteins interior
 */
    __pyx_t_4 = __pyx_v_ydim;
    for (__pyx_t_5 = 0; __pyx_t_5 <code><</code> __pyx_t_4; __pyx_t_5+=1) {
      __pyx_v_y = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line680")'> 680:             for z in range(zdim):</pre>
<pre id='line680' class='code' style='background-color: #FFFFff'>
      /* "epitopsy/cython/dx_cython.pyx":680
 *     for x in range(xdim):
 *         for y in range(ydim):
 *             for z in range(zdim):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 # only check points from the proteins interior
 *                 if box[x,y,z] == solvent_score:
 */
      __pyx_t_6 = __pyx_v_zdim;
      for (__pyx_t_7 = 0; __pyx_t_7 <code><</code> __pyx_t_6; __pyx_t_7+=1) {
        __pyx_v_z = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line681")'> 681:                 # only check points from the proteins interior</pre>
<pre id='line681' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line682")'> 682:                 if box[x,y,z] == solvent_score:</pre>
<pre id='line682' class='code' style='background-color: #FFFFd4'>
        /* "epitopsy/cython/dx_cython.pyx":682
 *             for z in range(zdim):
 *                 # only check points from the proteins interior
 *                 if box[x,y,z] == solvent_score:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     box = check_surface_neighbor(box, xdim, ydim, zdim, x, y, z,
 *                             protein_score, surface_score)
 */
        __pyx_t_8 = __pyx_v_x;
        __pyx_t_9 = __pyx_v_y;
        __pyx_t_10 = __pyx_v_z;
        __pyx_t_11 = -1;
        if (__pyx_t_8 <code><</code> 0) {
          __pyx_t_8 += __pyx_v_box.shape[0];
          if (unlikely(__pyx_t_8 <code><</code> 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_8 >= __pyx_v_box.shape[0])) __pyx_t_11 = 0;
        if (__pyx_t_9 <code><</code> 0) {
          __pyx_t_9 += __pyx_v_box.shape[1];
          if (unlikely(__pyx_t_9 <code><</code> 0)) __pyx_t_11 = 1;
        } else if (unlikely(__pyx_t_9 >= __pyx_v_box.shape[1])) __pyx_t_11 = 1;
        if (__pyx_t_10 <code><</code> 0) {
          __pyx_t_10 += __pyx_v_box.shape[2];
          if (unlikely(__pyx_t_10 <code><</code> 0)) __pyx_t_11 = 2;
        } else if (unlikely(__pyx_t_10 >= __pyx_v_box.shape[2])) __pyx_t_11 = 2;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 682; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_12 = (((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_box.data + __pyx_t_8 * __pyx_v_box.strides[0]) ) + __pyx_t_9 * __pyx_v_box.strides[1]) ) + __pyx_t_10 * __pyx_v_box.strides[2]) ))) == __pyx_v_solvent_score) != 0);
        if (__pyx_t_12) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line683")'> 683:                     box = check_surface_neighbor(box, xdim, ydim, zdim, x, y, z,</pre>
<pre id='line683' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line684")'> 684:                             protein_score, surface_score)</pre>
<pre id='line684' class='code' style='background-color: #FFFFff'>
          /* "epitopsy/cython/dx_cython.pyx":684
 *                 if box[x,y,z] == solvent_score:
 *                     box = check_surface_neighbor(box, xdim, ydim, zdim, x, y, z,
 *                             protein_score, surface_score)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     return box_np
 */
          __pyx_t_13 = __pyx_f_8epitopsy_6cython_9dx_cython_check_surface_neighbor(__pyx_v_box, __pyx_v_xdim, __pyx_v_ydim, __pyx_v_zdim, __pyx_v_x, __pyx_v_y, __pyx_v_z, __pyx_v_protein_score, __pyx_v_surface_score);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 683; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          __PYX_XDEC_MEMVIEW(&__pyx_v_box, 1);
          __pyx_v_box = __pyx_t_13;
          __pyx_t_13.memview = NULL;
          __pyx_t_13.data = NULL;
          goto __pyx_L9;
        }
        __pyx_L9:;
      }
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line685")'> 685: </pre>
<pre id='line685' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line686")'> 686:     return box_np</pre>
<pre id='line686' class='code' style='background-color: #FFFF66'>
  /* "epitopsy/cython/dx_cython.pyx":686
 *                             protein_score, surface_score)
 * 
 *     return box_np             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_box_np));
  __pyx_r = ((PyArrayObject *)__pyx_v_box_np);
  goto __pyx_L0;

  __pyx_r = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&__pyx_t_1, 1);
  __PYX_XDEC_MEMVIEW(&__pyx_t_13, 1);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&__pyx_type, &__pyx_value, &__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box_np.rcbuffer->pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("epitopsy.cython.dx_cython._find_solvent_surface", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&__pyx_pybuffernd_box_np.rcbuffer->pybuffer);
  __pyx_L2:;
  __PYX_XDEC_MEMVIEW(&__pyx_v_box, 1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>((PyObject *)__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static CYTHON_UNUSED int __pyx_pw_5numpy_7ndarray_1__getbuffer__(PyObject *__pyx_v_self, Py_buffer *__pyx_v_info, int __pyx_v_flags); /*proto*/
static CYTHON_UNUSED int __pyx_pw_5numpy_7ndarray_1__getbuffer__(PyObject *__pyx_v_self, Py_buffer *__pyx_v_info, int __pyx_v_flags) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__getbuffer__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5numpy_7ndarray___getbuffer__(((PyArrayObject *)__pyx_v_self), ((Py_buffer *)__pyx_v_info), ((int)__pyx_v_flags));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre></body></html>
